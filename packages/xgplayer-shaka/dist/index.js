!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("xgplayer")):"function"==typeof define&&define.amd?define(["xgplayer"],t):"object"==typeof exports?exports["xgplayer-shaka"]=t(require("xgplayer")):e["xgplayer-shaka"]=t(e.xgplayer)}(window,(function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(2)),o=a(n(3));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=n;if(n.shakaOpts=e.shakaOpts||{},n.util=r.default.util,n.player=n,n.url=n.player.config.url,n.sniffer=r.default.sniffer,n.player_=null,n.content=[],o.default.polyfill.installAll(),o.default.Player.isBrowserSupported()){n.video_=n.player.video,n.video_.autoplay=!1,n.player_=new o.default.Player(n.video_),n.player_.addEventListener("error",(function(e){console.error("Error code",e.detail.code,"object",e.detail)})),n.shakaOpts&&n.player_.configure(n.shakaOpts),n.player_.getNetworkingEngine().registerRequestFilter((function(e,t){e===o.default.net.NetworkingEngine.RequestType.LICENSE&&(t.headers["CWIP-Auth-Header"]="VGhpc0lzQVRlc3QK")})),n.player_.addEventListener("adaptation",i.onAdaptation_);if(n.player_.configure({abr:{enabled:!1}}),n.once("complete",(function(){n.player_.load(n.url).then((function(){i.onTracksChanged_()})).catch((function(e){console.error("Error code",e.detail.code,"object",e.detail)}))})),n.player_.isLive()){n.util.addClass(n.player.root,"xgplayer-is-live");var a=n.util.createDom("xg-live","正在直播",{},"xgplayer-live");n.player.controls.appendChild(a)}}else console.error("Browser not supported!");return n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"onTracksChanged_",value:function(){this.updateVariantTracks_()}},{key:"onAdaptation_",value:function(){var e=this;this.player_.getVariantTracks().forEach((function(t){if(t.active)for(var n=0;n<e.content.length;++n){var i=e.content[n];i.value===t.id?i.selected=!0:i.selected=!1}}))}},{key:"updateVariantTracks_",value:function(){var e=this.player_.getVariantTracks();e.sort((function(e,t){return e.bandwidth-t.bandwidth})),this.updateTrackOptions_(e)}},{key:"updateTrackOptions_",value:function(e){var t=this,n={variant:function(e){var t="";return e.width&&e.height&&(t+=e.height+"P"),t}};this.content=[],e.forEach((function(e){var i={};i.textContent=n[e.type](e),i.track=e,i.value=e.id,i.selected=e.active,t.content.push(i)})),this.updateDefinition()}},{key:"updateDefinition",value:function(){var e=this,t=this.util.createDom("xg-definition","",{tabindex:3},"xgplayer-definition"),n=this.player.controls;if("mobile"!==this.sniffer.device){if(this.content instanceof Array&&this.content.length>1){this.util.addClass(this.player.root,"xgplayer-is-definition");var i=["<ul>"];this.content.forEach((function(e){i.push("<li class=''>"+e.textContent+"</li>")})),this.content.some((function(e){return!!e.selected&&(i.push('</ul><p class="name"><em>'+e.textContent+"</em></p>"),!0)}));var r=n.querySelector(".xgplayer-definition");r?r.innerHTML='<xg-tips class="xgplayer-tips">清晰度</xg-tips>'+i.join(""):(t.innerHTML='<xg-tips class="xgplayer-tips">清晰度</xg-tips>'+i.join(""),n.appendChild(t))}["touchstart","click"].forEach((function(n){t.addEventListener(n,(function(n){n.preventDefault(),n.stopPropagation();var i=n.target||n.srcElement;if(i&&"li"===i.tagName.toLocaleLowerCase()){Array.prototype.forEach.call(i.parentNode.childNodes,(function(t){e.util.removeClass(t,"definition")})),e.util.addClass(i,"definition"),i.parentNode.nextSibling.textContent=i.textContent;e.player_.configure({abr:{enabled:!1}}),e.content.some((function(t,n){return i.innerHTML.indexOf(t.textContent)>-1&&(e.player_.selectVariantTrack(e.content[n].track,!0),!0)}))}else!i||"p"!==i.tagName.toLocaleLowerCase()&&"em"!==i.tagName.toLocaleLowerCase()||(e.util.addClass(t,"xgplayer-definition-active"),t.focus())}),!1)})),t.addEventListener("blur",(function(n){n.preventDefault(),n.stopPropagation(),e.util.removeClass(t,"xgplayer-definition-active")})),this.player.once("destroy",(function(){t=null})),this.player.start=function(){arguments.length>0&&void 0!==arguments[0]||e.player.config.url;var t=e.player.root;t.insertBefore(e.player.video,t.firstChild),e.util.removeClass(t,"none"),e.player.userTimer=setTimeout((function(){e.player.emit("blur")}),e.player.config.inactive),setTimeout((function(){e.player.emit("complete")}),1),e.player.reset=function(){}}}}}]),t}(r.default);s.isSupported=o.default.Player.isBrowserSupported(),t.default=s,e.exports=t.default},function(t,n){t.exports=e},function(e,t,n){"use strict";(function(e){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};
/*
 @license
 Shaka Player
 Copyright 2016 Google LLC
 SPDX-License-Identifier: Apache-2.0
*/!function(){var i="undefined"!=typeof window?window:e,r={};for(var o in function(e,t,i){var r,o="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},a=void 0!==e&&e===this?this:void 0!==t&&null!=t?t:this;function s(){s=function(){},a.Symbol||(a.Symbol=c)}var u,c=(u=0,function(e){return"jscomp_symbol_"+(e||"")+u++});function l(){s();var e=a.Symbol.iterator;e||(e=a.Symbol.iterator=a.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&o(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return d(this)}}),l=function(){}}function d(e){var t=0;return h((function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}))}function h(e){return l(),(e={next:e})[a.Symbol.iterator]=function(){return this},e}function f(e){l();var t=e[Symbol.iterator];return t?t.call(e):d(e)}function p(e,t){if(t){for(var n=a,i=e.split("."),r=0;r<i.length-1;r++){var s=i[r];s in n||(n[s]={}),n=n[s]}(s=t(r=n[i=i[i.length-1]]))!=r&&null!=s&&o(n,i,{configurable:!0,writable:!0,value:s})}}function g(e){return function(e){function t(t){return e.next(t)}function n(t){return e.throw(t)}return new Promise((function(i,r){!function e(o){o.done?i(o.value):Promise.resolve(o.value).then(t,n).then(e,r)}(e.next())}))}(e())}p("Promise",(function(e){function t(e){this.h=0,this.l=void 0,this.g=[];var t=this.i();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function i(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;i.prototype.h=function(e){null==this.g&&(this.g=[],this.j()),this.g.push(e)},i.prototype.j=function(){var e=this;this.i((function(){e.m()}))};var o=a.setTimeout;i.prototype.i=function(e){o(e,0)},i.prototype.m=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.l(e)}}}this.g=null},i.prototype.l=function(e){this.i((function(){throw e}))},t.prototype.i=function(){function e(e){return function(i){n||(n=!0,e.call(t,i))}}var t=this,n=!1;return{resolve:e(this.C),reject:e(this.j)}},t.prototype.C=function(e){if(e===this)this.j(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(void 0===e?"undefined":n(e)){case"object":var i=null!=e;break e;case"function":i=!0;break e;default:i=!1}i?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.j(e)}"function"==typeof t?this.J(t,e):this.m(e)},t.prototype.j=function(e){this.o(2,e)},t.prototype.m=function(e){this.o(1,e)},t.prototype.o=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.l=t,this.u()},t.prototype.u=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)s.h(this.g[e]);this.g=null}};var s=new i;return t.prototype.F=function(e){var t=this.i();e.nc(t.resolve,t.reject)},t.prototype.J=function(e,t){var n=this.i();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function i(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){o(e)}}:t}var r,o,a=new t((function(e,t){r=e,o=t}));return this.nc(i(e,r),i(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.nc=function(e,t){function n(){switch(i.h){case 1:e(i.l);break;case 2:t(i.l);break;default:throw Error("Unexpected state: "+i.h)}}var i=this;null==this.g?s.h(n):this.g.push(n)},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=f(e),o=i.next();!o.done;o=i.next())r(o.value).nc(t,n)}))},t.all=function(e){var n=f(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).nc(o(a.length-1),t),i=n.next()}while(!i.done)}))},t})),p("Promise.prototype.finally",(function(e){return e||function(e){return this.then((function(t){return Promise.resolve(e()).then((function(){return t}))}),(function(t){return Promise.resolve(e()).then((function(){throw t}))}))}}));var m,v="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)m=Object.setPrototypeOf;else{var y;e:{var b={};try{b.__proto__={a:!0},y=b.a;break e}catch(u){}y=!1}m=y?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var w=m;function T(e,t){if(e.prototype=v(t.prototype),e.prototype.constructor=e,w)w(e,t);else for(var n in t)if("prototype"!=n)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,n);i&&Object.defineProperty(e,n,i)}else e[n]=t[n];e.Lg=t.prototype}function S(){this.l=!1,this.i=null,this.B=void 0,this.s=1,this.h=this.j=0,this.o=this.g=null}function E(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function x(e,t){e.g={ce:t,ne:!0},e.s=e.j||e.h}function k(e,t,n){return e.s=n,{value:t}}function A(e){e.s=0}function M(e,t,n){e.j=t,null!=n&&(e.h=n)}function I(e,t){e.j=0,e.h=t||0}function P(e,t){e.s=t,e.j=0}function C(e){e.j=0;var t=e.g.ce;return e.g=null,t}function R(e){e.o=[e.g],e.j=0,e.h=0}function N(e,t){var n=e.o.splice(0)[0];(n=e.g=e.g||n)?n.ne?e.s=e.j||e.h:null!=n.I&&e.h<n.I?(e.s=n.I,e.g=null):e.s=e.h:e.s=t}function D(e){this.g=new S,this.h=e}function j(e,t,n,i){try{var r=t.call(e.g.i,n);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.l=!1,r;var o=r.value}catch(t){return e.g.i=null,x(e.g,t),_(e)}return e.g.i=null,i.call(e.g,o),_(e)}function _(e){for(;e.g.s;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.B=void 0,x(e.g,t)}if(e.g.l=!1,e.g.g){if(t=e.g.g,e.g.g=null,t.ne)throw t.ce;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function L(e){this.next=function(t){return E(e.g),e.g.i?t=j(e,e.g.i.next,t,e.g.m):(e.g.m(t),t=_(e)),t},this.throw=function(t){return E(e.g),e.g.i?t=j(e,e.g.i.throw,t,e.g.m):(x(e.g,t),t=_(e)),t},this.return=function(t){return function(e,t){E(e.g);var n=e.g.i;return n?j(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),_(e))}(e,t)},l(),this[Symbol.iterator]=function(){return this}}function U(e,t){return L.prototype=e.prototype,new L(new D(t))}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function K(e,t,n){e instanceof String&&(e=String(e));for(var i=e.length,r=0;r<i;r++){var o=e[r];if(t.call(n,o,r,e))return{le:r,Qe:o}}return{le:-1,Qe:void 0}}function B(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""}S.prototype.m=function(e){this.B=e},S.prototype.return=function(e){this.g={return:e},this.s=this.h},S.prototype.I=function(e){this.s=e},p("Array.prototype.keys",(function(e){return e||function(){return function(e,t){l(),e instanceof String&&(e+="");var n=0,i={next:function(){if(n<e.length){var r=n++;return{value:t(r,e[r]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e){return e}))}})),p("WeakMap",(function(e){function t(e){if(this.g=(a+=Math.random()+1).toString(),e){s(),l(),e=f(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(e){O(e,r)||o(e,r,{value:{}})}function i(e){var t=Object[e];t&&(Object[e]=function(e){return n(e),t(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),i=new e([[t,2],[n,3]]);return 2==i.get(t)&&3==i.get(n)&&(i.delete(t),i.set(n,4),!i.has(t)&&4==i.get(n))}catch(e){return!1}}())return e;var r="$jscomp_hidden_"+Math.random();i("freeze"),i("preventExtensions"),i("seal");var a=0;return t.prototype.set=function(e,t){if(n(e),!O(e,r))throw Error("WeakMap key fail: "+e);return e[r][this.g]=t,this},t.prototype.get=function(e){return O(e,r)?e[r][this.g]:void 0},t.prototype.has=function(e){return O(e,r)&&O(e[r],this.g)},t.prototype.delete=function(e){return!(!O(e,r)||!O(e[r],this.g))&&delete e[r][this.g]},t})),p("Map",(function(e){function t(){var e={};return e.Na=e.next=e.head=e}function i(e,t){var n=e.g;return h((function(){if(n){for(;n.head!=e.g;)n=n.Na;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var i=t&&(void 0===t?"undefined":n(t));"object"==i||"function"==i?a.has(t)?i=a.get(t):(i=""+ ++u,a.set(t,i)):i="p_"+t;var r=e.h[i];if(r&&O(e.h,i))for(var o=0;o<r.length;o++){var s=r[o];if(t!=t&&s.key!=s.key||t===s.key)return{id:i,list:r,index:o,ga:s}}return{id:i,list:r,index:-1,ga:void 0}}function o(e){if(this.h={},this.g=t(),this.size=0,e){e=f(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(f([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&"s"==r.value[1]&&!((r=i.next()).done||4!=r.value[0].x||"t"!=r.value[1]||!i.next().done)}catch(e){return!1}}())return e;s(),l();var a=new WeakMap;o.prototype.set=function(e,t){var n=r(this,e);return n.list||(n.list=this.h[n.id]=[]),n.ga?n.ga.value=t:(n.ga={next:this.g,Na:this.g.Na,head:this.g,key:e,value:t},n.list.push(n.ga),this.g.Na.next=n.ga,this.g.Na=n.ga,this.size++),this},o.prototype.delete=function(e){return!(!(e=r(this,e)).ga||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.ga.Na.next=e.ga.next,e.ga.next.Na=e.ga.Na,e.ga.head=null,this.size--,!0)},o.prototype.clear=function(){this.h={},this.g=this.g.Na=t(),this.size=0},o.prototype.has=function(e){return!!r(this,e).ga},o.prototype.get=function(e){return(e=r(this,e).ga)&&e.value},o.prototype.entries=function(){return i(this,(function(e){return[e.key,e.value]}))},o.prototype.keys=function(){return i(this,(function(e){return e.key}))},o.prototype.values=function(){return i(this,(function(e){return e.value}))},o.prototype.forEach=function(e,t){for(var n,i=this.entries();!(n=i.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},o.prototype[Symbol.iterator]=o.prototype.entries;var u=0;return o})),p("Set",(function(e){function t(e){if(this.g=new Map,e){e=f(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(f([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var i=n.entries(),r=i.next();return!r.done&&r.value[0]==t&&r.value[1]==t&&(!(r=i.next()).done&&r.value[0]!=t&&4==r.value[0].x&&r.value[1]==r.value[0]&&i.next().done)}catch(e){return!1}}()?e:(s(),l(),t.prototype.add=function(e){return this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(i){return e.call(t,i,i,n)}))},t)})),p("Array.prototype.findIndex",(function(e){return e||function(e,t){return K(this,e,t).le}})),p("Array.prototype.find",(function(e){return e||function(e,t){return K(this,e,t).Qe}})),p("String.prototype.startsWith",(function(e){return e||function(e,t){for(var n=B(this,e,"startsWith"),i=n.length,r=e.length,o=Math.max(0,Math.min(0|t,n.length)),a=0;a<r&&o<i;)if(n[o++]!=e[a++])return!1;return a>=r}})),p("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),p("Array.prototype.includes",(function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var i=n.length,r=t||0;for(0>r&&(r=Math.max(r+i,0));r<i;r++){var o=n[r];if(o===e||Object.is(o,e))return!0}return!1}})),p("String.prototype.includes",(function(e){return e||function(e,t){return-1!==B(this,e,"includes").indexOf(e,t||0)}})),p("Array.from",(function(e){return e||function(e,t,n){l(),t=null!=t?t:function(e){return e};var i=[],r=e[Symbol.iterator];if("function"==typeof r)for(e=r.call(e);!(r=e.next()).done;)i.push(t.call(n,r.value));else{r=e.length;for(var o=0;o<r;o++)i.push(t.call(n,e[o]))}return i}}));var F="function"==typeof Object.assign?Object.assign:function(e,t){for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i)for(var r in i)O(i,r)&&(e[r]=i[r])}return e};p("Object.assign",(function(e){return e||F}));var H=this;function V(e,t){var n,i=e.split("."),r=H;i[0]in r||!r.execScript||r.execScript("var "+i[0]);for(;i.length&&(n=i.shift());)i.length||void 0===t?r=r[n]?r[n]:r[n]={}:r[n]=t}function G(e,t){function n(){}n.prototype=t.prototype,e.Lg=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wg=function(e,n,i){return t.prototype[n].apply(e,Array.prototype.slice.call(arguments,2))}}function q(e){this.i=Math.exp(Math.log(.5)/e),this.h=this.g=0}function z(e,t,n){var i=Math.pow(e.i,t);n=n*(1-i)+i*e.g,isNaN(n)||(e.g=n,e.h+=t)}function W(e){return e.g/(1-Math.pow(e.i,e.h))}function X(){this.h=new q(2),this.i=new q(5),this.g=0}H.g=!0,X.prototype.getBandwidthEstimate=function(e){return 128e3>this.g?e:Math.min(W(this.h),W(this.i))};var Y={sb:0,kc:function(){},ba:function(){},error:function(){},v:function(){},info:function(){},debug:function(){},K:function(){},O:function(){}};function $(e,t,n,i){for(var r=[],o=3;o<arguments.length;++o)r[o-3]=arguments[o];this.severity=e,this.category=t,this.code=n,this.data=r,this.handled=!1}e.console&&e.console.log.bind&&(Y.ba=console.warn.bind(console),Y.kc=console.error.bind(console),1<=Y.sb&&(Y.error=console.error.bind(console)),2<=Y.sb&&(Y.v=console.warn.bind(console)),3<=Y.sb&&(Y.info=console.info.bind(console)),4<=Y.sb&&(Y.debug=console.log.bind(console)),5<=Y.sb&&(Y.K=console.debug.bind(console)),6<=Y.sb&&(Y.O=console.debug.bind(console))),V("shaka.util.Error",$),$.prototype.toString=function(){return"shaka.util.Error "+JSON.stringify(this,null,"  ")},$.Severity={RECOVERABLE:1,CRITICAL:2},$.Category={NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6,PLAYER:7,CAST:8,STORAGE:9},$.Code={UNSUPPORTED_SCHEME:1e3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,REQUEST_FILTER_ERROR:1006,RESPONSE_FILTER_ERROR:1007,MALFORMED_TEST_URI:1008,UNEXPECTED_TEST_REQUEST:1009,INVALID_TEXT_HEADER:2e3,INVALID_TEXT_CUE:2001,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,INVALID_XML:2005,INVALID_MP4_TTML:2007,INVALID_MP4_VTT:2008,UNABLE_TO_EXTRACT_CUE_START_TIME:2009,BUFFER_READ_OUT_OF_BOUNDS:3e3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,QUOTA_EXCEEDED_ERROR:3017,TRANSMUXING_FAILED:3018,UNABLE_TO_GUESS_MANIFEST_TYPE:4e3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,RESTRICTIONS_CANNOT_BE_MET:4012,NO_PERIODS:4014,HLS_PLAYLIST_HEADER_MISSING:4015,INVALID_HLS_TAG:4016,HLS_INVALID_PLAYLIST_HIERARCHY:4017,DASH_DUPLICATE_REPRESENTATION_ID:4018,HLS_MULTIPLE_MEDIA_INIT_SECTIONS_FOUND:4020,HLS_MASTER_PLAYLIST_NOT_PROVIDED:4022,HLS_REQUIRED_ATTRIBUTE_MISSING:4023,HLS_REQUIRED_TAG_MISSING:4024,HLS_COULD_NOT_GUESS_CODECS:4025,HLS_KEYFORMATS_NOT_SUPPORTED:4026,DASH_UNSUPPORTED_XLINK_ACTUATE:4027,DASH_XLINK_DEPTH_LIMIT:4028,HLS_COULD_NOT_PARSE_SEGMENT_START_TIME:4030,CONTENT_UNSUPPORTED_BY_BROWSER:4032,CANNOT_ADD_EXTERNAL_TEXT_TO_LIVE_STREAM:4033,HLS_AES_128_ENCRYPTION_NOT_SUPPORTED:4034,HLS_INTERNAL_SKIP_STREAM:4035,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6e3,REQUESTED_KEY_SYSTEM_CONFIG_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,NO_LICENSE_SERVER_GIVEN:6012,OFFLINE_SESSION_REMOVED:6013,EXPIRED:6014,SERVER_CERTIFICATE_REQUIRED:6015,INIT_DATA_TRANSFORM_ERROR:6016,LOAD_INTERRUPTED:7e3,OPERATION_ABORTED:7001,NO_VIDEO_ELEMENT:7002,CAST_API_UNAVAILABLE:8e3,NO_CAST_RECEIVERS:8001,ALREADY_CASTING:8002,UNEXPECTED_CAST_ERROR:8003,CAST_CANCELED_BY_USER:8004,CAST_CONNECTION_TIMED_OUT:8005,CAST_RECEIVER_APP_UNAVAILABLE:8006,STORAGE_NOT_SUPPORTED:9e3,INDEXED_DB_ERROR:9001,DEPRECATED_OPERATION_ABORTED:9002,REQUESTED_ITEM_NOT_FOUND:9003,MALFORMED_OFFLINE_URI:9004,CANNOT_STORE_LIVE_OFFLINE:9005,STORE_ALREADY_IN_PROGRESS:9006,NO_INIT_DATA_FOR_OFFLINE:9007,LOCAL_PLAYER_INSTANCE_REQUIRED:9008,NEW_KEY_OPERATION_NOT_SUPPORTED:9011,KEY_NOT_FOUND:9012,MISSING_STORAGE_CELL:9013};
/*
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    @license
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Copyright 2008 The Closure Library Authors
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    SPDX-License-Identifier: Apache-2.0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    */
var J=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;
/*
                                                                                                                                @license
                                                                                                                                Copyright 2006 The Closure Library Authors
                                                                                                                                SPDX-License-Identifier: Apache-2.0
                                                                                                                                */function Q(e){var t;e instanceof Q?(Z(this,e.Ba),this.pb=e.pb,this.Aa=e.Aa,ee(this,e.Ob),this.pa=e.pa,te(this,e.g.clone()),this.bb=e.bb):e&&(t=String(e).match(J))?(Z(this,t[1]||"",!0),this.pb=ne(t[2]||""),this.Aa=ne(t[3]||"",!0),ee(this,t[4]),this.pa=ne(t[5]||"",!0),te(this,t[6]||"",!0),this.bb=ne(t[7]||"")):this.g=new le(null)}function Z(e,t,n){e.Ba=n?ne(t,!0):t,e.Ba&&(e.Ba=e.Ba.replace(/:$/,""))}function ee(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.Ob=t}else e.Ob=null}function te(e,t,n){t instanceof le?e.g=t:(n||(t=ie(t,ue)),e.g=new le(t))}function ne(e,t){return e?t?decodeURI(e):decodeURIComponent(e):""}function ie(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,re),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function re(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}(r=Q.prototype).Ba="",r.pb="",r.Aa="",r.Ob=null,r.pa="",r.bb="",r.toString=function(){var e=[],t=this.Ba;if(t&&e.push(ie(t,oe,!0),":"),t=this.Aa){e.push("//");var n=this.pb;n&&e.push(ie(n,oe,!0),"@"),e.push(encodeURIComponent(t).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.Ob)&&e.push(":",String(t))}return(t=this.pa)&&(this.Aa&&"/"!=t.charAt(0)&&e.push("/"),e.push(ie(t,"/"==t.charAt(0)?se:ae,!0))),(t=this.g.toString())&&e.push("?",t),(t=this.bb)&&e.push("#",ie(t,ce)),e.join("")},r.resolve=function(e){var t=this.clone();"data"===t.Ba&&(t=new Q);var n=!!e.Ba;n?Z(t,e.Ba):n=!!e.pb,n?t.pb=e.pb:n=!!e.Aa,n?t.Aa=e.Aa:n=null!=e.Ob;var i=e.pa;if(n)ee(t,e.Ob);else if(n=!!e.pa){if("/"!=i.charAt(0))if(this.Aa&&!this.pa)i="/"+i;else{var r=t.pa.lastIndexOf("/");-1!=r&&(i=t.pa.substr(0,r+1)+i)}if(".."==i||"."==i)i="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}i=o.join("/")}}return n?t.pa=i:n=""!==e.g.toString(),n?te(t,e.g.clone()):n=!!e.bb,n&&(t.bb=e.bb),t},r.clone=function(){return new Q(this)};var oe=/[#\/\?@]/g,ae=/[#\?:]/g,se=/[#\?]/g,ue=/[#\?@]/g,ce=/#/g;function le(e){this.g=e||null}(r=le.prototype).na=null,r.qc=null,r.add=function(e,t){if(!this.na&&(this.na={},this.qc=0,this.g))for(var n=this.g.split("&"),i=0;i<n.length;i++){var r=n[i].indexOf("="),o=null;if(0<=r){var a=n[i].substring(0,r);o=n[i].substring(r+1)}else a=n[i];a=decodeURIComponent(a.replace(/\+/g," ")),o=o||"",this.add(a,decodeURIComponent(o.replace(/\+/g," ")))}return this.g=null,(n=this.na.hasOwnProperty(e)&&this.na[e])||(this.na[e]=n=[]),n.push(t),this.qc++,this},r.toString=function(){if(this.g)return this.g;if(!this.na)return"";var e,t=[];for(e in this.na)for(var n=encodeURIComponent(e),i=this.na[e],r=0;r<i.length;r++){var o=n;""!==i[r]&&(o+="="+encodeURIComponent(i[r])),t.push(o)}return this.g=t.join("&")},r.clone=function(){var e=new le;if(e.g=this.g,this.na){var t,n={};for(t in this.na)n[t]=this.na[t].concat();e.na=n,e.qc=this.qc}return e};var de={df:function(e,t){return e.reduce(function(e,t,n){return t.catch(e.bind(null,n))}.bind(null,t),Promise.reject())},Rc:function(e,t){return e.concat(t)},Bc:function(){},Ra:function(e){return null!=e}};function he(e,t){if(0==t.length)return e;var n=t.map((function(e){return new Q(e)}));return e.map((function(e){return new Q(e)})).map((function(e){return n.map(e.resolve.bind(e))})).reduce(de.Rc,[]).map((function(e){return e.toString()}))}function fe(e,t){return{keySystem:e,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:t||[],keyIds:[]}}var pe={Za:"video",Sb:"audio",za:"text",Ug:"image",Sg:"application"};function ge(){var e,t,n=new Promise((function(n,i){e=n,t=i}));return n.resolve=e,n.reject=t,n}function me(e){if(!e)return"";239==(e=new Uint8Array(e))[0]&&187==e[1]&&191==e[2]&&(e=e.subarray(3)),e=Te(e),e=escape(e);try{return decodeURIComponent(e)}catch(e){throw new $(2,2,2004)}}function ve(e,t,n){if(!e)return"";if(!n&&0!=e.byteLength%2)throw Y.error("Data has an incorrect length, must be even."),new $(2,2,2004);if(e instanceof ArrayBuffer)var i=e;else(n=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),i=n.buffer;e=Math.floor(e.byteLength/2),n=new Uint16Array(e),i=new DataView(i);for(var r=0;r<e;r++)n[r]=i.getUint16(2*r,t);return Te(n)}function ye(e){var t=new Uint8Array(e);if(239==t[0]&&187==t[1]&&191==t[2])return me(t);if(254==t[0]&&255==t[1])return ve(t.subarray(2),!1);if(255==t[0]&&254==t[1])return ve(t.subarray(2),!0);var n=function(e,t){return e.byteLength<=t||32<=e[t]&&126>=e[t]}.bind(null,t);if(Y.debug("Unable to find byte-order-mark, making an educated guess."),0==t[0]&&0==t[2])return ve(e,!1);if(0==t[1]&&0==t[3])return ve(e,!0);if(n(0)&&n(1)&&n(2)&&n(3))return me(e);throw new $(2,2,2003)}function be(e){e=encodeURIComponent(e),e=unescape(e);for(var t=new Uint8Array(e.length),n=0;n<e.length;++n)t[n]=e.charCodeAt(n);return t.buffer}function we(e,t){for(var n=new Uint8Array(2*e.length),i=new DataView(n.buffer),r=0;r<e.length;++r)i.setUint16(2*r,e.charCodeAt(r),t);return n.buffer}function Te(e){if(!Se)for(var t=function(e){try{var t=new Uint8Array(e);return 0<String.fromCharCode.apply(null,t).length}catch(e){return!1}},n={size:65536};0<n.size;(n={size:n.size}).size/=2)if(t(n.size)){Se=function(e){return function(t){for(var n="",i=0;i<t.length;i+=e.size)n+=String.fromCharCode.apply(null,t.subarray(i,i+e.size));return n}}(n);break}return Se(e)}ge.prototype.resolve=function(){},ge.prototype.reject=function(){},V("shaka.util.StringUtils.fromUTF8",me),V("shaka.util.StringUtils.fromUTF16",ve),V("shaka.util.StringUtils.fromBytesAutoDetect",ye),V("shaka.util.StringUtils.toUTF8",be),V("shaka.util.StringUtils.toUTF16",we);var Se=null;V("shaka.util.StringUtils.resetFromCharCode",(function(){Se=null}));var Ee={Mc:function(t,n){var i=Te(t);return n=null==n||n,i=e.btoa(i).replace(/\+/g,"-").replace(/\//g,"_"),n?i:i.replace(/=*$/,"")}};function xe(){this.g=new muxjs.mp4.Transmuxer({keepOriginalTimestamps:!0}),this.h=null,this.l=[],this.i=[],this.j=!1,this.g.on("data",this.o.bind(this)),this.g.on("done",this.m.bind(this))}function ke(t,n){return!(!e.muxjs||"mp2t"!=t.toLowerCase().split(";")[0].split("/")[1])&&(n?MediaSource.isTypeSupported(Ae(n,t)):MediaSource.isTypeSupported(Ae("audio",t))||MediaSource.isTypeSupported(Ae("video",t)))}function Ae(e,t){var n=t.replace(/mp2t/i,"mp4");"audio"==e&&(n=n.replace("video","audio"));var i=/avc1\.(66|77|100)\.(\d+)/.exec(n);if(i){var r="avc1.",o=i[1],a=Number(i[2]);r=("66"==o?r+"4200":"77"==o?r+"4d00":r+"6400")+(a>>4).toString(16),r+=(15&a).toString(16),n=n.replace(i[0],r)}return n}function Me(e){this.h=e,this.g=null}function Ie(e){this.h=e,this.g=null}function Pe(e,t){var n={maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0};this.o=null==e.maxAttempts?n.maxAttempts:e.maxAttempts,this.j=null==e.baseDelay?n.baseDelay:e.baseDelay,this.m=null==e.fuzzFactor?n.fuzzFactor:e.fuzzFactor,this.l=null==e.backoffFactor?n.backoffFactor:e.backoffFactor,this.g=0,this.h=this.j,(this.i=void 0!==t&&t)&&(this.g=1)}function Ce(e){return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:if(e.g>=e.o){if(!e.i)return t.return(Promise.reject());e.g=1,e.h=e.j}return n=e.g,e.g++,0==n?t.return():(i=e.h*(1+(2*Math.random()-1)*e.m),k(t,new Promise((function(e){new Ie(e).V(i/1e3)})),2));case 2:e.h*=e.l,A(t)}}))}))}function Re(e,t){this.promise=e,this.se=t,this.g=!1}function Ne(e){return new Re(Promise.reject(e),(function(){return Promise.resolve()}))}function De(){var e=Promise.reject(new $(2,7,7001));return e.catch((function(){})),new Re(e,(function(){return Promise.resolve()}))}function je(e){return new Re(Promise.resolve(e),(function(){return Promise.resolve()}))}function _e(e){return new Re(e,(function(){return e.catch((function(){}))}))}function Le(e){return new Re(Promise.all(e.map((function(e){return e.promise}))),(function(){return Promise.all(e.map((function(e){return e.abort()})))}))}function Ue(t,n){for(var i in n=void 0===n?{}:n)this[i]=n[i];this.defaultPrevented=this.cancelable=this.bubbles=!1,this.timeStamp=e.performance&&e.performance.now?e.performance.now():Date.now(),this.type=t,this.isTrusted=!1,this.target=this.currentTarget=null,this.g=!1}function Oe(){this.g={}}function Ke(){this.hd=new Oe,this.jc=this}function Be(e){var t=new Set;return function e(i){switch(void 0===i?"undefined":n(i)){case"undefined":case"boolean":case"number":case"string":case"symbol":case"function":return i;default:if(!i||i.buffer&&i.buffer.constructor==ArrayBuffer)return i;if(t.has(i))return null;var r=i.constructor==Array;if(i.constructor!=Object&&!r)return null;t.add(i);var o,a=r?[]:{};for(o in i)a[o]=e(i[o]);return r&&(a.length=i.length),a}}(e)}function Fe(e,t){return!("number"!=typeof e||"number"!=typeof t||!isNaN(e)||!isNaN(t))||e===t}function He(e,t){var n=e.indexOf(t);-1<n&&e.splice(n,1)}function Ve(e,t,n){if(n||(n=Fe),e.length!=t.length)return!1;t=t.slice();for(var i={},r=(e=f(e)).next();!r.done;i={item:i.item},r=e.next()){if(i.item=r.value,-1==(r=t.findIndex(function(e){return function(t){return n(e.item,t)}}(i))))return!1;t[r]=t[t.length-1],t.pop()}return 0==t.length}function Ge(){this.g=[]}function qe(e,t){e.g.push(t.finally((function(){He(e.g,t)})))}function ze(e){Ke.call(this),this.j=!1,this.l=new Ge,this.g=new Set,this.h=new Set,this.i=e||null}V("shaka.util.Uint8ArrayUtils.toBase64",Ee.Mc),Ee.Ja=function(t){t=e.atob(t.replace(/-/g,"+").replace(/_/g,"/"));for(var n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n},V("shaka.util.Uint8ArrayUtils.fromBase64",Ee.Ja),Ee.$c=function(t){for(var n=new Uint8Array(t.length/2),i=0;i<t.length;i+=2)n[i/2]=e.parseInt(t.substr(i,2),16);return n},V("shaka.util.Uint8ArrayUtils.fromHex",Ee.$c),Ee.Nc=function(e){for(var t="",n=0;n<e.length;++n){var i=e[n].toString(16);1==i.length&&(i="0"+i),t+=i}return t},V("shaka.util.Uint8ArrayUtils.toHex",Ee.Nc),Ee.Ha=function(e,t){if(!e&&!t)return!0;if(!e||!t||e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!=t[n])return!1;return!0},V("shaka.util.Uint8ArrayUtils.equal",Ee.Ha),Ee.concat=function(e){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];for(var i=n=0;i<t.length;++i)n+=t[i].length;n=new Uint8Array(n);for(var r=i=0;r<t.length;++r)n.set(t[r],i),i+=t[r].length;return n},V("shaka.util.Uint8ArrayUtils.concat",Ee.concat),xe.prototype.destroy=function(){return this.g.dispose(),this.g=null,Promise.resolve()},xe.prototype.o=function(e){this.i=e.captions;var t=new Uint8Array(e.data.byteLength+e.initSegment.byteLength);t.set(e.initSegment,0),t.set(e.data,e.initSegment.byteLength),this.l.push(t)},xe.prototype.m=function(){var e={data:Ee.concat.apply(null,this.l),captions:this.i};this.h.resolve(e),this.j=!1},Me.prototype.V=function(t){var n=this;this.stop();var i=!0,r=null;return this.g=function(){e.clearTimeout(r),i=!1},r=e.setTimeout((function(){i&&n.h()}),1e3*t),this},Me.prototype.stop=function(){this.g&&(this.g(),this.g=null)},V("shaka.util.Timer",Ie),Ie.prototype.Lc=function(){return this.stop(),this.h(),this},Ie.prototype.tickNow=Ie.prototype.Lc,Ie.prototype.V=function(e){var t=this;return this.stop(),this.g=new Me((function(){t.h()})).V(e),this},Ie.prototype.tickAfter=Ie.prototype.V,Ie.prototype.Oa=function(e){var t=this;return this.stop(),this.g=new Me((function(){t.g.V(e),t.h()})).V(e),this},Ie.prototype.tickEvery=Ie.prototype.Oa,Ie.prototype.stop=function(){this.g&&(this.g.stop(),this.g=null)},Ie.prototype.stop=Ie.prototype.stop,V("shaka.util.AbortableOperation",Re),Re.failed=Ne,Re.aborted=De,Re.completed=je,Re.notAbortable=_e,Re.prototype.abort=function(){return this.g=!0,this.se()},Re.prototype.abort=Re.prototype.abort,Re.all=Le,Re.prototype.finally=function(e){return this.promise.then((function(){return e(!0)}),(function(){return e(!1)})),this},Re.prototype.finally=Re.prototype.finally,Re.prototype.ca=function(e,t){function n(n){return function(s){if(r.g&&n)o.reject(a);else{var u=n?e:t;u?i=function(e,t,n){try{var i=e(t);return i&&i.promise&&i.abort?(n.resolve(i.promise),function(){return i.abort()}):(n.resolve(i),function(){return Promise.resolve(i).then((function(){}),(function(){}))})}catch(e){return n.reject(e),function(){return Promise.resolve()}}}(u,s,o):(n?o.resolve:o.reject)(s)}}}function i(){return o.reject(a),r.abort()}var r=this,o=new ge,a=new $(2,7,7001);return this.promise.then(n(!0),n(!1)),new Re(o,(function(){return i()}))},Re.prototype.chain=Re.prototype.ca,V("shaka.util.FakeEvent",Ue),Ue.prototype.preventDefault=function(){this.cancelable&&(this.defaultPrevented=!0)},Ue.prototype.stopImmediatePropagation=function(){this.g=!0},Ue.prototype.stopPropagation=function(){},(r=Oe.prototype).push=function(e,t){this.g.hasOwnProperty(e)?this.g[e].push(t):this.g[e]=[t]},r.get=function(e){return(e=this.g[e])?e.slice():null},r.getAll=function(){var e,t=[];for(e in this.g)t.push.apply(t,this.g[e]);return t},r.remove=function(e,t){var n=this.g[e];if(n)for(var i=0;i<n.length;++i)n[i]==t&&(n.splice(i,1),--i)},r.forEach=function(e){for(var t in this.g)e(t,this.g[t])},r.size=function(){return Object.keys(this.g).length},Ke.prototype.addEventListener=function(e,t){this.hd.push(e,t)},Ke.prototype.removeEventListener=function(e,t){this.hd.remove(e,t)},Ke.prototype.dispatchEvent=function(e){for(var t=this.hd.get(e.type)||[],n=0;n<t.length;++n){e.target=this.jc,e.currentTarget=this.jc;var i=t[n];try{i.handleEvent?i.handleEvent(e):i.call(this,e)}catch(e){Y.error("Uncaught exception in event handler",e,e?e.message:null,e?e.stack:null)}if(e.g)break}return e.defaultPrevented},Ge.prototype.destroy=function(){var e=[];return this.g.forEach((function(t){t.promise.catch((function(){})),e.push(t.abort())})),this.g=[],Promise.all(e)},G(ze,Ke),V("shaka.net.NetworkingEngine",ze),ze.RequestType={MANIFEST:0,SEGMENT:1,LICENSE:2,APP:3,TIMING:4},ze.PluginPriority={FALLBACK:1,PREFERRED:2,APPLICATION:3};var We={};function Xe(e,t,n){n=n||3;var i=We[e];(!i||n>=i.priority)&&(We[e]={priority:n,mg:t})}function Ye(e,t){return{uris:e,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:t,licenseRequestType:null,sessionId:null}}function $e(){this.g=0}function Je(e,t,n){Re.call(this,e,t),this.h=n}function Qe(){}function Ze(){this.g=new Oe}function et(e,t,n,i){this.target=e,this.type=t,this.listener=n,this.g=function(e,t){if(null==t)return!1;if("boolean"==typeof t)return t;var n=new Set(["passive","capture"]);return Object.keys(t).filter((function(e){return!n.has(e)})),function(e){var t=tt;if(null==t){t=!1;try{var n={},i={get:function(){return t=!0,!1}};Object.defineProperty(n,"passive",i),Object.defineProperty(n,"capture",i),i=function(){},e.addEventListener("test",i,n),e.removeEventListener("test",i,n)}catch(e){t=!1}tt=t}return t||!1}(e)?t:t.capture||!1}(e,i),this.target.addEventListener(t,n,this.g)}ze.registerScheme=Xe,ze.unregisterScheme=function(e){delete We[e]},ze.prototype.og=function(e){this.g.add(e)},ze.prototype.registerRequestFilter=ze.prototype.og,ze.prototype.Ng=function(e){this.g.delete(e)},ze.prototype.unregisterRequestFilter=ze.prototype.Ng,ze.prototype.bf=function(){this.g.clear()},ze.prototype.clearAllRequestFilters=ze.prototype.bf,ze.prototype.pg=function(e){this.h.add(e)},ze.prototype.registerResponseFilter=ze.prototype.pg,ze.prototype.Og=function(e){this.h.delete(e)},ze.prototype.unregisterResponseFilter=ze.prototype.Og,ze.prototype.cf=function(){this.h.clear()},ze.prototype.clearAllResponseFilters=ze.prototype.cf,ze.defaultRetryParameters=function(){return{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0}},ze.makeRequest=Ye,ze.prototype.destroy=function(){return this.j=!0,this.g.clear(),this.h.clear(),this.l.destroy()},ze.prototype.destroy=ze.prototype.destroy,ze.prototype.request=function(e,t){var n=this,i=new $e;if(this.j){var r=Promise.reject(new $(2,7,7001));return r.catch((function(){})),new Je(r,(function(){return Promise.resolve()}),i)}t.method=t.method||"GET",t.headers=t.headers||{},t.retryParameters=t.retryParameters?Be(t.retryParameters):{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},t.uris=Be(t.uris);var o=(r=function(e,t,n){for(var i=je(void 0),r={},o=(e=f(e.g)).next();!o.done;r={Gd:r.Gd},o=e.next())r.Gd=o.value,i=i.ca(function(e){return function(){return e.Gd(t,n)}}(r));return i.ca(void 0,(function(e){if(e&&7001==e.code)throw e;throw new $(2,1,1006,e)}))}(this,e,t)).ca((function(){return function e(t,n,i,r,o,a,s){var u=new Q(i.uris[o]),c=u.Ba,l=!1;c||(c=(c=location.protocol).slice(0,-1),Z(u,c),i.uris[o]=u.toString()),c=c.toLowerCase();var d,h=(c=We[c])?c.mg:null;return h?_e(Ce(r)).ca((function(){return t.j?De():(d=Date.now(),h(i.uris[o],i,n,(function(e,i,r){t.i&&1==n&&(t.i(e,i),l=!0,s.g=r)})))})).ca((function(e){return null==e.timeMs&&(e.timeMs=Date.now()-d),{response:e,Nf:l}}),(function(u){if(u&&7001==u.code)throw u;if(t.j)return De();if(u&&1==u.severity)return t.dispatchEvent(new Ue("retry",{error:u instanceof $?u:null})),o=(o+1)%i.uris.length,e(t,n,i,r,o,u,s);throw u||a})):Ne(new $(2,1,1e3,u))}(n,e,t,new Pe(t.retryParameters,!1),0,null,i)})),a=o.ca((function(t){return function(e,t,n){for(var i=je(void 0),r=(e=f(e.h)).next();!r.done;r=e.next())i=i.ca(r.value.bind(null,t,n.response));return i.ca((function(){return n}),(function(e){if(e&&7001==e.code)throw e;var t=2;throw e instanceof $&&(t=e.severity),new $(t,1,1007,e)}))}(n,e,t)})),s=Date.now(),u=0;r.promise.then((function(){u=Date.now()-s}),(function(){}));var c=0;return o.promise.then((function(){c=Date.now()}),(function(){})),r=new Je((r=a.ca((function(t){var i=Date.now()-c,r=t.response;return r.timeMs+=u,r.timeMs+=i,t.Nf||!n.i||r.fromCache||1!=e||n.i(r.timeMs,r.data.byteLength),r}),(function(e){throw e&&(e.severity=2),e}))).promise,r.se,i),qe(this.l,r),r},ze.prototype.request=ze.prototype.request,ze.NumBytesRemainingClass=$e,T(Je,Re),ze.PendingRequest=Je,Je.all=Le,Je.notAbortable=_e,Je.completed=je,Je.aborted=De,Je.failed=Ne,V("shaka.util.IReleasable",Qe),Qe.prototype.release=function(){},V("shaka.util.EventManager",Ze),Ze.prototype.release=function(){this.nb(),this.g=null},Ze.prototype.release=Ze.prototype.release,Ze.prototype.H=function(e,t,n,i){this.g&&(e=new et(e,t,n,i),this.g.push(t,e))},Ze.prototype.listen=Ze.prototype.H,Ze.prototype.ya=function(e,t,n,i){var r=this;this.H(e,t,(function i(o){r.ta(e,t,i),n(o)}),i)},Ze.prototype.listenOnce=Ze.prototype.ya,Ze.prototype.ta=function(e,t,n){if(this.g)for(var i=this.g.get(t)||[],r=(i=f(i)).next();!r.done;r=i.next())(r=r.value).target!=e||n!=r.listener&&n||(r.ta(),this.g.remove(t,r))},Ze.prototype.unlisten=Ze.prototype.ta,Ze.prototype.nb=function(){if(this.g){for(var e=this.g.getAll(),t=(e=f(e)).next();!t.done;t=e.next())t.value.ta();this.g.g={}}},Ze.prototype.removeAll=Ze.prototype.nb,et.prototype.ta=function(){this.target.removeEventListener(this.type,this.listener,this.g),this.listener=this.target=null,this.g=!1},et.prototype.unlisten=et.prototype.ta;var tt=void 0;function nt(e){return new Q(e=ye(e)).Aa}function it(e,t,n){function i(e){new DataView(r.buffer).setUint32(o,e.byteLength,!0),o+=4,r.set(e,o),o+=e.byteLength}if(!n||!n.byteLength)throw new $(2,6,6015);t="string"==typeof t?new Uint8Array(we(t,!0)):new Uint8Array(t),e=we(e=ye(e),!0);var r=new Uint8Array(12+e.byteLength+t.byteLength+n.byteLength),o=0;return i(new Uint8Array(e)),i(t),i(new Uint8Array(n)),r}function rt(e,t){for(var n=[],i=f(e),r=i.next();!r.done;r=i.next())n.push(t(r.value));return n}function ot(e,t){for(var n=f(e),i=n.next();!i.done;i=n.next())if(!t(i.value))return!1;return!0}function at(e){var t=new Map;return Object.keys(e).forEach((function(n){t.set(n,e[n])})),t}function st(e){var t={};return e.forEach((function(e,n){t[n]=e})),t}function ut(e,t){var n=e;return t&&(n+='; codecs="'+t+'"'),n}function ct(e){return(e=e.split(/ *; */)).shift(),(e=e.find((function(e){return e.startsWith("codecs=")})))?e.split("=")[1].replace(/^"|"$/g,""):""}function lt(e){var t=(e=e.split("."))[0];return e.pop(),[t,e.join(".")]}V("shaka.util.FairPlayUtils.defaultGetContentId",nt),V("shaka.util.FairPlayUtils.initDataTransform",it);var dt=(new Map).set("codecs","codecs").set("frameRate","framerate").set("bandwidth","bitrate").set("width","width").set("height","height").set("channelsCount","channels");function ht(){return!(!e.MediaSource||!MediaSource.isTypeSupported)}function ft(e){return""!=yt().canPlayType(e)}function pt(){return vt("Tizen")}function gt(){return!!navigator.vendor&&navigator.vendor.includes("Apple")&&!pt()}function mt(){if(!gt())return null;var e=navigator.userAgent.match(/Version\/(\d+)/);return e||(e=navigator.userAgent.match(/OS (\d+)(?:_\d+)?/))?parseInt(e[1],10):null}function vt(e){return(navigator.userAgent||"").includes(e)}function yt(){return wt||(bt||(bt=new Ie((function(){wt=null}))),(wt=document.getElementsByTagName("video")[0]||document.getElementsByTagName("audio")[0])||(wt=document.createElement("video")),bt.V(1),wt)}var bt=null,wt=null;function Tt(e,t){var n=this;t=void 0===t?1:t,this.J=e,this.C=new Set,this.m=this.o=null,this.Z=!1,this.P=0,this.g=null,this.u=new Ze,this.h=new Map,this.F=[],this.A=new ge,this.j=null,this.l=function(t){n.A.reject(t),e.onError(t)},this.wa=new Map,this.da=new Map,this.X=new Ie((function(){return function(e){var t=e.wa,n=e.da;n.clear(),t.forEach((function(e,t){return n.set(t,e)})),(t=Array.from(n.values())).length&&t.every((function(e){return"expired"==e}))&&e.l(new $(2,6,6014)),e.J.Dc(st(n))}(n)})),this.i=!1,this.ua=new ge,this.L=!1,this.M=[],this.va=!1,this.ea=new Ie((function(){!function(e){e.h.forEach((function(t,n){var i=t.xd,r=n.expiration;isNaN(r)&&(r=1/0),r!=i&&(e.J.onExpirationUpdated(n.sessionId,r),t.xd=r)}))}(n)})).Oa(t),this.A.catch((function(){}))}function St(e,t,n){return e.F=n,e.L=0<n.length,Et(e,t)}function Et(t,n){var i=function(t){if(0==(t=at(t.j.clearKeys)).size)return null;var n=[],i=[];t.forEach((function(e,t){var r=Ee.$c(t),o=Ee.$c(e);r={kty:"oct",kid:Ee.Mc(r,!1),k:Ee.Mc(o,!1)},n.push(r),i.push(r.kid)})),t=JSON.stringify({keys:n});var r=JSON.stringify({kids:i});return r=[{initData:new Uint8Array(be(r)),initDataType:"keyids"}],{keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64,"+e.btoa(t),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:r,keyIds:[]}}(t);if(i)for(var r=f(n),o=r.next();!o.done;o=r.next())o.value.drmInfos=[i];for((i=n.some((function(e){return 0<e.drmInfos.length})))||function(e,t){var n=[];t.forEach((function(e,t){n.push({keySystem:t,licenseServerUri:e,distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],keyIds:[]})}));for(var i=f(e),r=i.next();!r.done;r=i.next())r.value.drmInfos=n}(n,o=at(t.j.servers)),o=(r=f(n)).next();!o.done;o=r.next())for(var a=(o=f(o.value.drmInfos)).next();!a.done;a=o.next())Bt(a.value,at(t.j.servers),at(t.j.advanced||{}));return(o=function(e,t){for(var n=new Set,i=f(t),r=i.next();!r.done;r=i.next()){var o=f(r.value.drmInfos);for(r=o.next();!r.done;r=o.next())n.add(r.value)}for(i=f(n),r=i.next();!r.done;r=i.next())Bt(r.value,at(e.j.servers),at(e.j.advanced||{}));o=e.L?"required":"optional";var a=e.L?["persistent-license"]:["temporary"];for(i=new Map,n=f(n),r=n.next();!r.done;r=n.next())r=r.value,i.set(r.keySystem,{audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:o,sessionTypes:a,label:r.keySystem,drmInfos:[]});for(n=f(t),r=n.next();!r.done;r=n.next()){r=r.value,o=r.audio,a=r.video;var s=o?Ct(o):"",u=a?Ct(a):"",c=f(r.drmInfos);for(r=c.next();!r.done;r=c.next()){r=r.value;var l=i.get(r.keySystem);l.drmInfos.push(r),r.distinctiveIdentifierRequired&&(l.distinctiveIdentifier="required"),r.persistentStateRequired&&(l.persistentState="required"),o&&(l.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:s}),"ac-3"==o.codecs.toLowerCase()&&pt()&&l.audioCapabilities.push({robustness:r.audioRobustness||"",contentType:ut(o.mimeType,"ec-3")})),a&&l.videoCapabilities.push({robustness:r.videoRobustness||"",contentType:u})}}return i}(t,n)).size?(o=Rt(t,o),i?o:o.catch((function(){}))):(t.Z=!0,Promise.resolve())}function xt(e){return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:if(!(e.o&&e.g&&e.g.serverCertificate&&e.g.serverCertificate.length)){t.I(0);break}return M(t,3),k(t,e.o.setServerCertificate(e.g.serverCertificate),5);case 5:t.B||Y.v("Server certificates are not supported by the key system.  The server certificate has been ignored."),P(t,0);break;case 3:return n=C(t),t.return(Promise.reject(new $(2,6,6004,n.message)))}}))}))}function kt(e){var t=e.g?e.g.initData:[];return t.forEach((function(t){return At(e,t.initDataType,t.initData)})),e.F.forEach((function(t){return Nt(e,t)})),t.length||e.F.length||e.A.resolve(),e.A}function At(e,t,n){for(var i=e.h.values(),r=(i=f(i)).next();!r.done;r=i.next())if(Ee.Ha(n,r.value.initData)&&!vt("Tizen 2"))return void Y.debug("Ignoring duplicate init data.");!function(e,t,n){try{if(e.L){Y.K("Creating new persistent session");var i=e.o.createSession("persistent-license")}else Y.K("Creating new temporary session"),i=e.o.createSession()}catch(t){return void e.l(new $(2,6,6005,t.message))}e.u.H(i,"message",e.ye.bind(e)),e.u.H(i,"keystatuseschange",e.we.bind(e)),e.h.set(i,{initData:n,loaded:!1,xd:1/0,Ga:null});try{n=e.j.initDataTransform(n,e.g)}catch(n){return t=n,n instanceof $||(t=new $(2,6,6016,n)),void e.l(t)}i.generateRequest(t,n).catch((function(t){if(!e.i){if(e.h.delete(i),t.errorCode&&t.errorCode.systemCode){var n=t.errorCode.systemCode;0>n&&(n+=Math.pow(2,32)),n="0x"+n.toString(16)}e.l(new $(2,6,6006,t.message,t,n))}}))}(e,t,n)}function Mt(e){return e?e.keySystem:""}function It(e,t){if(navigator.userAgent.match(/Edge\//))return!0;if(t=t.toLowerCase(),pt()&&t.includes('codecs="ac-3"')){var n=t.replace("ac-3","ec-3");return e.C.has(t)||e.C.has(n)}return e.C.has(t)}function Pt(e){return e=rt(e=e.h.keys(),(function(e){return e.sessionId})),Array.from(e)}function Ct(e){var t=ut(e.mimeType,e.codecs);return ke(t)?Ae(e.type,t):t}function Rt(e,t){if(1==t.size&&t.has(""))return Promise.reject(new $(2,6,6e3));for(var n=f(t.values()),i=n.next();!i.done;i=n.next())0==(i=i.value).audioCapabilities.length&&delete i.audioCapabilities,0==i.videoCapabilities.length&&delete i.videoCapabilities;var r=n=new ge;return[!0,!1].forEach(function(e){var n=this;t.forEach((function(t,i){t.drmInfos.some((function(e){return!!e.licenseServerUri}))==e&&(r=r.catch(function(){if(!this.i)return navigator.requestMediaKeySystemAccess(i,[t])}.bind(n)))}))}.bind(e)),r=(r=r.catch((function(){return Promise.reject(new $(2,6,6001))}))).then(function(e){if(this.i)return Promise.reject();this.C.clear();var n=e.getConfiguration(),i=n.videoCapabilities||[],r=f(n.audioCapabilities||[]);for(n=r.next();!n.done;n=r.next())this.C.add(n.value.contentType.toLowerCase());for(n=(i=f(i)).next();!n.done;n=i.next())this.C.add(n.value.contentType.toLowerCase());i=e.keySystem,r=[];var o=[],a=[],s=[];return function(e,t,n,i,r){e.forEach((function(e){if(t.includes(e.licenseServerUri)||t.push(e.licenseServerUri),e.serverCertificate&&(n.some((function(t){return Ee.Ha(t,e.serverCertificate)}))||n.push(e.serverCertificate)),e.initData&&e.initData.forEach((function(e){i.some((function(t){return!(!t.keyId||t.keyId!=e.keyId)||t.initDataType==e.initDataType&&Ee.Ha(t.initData,e.initData)}))||i.push(e)})),e.keyIds)for(var o=0;o<e.keyIds.length;++o)r.includes(e.keyIds[o])||r.push(e.keyIds[o])}))}((n=t.get(e.keySystem)).drmInfos,r,o,a,s),1<o.length&&Y.v("Multiple unique server certificates found! Only the first will be used."),1<r.length&&Y.v("Multiple unique license server URIs found! Only the first will be used."),this.g={keySystem:i,licenseServerUri:r[0],distinctiveIdentifierRequired:"required"==n.distinctiveIdentifier,persistentStateRequired:"required"==n.persistentState,audioRobustness:(n.audioCapabilities?n.audioCapabilities[0].robustness:"")||"",videoRobustness:(n.videoCapabilities?n.videoCapabilities[0].robustness:"")||"",serverCertificate:o[0],initData:a,keyIds:s},this.g.licenseServerUri?e.createMediaKeys():Promise.reject(new $(2,6,6012,this.g.keySystem))}.bind(e)).then(function(e){if(this.i)return Promise.reject();Y.info("Created MediaKeys object for key system",this.g.keySystem),this.o=e,this.Z=!0}.bind(e)).catch(function(e){if(!this.i)return this.g=null,this.C.clear(),e instanceof $?Promise.reject(e):Promise.reject(new $(2,6,6002,e.message))}.bind(e)),n.reject(),r}function Nt(e,t){try{Y.K("Attempting to load an offline session",t);var n=e.o.createSession("persistent-license")}catch(t){var i=new $(2,6,6005,t.message);return e.l(i),Promise.reject(i)}e.u.H(n,"message",e.ye.bind(e)),e.u.H(n,"keystatuseschange",e.we.bind(e));var r={initData:null,loaded:!1,xd:1/0,Ga:null};return e.h.set(n,r),n.load(t).then(function(e){return this.i?Promise.reject():(Y.O("Loaded offline session",t,e),e?(r.loaded=!0,Kt(this)&&this.A.resolve(),n):(this.h.delete(n),void this.l(new $(2,6,6013))))}.bind(e),function(e){this.i||(this.h.delete(n),this.l(new $(2,6,6005,e.message)))}.bind(e))}function Dt(e,t){if(Mt(t).startsWith("com.apple.fps")){var n=t.serverCertificate;e=it(e,nt(e),n)}return e}function jt(e,t){var n=t.target;Y.K("Sending license request for session",n.sessionId,"of type",t.messageType);var i=e.h.get(n),r=e.g.licenseServerUri,o=e.j.advanced[e.g.keySystem];"individualization-request"==t.messageType&&o&&o.individualizationServer&&(r=o.individualizationServer),(r=Ye([r],e.j.retryParameters)).body=t.message,r.method="POST",r.licenseRequestType=t.messageType,r.sessionId=n.sessionId,"com.microsoft.playready"!=e.g.keySystem&&"com.chromecast.playready"!=e.g.keySystem||function(e){var t=ve(e.body,!0,!0);if(t.includes("PlayReadyKeyMessage")){Y.debug("Unwrapping PlayReady request.");for(var n=(t=(new DOMParser).parseFromString(t,"application/xml")).getElementsByTagName("HttpHeader"),i=0;i<n.length;++i)e.headers[n[i].getElementsByTagName("name")[0].textContent]=n[i].getElementsByTagName("value")[0].textContent;e.body=Ee.Ja(t.getElementsByTagName("Challenge")[0].textContent).buffer}else Y.debug("PlayReady request is already unwrapped."),e.headers["Content-Type"]="text/xml; charset=utf-8"}(r),e.g.keySystem.startsWith("com.apple.fps")&&e.j.fairPlayTransform&&function(e){var t=new Uint8Array(e.body);t="spc="+Ee.Mc(t),e.headers["Content-Type"]="application/x-www-form-urlencoded",e.body=be(t)}(r);var a=Date.now();e.J.Ib.request(2,r).promise.then(function(e){return this.i?Promise.reject():(this.g.keySystem.startsWith("com.apple.fps")&&this.j.fairPlayTransform&&function(e){try{var t=me(e.data)}catch(e){return}"<ckc>"===(t=t.trim()).substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6));try{t=JSON.parse(t).ckc}catch(e){}e.data=Ee.Ja(t).buffer}(e),this.P+=(Date.now()-a)/1e3,Y.K("Updating session",n.sessionId),n.update(e.data).then(function(){var e=this;this.J.onEvent(new Ue("drmsessionupdate")),i&&(i.Ga&&i.Ga.resolve(),new Ie((function(){i.loaded=!0,Kt(e)&&e.A.resolve()})).V(Ht))}.bind(this)))}.bind(e),function(e){this.i||(e=new $(2,6,6007,e),this.l(e),i&&i.Ga&&i.Ga.reject(e))}.bind(e)).catch(function(e){this.i||(e=new $(2,6,6008,e.message),this.l(e),i&&i.Ga&&i.Ga.reject(e))}.bind(e))}function _t(){var e=[{contentType:'video/mp4; codecs="avc1.42E01E"'},{contentType:'video/webm; codecs="vp8"'}],t=[{videoCapabilities:e,persistentState:"required",sessionTypes:["persistent-license"]},{videoCapabilities:e}],n=new Map;return e="org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.3_0 com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").map((function(e){return function(e){return g((function i(){var r,o,a;return U(i,(function(i){switch(i.s){case 1:return M(i,2),k(i,navigator.requestMediaKeySystemAccess(e,t),4);case 4:return r=i.B,a=!!(o=r.getConfiguration().sessionTypes)&&o.includes("persistent-license"),vt("Tizen 3")&&(a=!1),n.set(e,{persistentState:a}),k(i,r.createMediaKeys(),5);case 5:P(i,0);break;case 2:C(i),n.set(e,null),A(i)}}))}))}(e)})),Promise.all(e).then((function(){return st(n)}))}function Lt(e,t){var n=t.audio,i=t.video;if(n&&n.encrypted&&!It(e,n=Ct(n))||i&&i.encrypted&&!It(e,i=Ct(i)))return!1;var r=Mt(e.g);return 0==t.drmInfos.length||t.drmInfos.some((function(e){return e.keySystem==r}))}function Ut(e,t){if(!e.length)return t;if(!t.length)return e;for(var n=[],i=0;i<e.length;i++)for(var r=0;r<t.length;r++)if(e[i].keySystem==t[r].keySystem){var o=e[i];r=t[r];var a=[];a=(a=a.concat(o.initData||[])).concat(r.initData||[]);var s=[];s=(s=s.concat(o.keyIds)).concat(r.keyIds),n.push({keySystem:o.keySystem,licenseServerUri:o.licenseServerUri||r.licenseServerUri,distinctiveIdentifierRequired:o.distinctiveIdentifierRequired||r.distinctiveIdentifierRequired,persistentStateRequired:o.persistentStateRequired||r.persistentStateRequired,videoRobustness:o.videoRobustness||r.videoRobustness,audioRobustness:o.audioRobustness||r.audioRobustness,serverCertificate:o.serverCertificate||r.serverCertificate,initData:a,keyIds:s});break}return n}function Ot(e){return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:return n=Array.from(e.h.keys()),e.h.clear(),k(t,Promise.all(n.map((function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:return Y.K("Closing session",e.sessionId),M(t,2),k(t,function(e){return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:return n=new Promise((function(e,t){new Ie(t).V(Ft)})),M(t,2),k(t,Promise.race([Promise.all([e.close(),e.closed]),n]),4);case 4:P(t,0);break;case 2:C(t),Y.v("Timeout waiting for session close"),A(t)}}))}))}(e),4);case 4:P(t,0);break;case 2:C(t),A(t)}}))}))}))),0)}}))}))}function Kt(e){return ot(e=e.h.values(),(function(e){return e.loaded}))}function Bt(t,n,i){!t.keySystem||"org.w3.clearkey"==t.keySystem&&t.licenseServerUri||(n.size&&(n=n.get(t.keySystem)||"",t.licenseServerUri=n),t.keyIds||(t.keyIds=[]),(i=i.get(t.keySystem))&&(t.distinctiveIdentifierRequired||(t.distinctiveIdentifierRequired=i.distinctiveIdentifierRequired),t.persistentStateRequired||(t.persistentStateRequired=i.persistentStateRequired),t.videoRobustness||(t.videoRobustness=i.videoRobustness),t.audioRobustness||(t.audioRobustness=i.audioRobustness),t.serverCertificate||(t.serverCertificate=i.serverCertificate)),e.cast&&e.cast.__platform__&&"com.microsoft.playready"==t.keySystem&&(t.keySystem="com.chromecast.playready"))}(r=Tt.prototype).destroy=function(){var e=this;return g((function t(){return U(t,(function(t){switch(t.s){case 1:return e.i?k(t,e.ua,0):(e.i=!0,k(t,function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:return e.u.release(),e.u=null,e.A.reject(),e.ea.stop(),e.ea=null,e.X.stop(),e.X=null,k(t,Ot(e),2);case 2:if(!e.m){t.I(3);break}return M(t,4),k(t,e.m.setMediaKeys(null),6);case 6:P(t,5);break;case 4:C(t);case 5:e.m=null;case 3:e.g=null,e.C.clear(),e.o=null,e.F=[],e.j=null,e.l=null,e.J=null,A(t)}}))}))}(e),4));case 4:e.ua.resolve(),t.I(0)}}))}))},r.configure=function(e){this.j=e},r.Ub=function(e){var t=this;if(!this.o)return this.u.ya(e,"encrypted",(function(){t.l(new $(2,6,6010))})),Promise.resolve();this.m=e,this.u.ya(this.m,"play",(function(){for(var e=0;e<t.M.length;e++)jt(t,t.M[e]);t.va=!0,t.M=[]})),"webkitCurrentPlaybackTargetIsWireless"in this.m&&this.u.H(this.m,"webkitcurrentplaybacktargetiswirelesschanged",(function(){return Ot(t)})),e=(e=this.m.setMediaKeys(this.o)).catch((function(e){return Promise.reject(new $(2,6,6003,e.message))}));var n=xt(this);return Promise.all([e,n]).then((function(){if(t.i)return Promise.reject();kt(t),t.g.initData.length||t.F.length||t.u.H(t.m,"encrypted",(function(e){return At(t,e.initDataType,new Uint8Array(e.initData))}))})).catch((function(e){if(!t.i)return Promise.reject(e)}))},r.Xb=function(){for(var e=1/0,t=this.h.keys(),n=(t=f(t)).next();!n.done;n=t.next())n=n.value,isNaN(n.expiration)||(e=Math.min(e,n.expiration));return e},r.ye=function(e){this.m&&this.j.delayLicenseRequestUntilPlayed&&this.m.paused&&!this.va?this.M.push(e):jt(this,e)},r.we=function(e){e=e.target,Y.O("Key status changed for session",e.sessionId);var t=this.h.get(e),n=!1;e.keyStatuses.forEach(function(e,i){if("string"==typeof i){var r=i;i=e,e=r}if("com.microsoft.playready"==this.g.keySystem&&16==i.byteLength&&(vt("Trident/")||navigator.userAgent.match(/Edge?\//))){var o=(r=new DataView(i)).getUint32(0,!0),a=r.getUint16(4,!0),s=r.getUint16(6,!0);r.setUint32(0,o,!1),r.setUint16(4,a,!1),r.setUint16(6,s,!1)}"com.microsoft.playready"==this.g.keySystem&&"status-pending"==e&&(e="usable"),"status-pending"!=e&&(t.loaded=!0),"expired"==e&&(n=!0),r=Ee.Nc(new Uint8Array(i)),this.wa.set(r,e)}.bind(this));var i=e.expiration-Date.now();(0>i||n&&1e3>i)&&t&&!t.Ga&&(Y.debug("Session has expired",e.sessionId),this.h.delete(e),e.close().catch((function(){}))),Kt(this)&&(this.A.resolve(),this.X.V(Vt))};var Ft=1,Ht=5,Vt=.5;function Gt(){this.g=new muxjs.mp4.CaptionParser,this.l=[],this.j={}}function qt(){}function zt(e){return!e||1==e.length&&1e-6>e.end(0)-e.start(0)?null:e.length?e.end(e.length-1):null}function Wt(e,t,n){return n=void 0===n?0:n,!(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0)||t>e.end(e.length-1))&&t+n>=e.start(0)}function Xt(e,t){if(!e||!e.length||1==e.length&&1e-6>e.end(0)-e.start(0))return 0;for(var n=0,i=e.length-1;0<=i&&e.end(i)>t;--i)n+=e.end(i)-Math.max(e.start(i),t);return n}function Yt(e){if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function $t(e,t,n){this.startTime=e,this.direction=nn,this.endTime=t,this.payload=n,this.region=new dn,this.position=null,this.positionAlign=Jt,this.size=0,this.textAlign=Qt,this.writingMode=rn,this.lineInterpretation=on,this.line=null,this.lineHeight="",this.lineAlign=an,this.displayAlign=en,this.fontSize=this.backgroundImage=this.backgroundColor=this.color="",this.fontWeight=un,this.fontStyle=cn,this.fontFamily="",this.textDecoration=[],this.wrapLine=!0,this.id="",this.nestedCues=[],this.spacer=!1}Gt.prototype.init=function(e){var t=muxjs.mp4.probe;e=new Uint8Array(e),this.l=t.videoTrackIds(e),this.j=t.timescale(e),this.g.init()},Gt.prototype.h=function(e,t){var n=new Uint8Array(e);(n=this.g.parse(n,this.l,this.j))&&n.captions&&t(n.captions),this.g.clearParsedCaptions()},Gt.prototype.i=function(){this.g.resetCaptionStream()},qt.prototype.init=function(){},qt.prototype.h=function(){},qt.prototype.i=function(){},V("shaka.text.Cue",$t),$t.prototype.clone=function(){var e,t=new $t(0,0,"");for(e in this)t[e]=this[e],t[e]&&t[e].constructor==Array&&(t[e]=t[e].slice());return t};var Jt="auto";$t.positionAlign={LEFT:"line-left",RIGHT:"line-right",CENTER:"center",AUTO:Jt};var Qt="center",Zt={LEFT:"left",RIGHT:"right",CENTER:Qt,START:"start",END:"end"};$t.textAlign=Zt;var en="after",tn={BEFORE:"before",CENTER:"center",AFTER:en};$t.displayAlign=tn;var nn="ltr";$t.direction={HORIZONTAL_LEFT_TO_RIGHT:nn,HORIZONTAL_RIGHT_TO_LEFT:"rtl"};var rn="horizontal-tb";$t.writingMode={HORIZONTAL_TOP_TO_BOTTOM:rn,VERTICAL_LEFT_TO_RIGHT:"vertical-lr",VERTICAL_RIGHT_TO_LEFT:"vertical-rl"};var on=0;$t.lineInterpretation={LINE_NUMBER:on,PERCENTAGE:1};var an="start",sn={CENTER:"center",START:an,END:"end"};$t.lineAlign=sn;var un=400;$t.fontWeight={NORMAL:un,BOLD:700};var cn="normal",ln={NORMAL:cn,ITALIC:"italic",OBLIQUE:"oblique"};function dn(){this.id="",this.regionAnchorY=this.regionAnchorX=this.viewportAnchorY=this.viewportAnchorX=0,this.height=this.width=100,this.viewportAnchorUnits=this.widthUnits=this.heightUnits=hn,this.scroll=fn}$t.fontStyle=ln,$t.textDecoration={UNDERLINE:"underline",LINE_THROUGH:"lineThrough",OVERLINE:"overline"},V("shaka.text.CueRegion",dn);var hn=1;dn.units={PX:0,PERCENTAGE:hn,LINES:2};var fn="";function pn(e){this.l=null,this.i=e,this.j=this.A=0,this.m=1/0,this.h=this.g=null,this.u="",this.o=new Map}dn.scrollMode={NONE:fn,UP:"up"};var gn={};function mn(t){return!!(gn[t]||e.muxjs&&"application/cea-608"==t)}function vn(e,t){"application/cea-608"!=t&&(e.l=new gn[t])}function yn(e,t,n,i,r){for(var o=n+" "+i,a=new Map,s=(t=f(t)).next();!s.done;s=t.next()){var u=s.value;s=u.stream,a.has(s)||a.set(s,new Map),a.get(s).has(o)||a.get(s).set(o,[]),u.startTime+=r,u.endTime+=r,u.startTime>=e.j&&u.startTime<e.m&&(u=new $t(u.startTime,u.endTime,u.text),a.get(s).get(o).push(u),s==e.u&&e.i.append([u]))}for(o=(r=f(a.keys())).next();!o.done;o=r.next())for(o=o.value,e.o.has(o)||e.o.set(o,new Map),s=(t=f(a.get(o).keys())).next();!s.done;s=t.next())s=s.value,u=a.get(o).get(s),e.o.get(o).set(s,u);e.g=null==e.g?Math.max(n,e.j):Math.min(e.g,Math.max(n,e.j)),e.h=Math.max(e.h,Math.min(i,e.m))}function bn(e,t,n){this.j=e,this.l=n,this.h={},this.g=null,this.i={},this.o=new Ze,this.F=!1,this.u={},this.A=t,this.C=new ge,this.m=function(e,t){var n=new MediaSource;return e.o.ya(n,"sourceopen",(function(){URL.revokeObjectURL(e.J),t.resolve()})),e.J=wn(n),e.j.src=e.J,n}(this,this.C),this.J=""}V("shaka.text.TextEngine.registerParser",(function(e,t){gn[e]=t})),V("shaka.text.TextEngine.unregisterParser",(function(e){delete gn[e]})),pn.prototype.destroy=function(){return this.i=this.l=null,this.o.clear(),Promise.resolve()},pn.prototype.xc=function(e){try{return this.l.parseMedia(new Uint8Array(e),{periodStart:0,segmentStart:null,segmentEnd:0})[0].startTime}catch(e){throw new $(2,2,2009,e)}},pn.prototype.remove=function(e,t){return Promise.resolve().then(function(){!this.i||!this.i.remove(e,t)||null==this.g||t<=this.g||e>=this.h||(e<=this.g&&t>=this.h?this.g=this.h=null:e<=this.g&&t<this.h?this.g=t:e>this.g&&t>=this.h&&(this.h=e))}.bind(this))};var wn=e.URL.createObjectURL;function Tn(e){var t=ut(e.mimeType,e.codecs),n=function(e){var t=[e.mimeType];return dt.forEach((function(n,i){var r=e[i];r&&t.push(n+'="'+r+'"')})),t.join(";")}(e);return mn(t)||MediaSource.isTypeSupported(n)||ke(t,e.type)}function Sn(e,t){e.g||(e.g=new pn(e.l)),vn(e.g,t)}function En(e){return!e.m||"ended"==e.m.readyState}function xn(e,t){if("text"==t)var n=e.g.g;else n=!(n=An(e,t))||1==n.length&&1e-6>n.end(0)-n.start(0)?null:1==n.length&&0>n.start(0)?0:n.length?n.start(0):null;return n}function kn(e,t){return"text"==t?e.g.h:zt(An(e,t))}function An(e,t){try{return e.h[t].buffered}catch(n){return t in e.h&&Y.error("failed to get buffered range for "+t,n),null}}function Mn(t,n,i,r,o,a){return"text"==n?function(e,t,n,i){return Promise.resolve().then(function(){if(this.l&&this.i)if(null==n||null==i)this.l.parseInit(new Uint8Array(t));else{var e={periodStart:this.A,segmentStart:n,segmentEnd:i};e=this.l.parseMedia(new Uint8Array(t),e).filter(function(e){return e.startTime>=this.j&&e.startTime<this.m}.bind(this)),this.i.append(e),null==this.g&&(this.g=Math.max(n,this.j)),this.h=Math.min(i,this.m)}}.bind(e))}(t.g,i,r,o):t.u[n]?function(e,t){e.j=!0,e.h=new ge,e.l=[],e.i=[];var n=new Uint8Array(t);return e.g.push(n),e.g.flush(),e.j&&e.h.reject(new $(2,3,3018)),e.h}(t.u[n],i).then(function(e){return this.g||Sn(this,"text/vtt"),e.captions&&e.captions.length&&yn(this.g,e.captions,r,o,this.h.video.timestampOffset),Cn(this,n,this.Me.bind(this,n,e.data.buffer))}.bind(t)):(a&&e.muxjs&&(t.g||Sn(t,"text/vtt"),null==r&&null==o?t.A.init(i):t.A.h(i,(function(e){e.length&&yn(t.g,e,r,o,t.h.video.timestampOffset)}))),Cn(t,n,t.Me.bind(t,n,i)))}function In(e,t){var n=kn(e,"video")||0;!function(e,t,n){if(e.u=t,t=e.o.get(t))for(var i=f(t.keys()),r=i.next();!r.done;r=i.next())(r=t.get(r.value).filter((function(e){return e.endTime<=n})))&&e.i.append(r)}(e.g,t,n)}function Pn(e,t){return"text"==t?e.g?(e.A.i(),e.g.remove(0,1/0)):Promise.resolve():Cn(e,t,e.Ne.bind(e,t,0,e.m.duration))}function Cn(e,t,n){if(e.F)return Promise.reject();if(n={start:n,p:new ge},e.i[t].push(n),1==e.i[t].length)try{n.start()}catch(i){"QuotaExceededError"==i.name?n.p.reject(new $(2,3,3017,t)):n.p.reject(new $(2,3,3015,i)),Nn(e,t)}return n.p}function Rn(e,t){if(e.F)return Promise.reject();var n,i=[];for(n in e.h){var r=new ge,o={start:function(e){e.resolve()}.bind(null,r),p:r};e.i[n].push(o),i.push(r),1==e.i[n].length&&o.start()}return Promise.all(i).then(function(){try{t()}catch(t){var e=Promise.reject(new $(2,3,3015,t))}for(var n in this.h)Nn(this,n);return e}.bind(e),function(e){throw e}.bind(e))}function Nn(e,t){e.i[t].shift();var n=e.i[t][0];if(n)try{n.start()}catch(i){n.p.reject(new $(2,3,3015,i)),Nn(e,t)}}function Dn(e,t){return e=_n(e),t=_n(t),e.split("-")[0]==t.split("-")[0]}function jn(e,t){e=_n(e),t=_n(t);var n=e.split("-"),i=t.split("-");return n[0]==i[0]&&1==n.length&&2==i.length}function _n(e){var t=e.split("-");return e=t[0]||"",t=t[1]||"",e=e.toLowerCase(),e=On.get(e)||e,(t=t.toUpperCase())?e+"-"+t:e}function Ln(e){return e.language?_n(e.language):e.audio&&e.audio.language?_n(e.audio.language):e.video&&e.video.language?_n(e.video.language):"und"}function Un(e,t){for(var n=_n(e),i=new Set,r=f(t),o=r.next();!o.done;o=r.next())i.add(_n(o.value));for(o=(r=f(i)).next();!o.done;o=r.next())if((o=o.value)==n)return o;for(o=(r=f(i)).next();!o.done;o=r.next())if(jn(o=o.value,n))return o;for(o=(r=f(i)).next();!o.done;o=r.next()){var a=o=o.value,s=n;if(a=_n(a),s=_n(s),a=a.split("-"),s=s.split("-"),2==a.length&&2==s.length&&a[0]==s[0])return o}for(o=(i=f(i)).next();!o.done;o=i.next())if(jn(n,r=o.value))return r;return null}(r=bn.prototype).destroy=function(){var e=this;this.F=!0;var t,n=[];for(t in this.i){var i=this.i[t],r=i[0];for(this.i[t]=i.slice(0,1),r&&n.push(r.p.catch(de.Bc)),r=1;r<i.length;++r)i[r].p.reject()}for(var o in this.g&&n.push(this.g.destroy()),this.l&&n.push(this.l.destroy()),this.u)n.push(this.u[o].destroy());return Promise.all(n).then((function(){e.o&&(e.o.release(),e.o=null),e.j&&(e.j.removeAttribute("src"),e.j.load(),e.j=null),e.m=null,e.g=null,e.l=null,e.h={},e.u={},e.A=null,e.i={}}))},r.init=function(e,t){var n=this;return g((function i(){var r;return U(i,(function(i){switch(i.s){case 1:return r=pe,k(i,n.C,2);case 2:e.forEach((function(e,i){var o=ut(e.mimeType,e.codecs);i==r.za?Sn(n,o):(!t&&MediaSource.isTypeSupported(o)||!ke(o,i)||(n.u[i]=new xe,o=Ae(i,o)),o=n.m.addSourceBuffer(o),n.o.H(o,"error",n.Dg.bind(n,i)),n.o.H(o,"updateend",n.Lb.bind(n,i)),n.h[i]=o,n.i[i]=[])})),A(i)}}))}))},r.bd=function(e){if(e.total=Yt(this.j.buffered),e.audio=Yt(An(this,"audio")),e.video=Yt(An(this,"video")),e.text=[],this.g){var t=this.g.g,n=this.g.h;null!=t&&null!=n&&e.text.push({start:t,end:n})}},r.remove=function(e,t,n){return"text"==e?this.g.remove(t,n):Cn(this,e,this.Ne.bind(this,e,t,n))},r.flush=function(e){return"text"==e?Promise.resolve():Cn(this,e,this.lf.bind(this,e))},r.endOfStream=function(e){return Rn(this,function(){En(this)||(e?this.m.endOfStream(e):this.m.endOfStream())}.bind(this))},r.Fa=function(e){return Rn(this,function(){this.m.duration=e}.bind(this))},r.ha=function(){return this.m.duration},r.Me=function(e,t){this.h[e].appendBuffer(t)},r.Ne=function(e,t,n){n<=t?this.Lb(e):this.h[e].remove(t,n)},r.Ve=function(e){var t=this.h[e].appendWindowStart,n=this.h[e].appendWindowEnd;this.h[e].abort(),this.h[e].appendWindowStart=t,this.h[e].appendWindowEnd=n,this.Lb(e)},r.lf=function(e){this.j.currentTime-=.001,this.Lb(e)},r.Cg=function(e,t){0>t&&(t+=.001),this.h[e].timestampOffset=t,this.Lb(e)},r.zg=function(e,t,n){this.h[e].appendWindowStart=0,this.h[e].appendWindowEnd=n,this.h[e].appendWindowStart=t,this.Lb(e)},r.Dg=function(e){this.i[e][0].p.reject(new $(2,3,3014,this.j.error?this.j.error.code:0))},r.Lb=function(e){var t=this.i[e][0];t&&(t.p.resolve(),Nn(this,e))};var On=new Map([["aar","aa"],["abk","ab"],["afr","af"],["aka","ak"],["alb","sq"],["amh","am"],["ara","ar"],["arg","an"],["arm","hy"],["asm","as"],["ava","av"],["ave","ae"],["aym","ay"],["aze","az"],["bak","ba"],["bam","bm"],["baq","eu"],["bel","be"],["ben","bn"],["bih","bh"],["bis","bi"],["bod","bo"],["bos","bs"],["bre","br"],["bul","bg"],["bur","my"],["cat","ca"],["ces","cs"],["cha","ch"],["che","ce"],["chi","zh"],["chu","cu"],["chv","cv"],["cor","kw"],["cos","co"],["cre","cr"],["cym","cy"],["cze","cs"],["dan","da"],["deu","de"],["div","dv"],["dut","nl"],["dzo","dz"],["ell","el"],["eng","en"],["epo","eo"],["est","et"],["eus","eu"],["ewe","ee"],["fao","fo"],["fas","fa"],["fij","fj"],["fin","fi"],["fra","fr"],["fre","fr"],["fry","fy"],["ful","ff"],["geo","ka"],["ger","de"],["gla","gd"],["gle","ga"],["glg","gl"],["glv","gv"],["gre","el"],["grn","gn"],["guj","gu"],["hat","ht"],["hau","ha"],["heb","he"],["her","hz"],["hin","hi"],["hmo","ho"],["hrv","hr"],["hun","hu"],["hye","hy"],["ibo","ig"],["ice","is"],["ido","io"],["iii","ii"],["iku","iu"],["ile","ie"],["ina","ia"],["ind","id"],["ipk","ik"],["isl","is"],["ita","it"],["jav","jv"],["jpn","ja"],["kal","kl"],["kan","kn"],["kas","ks"],["kat","ka"],["kau","kr"],["kaz","kk"],["khm","km"],["kik","ki"],["kin","rw"],["kir","ky"],["kom","kv"],["kon","kg"],["kor","ko"],["kua","kj"],["kur","ku"],["lao","lo"],["lat","la"],["lav","lv"],["lim","li"],["lin","ln"],["lit","lt"],["ltz","lb"],["lub","lu"],["lug","lg"],["mac","mk"],["mah","mh"],["mal","ml"],["mao","mi"],["mar","mr"],["may","ms"],["mkd","mk"],["mlg","mg"],["mlt","mt"],["mon","mn"],["mri","mi"],["msa","ms"],["mya","my"],["nau","na"],["nav","nv"],["nbl","nr"],["nde","nd"],["ndo","ng"],["nep","ne"],["nld","nl"],["nno","nn"],["nob","nb"],["nor","no"],["nya","ny"],["oci","oc"],["oji","oj"],["ori","or"],["orm","om"],["oss","os"],["pan","pa"],["per","fa"],["pli","pi"],["pol","pl"],["por","pt"],["pus","ps"],["que","qu"],["roh","rm"],["ron","ro"],["rum","ro"],["run","rn"],["rus","ru"],["sag","sg"],["san","sa"],["sin","si"],["slk","sk"],["slo","sk"],["slv","sl"],["sme","se"],["smo","sm"],["sna","sn"],["snd","sd"],["som","so"],["sot","st"],["spa","es"],["sqi","sq"],["srd","sc"],["srp","sr"],["ssw","ss"],["sun","su"],["swa","sw"],["swe","sv"],["tah","ty"],["tam","ta"],["tat","tt"],["tel","te"],["tgk","tg"],["tgl","tl"],["tha","th"],["tib","bo"],["tir","ti"],["ton","to"],["tsn","tn"],["tso","ts"],["tuk","tk"],["tur","tr"],["twi","tw"],["uig","ug"],["ukr","uk"],["urd","ur"],["uzb","uz"],["ven","ve"],["vie","vi"],["vol","vo"],["wel","cy"],["wln","wa"],["wol","wo"],["xho","xh"],["yid","yi"],["yor","yo"],["zha","za"],["zho","zh"],["zul","zu"]]),Kn={$d:function(e,t){var n=e.periods.reduce((function(e,t){return e.concat(t.variants)}),[]);n=Kn.ee(n,t),n=Kn.Lf(n),n=Kn.jf(n);for(var i=Kn.kf(n),r=(n=f(e.periods)).next();!r.done;r=n.next())(r=r.value).variants=r.variants.filter((function(e){return Kn.he(e)==i||(Y.debug("Dropping Variant (better codec available)",e),!1)}))},Lf:function(e){for(var t=new Oe,n=(e=f(e)).next();!n.done;n=e.next()){n=n.value;var i=Kn.he(n);t.push(i,n)}return t},jf:function(e){var t=0,n=new Map,i=e.size();return e.forEach((function(e,r){for(var o=f(r),a=o.next();!a.done;a=o.next()){var s=(a=a.value).video;if(s&&s.width&&s.height){s=s.width*s.height*(s.frameRate||1),n.has(s)||n.set(s,new Oe);var u=n.get(s);u.push(e,a),u.size()===i&&(t=Math.max(t,s))}}})),t?n.get(t):e},kf:function(e){var t="",n=1/0;return e.forEach((function(e,i){for(var r=0,o=0,a=f(i),s=a.next();!s.done;s=a.next())r+=s.value.bandwidth||0,++o;r/=o,Y.debug("codecs",e,"avg bandwidth",r),r<n&&(t=e,n=r)})),t},he:function(e){var t="";e.video&&(t=lt(e.video.codecs)[0]);var n="";return e.audio&&(n=lt(e.audio.codecs)[0]),t+"-"+n},rd:function(e,t,n){function i(e,t,n){return e>=t&&e<=n}var r=e.video;return!(r&&r.width&&r.height&&(!i(r.width,t.minWidth,Math.min(t.maxWidth,n.width))||!i(r.height,t.minHeight,Math.min(t.maxHeight,n.height))||!i(r.width*r.height,t.minPixels,t.maxPixels))||e&&e.video&&e.video.frameRate&&!i(e.video.frameRate,t.minFrameRate,t.maxFrameRate)||!i(e.bandwidth,t.minBandwidth,t.maxBandwidth))},Xd:function(e,t,n){var i=!1;return e.forEach((function(e){var r=e.allowedByApplication;e.allowedByApplication=Kn.rd(e,t,n),r!=e.allowedByApplication&&(i=!0)})),i},filterNewPeriod:function(e,t,n,i){i.variants=i.variants.filter((function(i){if(e&&e.Z&&!Lt(e,i))return Y.debug("Dropping variant - not compatible with key system",i),!1;var r=i.audio;return i=i.video,r&&!Tn(r)?(Y.debug("Dropping variant - audio not compatible with platform",Kn.fb(r)),!1):i&&!Tn(i)||vt("Xbox One")&&i&&(i.width&&1920<i.width||i.height&&1080<i.height)&&i.codecs.includes("avc1.")?(Y.debug("Dropping variant - video not compatible with platform",Kn.fb(i)),!1):r&&t&&!Kn.Yd(r,t)?(Y.debug("Droping variant - not compatible with active audio","active audio",Kn.fb(t),"variant.audio",Kn.fb(r)),!1):!(i&&n&&!Kn.Yd(i,n))||(Y.debug("Droping variant - not compatible with active video","active video",Kn.fb(n),"variant.video",Kn.fb(i)),!1)})),i.textStreams=i.textStreams.filter((function(e){var t=mn(ut(e.mimeType,e.codecs));return t||Y.debug("Dropping text stream. Is not supported by the platform.",e),t}))},Yd:function(e,t){return e.mimeType==t.mimeType&&e.codecs.split(".")[0]==t.codecs.split(".")[0]},Oc:function(e){var t=e.audio,n=e.video,i=t?t.codecs:null,r=n?n.codecs:null,o=[];r&&o.push(r),i&&o.push(i);var a=[];n&&a.push(n.mimeType),t&&a.push(t.mimeType),a=a[0]||null;var s=[];t&&s.push(t.kind),n&&s.push(n.kind),s=s[0]||null;var u=new Set;return t&&t.roles.forEach((function(e){return u.add(e)})),n&&n.roles.forEach((function(e){return u.add(e)})),e={id:e.id,active:!1,type:"variant",bandwidth:e.bandwidth,language:e.language,label:null,kind:s,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:a,codecs:o.join(", "),audioCodec:i,videoCodec:r,primary:e.primary,roles:Array.from(u),audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null},n&&(e.videoId=n.id,e.originalVideoId=n.originalId,e.width=n.width||null,e.height=n.height||null,e.frameRate=n.frameRate||null,e.pixelAspectRatio=n.pixelAspectRatio||null,e.videoBandwidth=n.bandwidth||null),t&&(e.audioId=t.id,e.originalAudioId=t.originalId,e.channelsCount=t.channelsCount,e.audioSamplingRate=t.audioSamplingRate,e.audioBandwidth=t.bandwidth||null,e.label=t.label,e.audioRoles=t.roles),e},Kc:function(e){return{id:e.id,active:!1,type:"text",bandwidth:0,language:e.language,label:e.label,kind:e.kind||null,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:e.mimeType,codecs:e.codecs||null,audioCodec:null,videoCodec:null,primary:e.primary,roles:e.roles,audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:e.originalId}},gd:function(e){return e.__shaka_id||(e.__shaka_id=Kn.Uf++),e.__shaka_id},Uf:0,Of:function(e){var t=Kn.ke(e);return t.active="disabled"!=e.mode,t.type="text",t.originalTextId=e.id,"captions"==e.kind&&(t.mimeType="application/cea-608"),e.kind&&(t.roles=[e.kind]),t},je:function(e){var t=Kn.ke(e);return t.active=e.enabled,t.type="variant",t.originalAudioId=e.id,"main"==e.kind&&(t.primary=!0),e.kind&&(t.roles=[e.kind],t.audioRoles=[e.kind]),t},ke:function(e){return{id:Kn.gd(e),active:!1,type:"",bandwidth:0,language:_n(e.language),label:e.label,kind:e.kind,width:null,height:null,frameRate:null,pixelAspectRatio:null,mimeType:null,codecs:null,audioCodec:null,videoCodec:null,primary:!1,roles:[],audioRoles:null,videoId:null,audioId:null,channelsCount:null,audioSamplingRate:null,audioBandwidth:null,videoBandwidth:null,originalVideoId:null,originalAudioId:null,originalTextId:null}},Gb:function(e){return e.allowedByApplication&&e.allowedByKeySystem},Bf:function(e){return e.filter((function(e){return Kn.Gb(e)}))},ee:function(e,t){for(var n=e.filter((function(e){return e.audio&&e.audio.channelsCount})),i=new Map,r=(n=f(n)).next();!r.done;r=n.next()){var o=(r=r.value).audio.channelsCount;i.has(o)||i.set(o,[]),i.get(o).push(r)}return 0==(n=Array.from(i.keys())).length?e:(r=n.filter((function(e){return e<=t}))).length?i.get(Math.max.apply(null,r)):i.get(Math.min.apply(null,n))},Wb:function(e,t,n){var i=e,r=e.filter((function(e){return e.primary}));r.length&&(i=r);var o=i.length?i[0].language:"";if(i=i.filter((function(e){return e.language==o})),t){var a=Un(_n(t),e.map((function(e){return e.language})));a&&(i=e.filter((function(e){return _n(e.language)==a})))}if(n){if((e=Kn.de(i,n)).length)return e;Y.v("No exact match for the text role could be found.")}else if((e=i.filter((function(e){return 0==e.roles.length}))).length)return e;return(e=i.map((function(e){return e.roles})).reduce(de.Rc,[])).length?Kn.de(i,e[0]):i},de:function(e,t){return e.filter((function(e){return e.roles.includes(t)}))},ie:function(e,t,n){for(var i=0;i<n.length;i++)if(n[i].audio==e&&n[i].video==t)return n[i];return null},Pf:function(e){return"audio"==e.type},Sf:function(e){return"video"==e.type},Kf:function(e){var t=[];return e.audio&&t.push(e.audio),e.video&&t.push(e.video),t},fb:function(e){return Kn.Pf(e)?"type=audio codecs="+e.codecs+" bandwidth="+e.bandwidth+" channelsCount="+e.channelsCount+" audioSamplingRate="+e.audioSamplingRate:Kn.Sf(e)?"type=video codecs="+e.codecs+" bandwidth="+e.bandwidth+" frameRate="+e.frameRate+" width="+e.width+" height="+e.height:"unexpected stream type"}};function Bn(){this.m=null,this.i=!1,this.h=new X,this.l=[],this.o=!1,this.g=this.j=null}function Fn(e,t){return e&&(t=t.filter((function(t){return Kn.rd(t,e,{width:1/0,height:1/0})}))),t.sort((function(e,t){return e.bandwidth-t.bandwidth}))}function Hn(e,t){this.g=e,this.h=t}function Vn(e,t){var n=new Hn(2,6),i=zn,r=i.g,o=n.h-r.h;(0<(n.g-r.g||o)?i.i:i.h)(i.g,n,e,t)}function Gn(e,t,n,i){Y.ba([n,"has been deprecated and will be removed in",t,". We are currently at version",e,". Additional information:",i].join(" "))}function qn(e,t,n,i){Y.kc([n,"has been deprecated and has been removed in",t,". We are now at version",e,". Additional information:",i].join(""))}V("shaka.abr.SimpleAbrManager",Bn),Bn.prototype.stop=function(){this.m=null,this.i=!1,this.l=[],this.j=null},Bn.prototype.stop=Bn.prototype.stop,Bn.prototype.init=function(e){this.m=e},Bn.prototype.init=Bn.prototype.init,Bn.prototype.chooseVariant=function(){var e=Fn(this.g.restrictions,this.l),t=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate);this.l.length&&!e.length&&(Y.v("No variants met the ABR restrictions. Choosing a variant by lowest bandwidth."),e=[(e=Fn(null,this.l))[0]]);for(var n=e[0]||null,i=0;i<e.length;++i){var r=e[i],o=r.bandwidth/this.g.bandwidthDowngradeTarget,a=(e[i+1]||{bandwidth:1/0}).bandwidth/this.g.bandwidthUpgradeTarget;Y.O("Bandwidth ranges:",(r.bandwidth/1e6).toFixed(3),(o/1e6).toFixed(3),(a/1e6).toFixed(3)),t>=o&&t<=a&&(n=r)}return this.j=Date.now(),n},Bn.prototype.chooseVariant=Bn.prototype.chooseVariant,Bn.prototype.enable=function(){this.i=!0},Bn.prototype.enable=Bn.prototype.enable,Bn.prototype.disable=function(){this.i=!1},Bn.prototype.disable=Bn.prototype.disable,Bn.prototype.segmentDownloaded=function(e,t){Y.O("Segment downloaded:","deltaTimeMs="+e,"numBytes="+t,"lastTimeChosenMs="+this.j,"enabled="+this.i);var n=this.h;if(!(16e3>t)){var i=8e3*t/e,r=e/1e3;n.g+=t,z(n.h,r,i),z(n.i,r,i)}if(null!=this.j&&this.i)e:{if(Y.O("Suggesting Streams..."),this.o){if(Date.now()-this.j<1e3*this.g.switchInterval){Y.O("Still within switch interval...");break e}}else{if(!(128e3<=this.h.g)){Y.O("Still waiting for a good estimate...");break e}this.o=!0}n=this.chooseVariant(),i=this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate),Y.debug("Calling switch_(), bandwidth="+Math.round(i/1e3)+" kbps"),this.m(n)}},Bn.prototype.segmentDownloaded=Bn.prototype.segmentDownloaded,Bn.prototype.getBandwidthEstimate=function(){return this.h.getBandwidthEstimate(this.g.defaultBandwidthEstimate)},Bn.prototype.getBandwidthEstimate=Bn.prototype.getBandwidthEstimate,Bn.prototype.setVariants=function(e){this.l=e},Bn.prototype.setVariants=Bn.prototype.setVariants,Bn.prototype.configure=function(e){this.g=e},Bn.prototype.configure=Bn.prototype.configure,Hn.prototype.toString=function(){return"v"+this.g+"."+this.h};var zn=null,Wn="ended play playing pause pausing ratechange seeked seeking timeupdate volumechange".split(" "),Xn="buffered currentTime duration ended loop muted paused playbackRate seeking videoHeight videoWidth volume".split(" "),Yn=["loop","playbackRate"],$n=["pause","play"],Jn="abrstatuschanged adaptation buffering drmsessionupdate emsg error expirationupdated largegap loading manifestparsed onstatechange onstateidle streaming textchanged texttrackvisibility timelineregionadded timelineregionenter timelineregionexit trackschanged unloading variantchanged".split(" "),Qn={getAssetUri:2,getAudioLanguages:4,getAudioLanguagesAndRoles:4,getBufferedInfo:2,getConfiguration:2,getExpiration:2,getPlaybackRate:2,getTextLanguages:4,getTextLanguagesAndRoles:4,getTextTracks:2,getStats:5,getVariantTracks:2,isAudioOnly:10,isBuffering:1,isInProgress:1,isLive:10,isTextTrackVisible:1,keySystem:10,seekRange:1,usingEmbeddedTextTrack:2,getLoadMode:10},Zn={getPlayheadTimeAsDate:1,getPresentationStartTimeAsDate:20},ei=[["getConfiguration","configure"]],ti=[["isTextTrackVisible","setTextTrackVisibility"]],ni="addTextTrack cancelTrickPlay configure resetConfiguration retryStreaming selectAudioLanguage selectEmbeddedTextTrack selectTextLanguage selectTextTrack selectVariantTrack selectVariantsByLabel setTextTrackVisibility trickPlay".split(" "),ii=["attach","detach","load","unload"];function ri(e){return JSON.stringify(e,(function(e,t){if("function"!=typeof t){if(t instanceof Event||t instanceof Ue){var i={};for(o in t){var r=t[o];r&&"object"==(void 0===r?"undefined":n(r))?"detail"==o&&(i[o]=r):o in Event||(i[o]=r)}return i}if(t instanceof Error){var o=new Set(["name","message","stack"]);for(i in t)o.add(i);for(i=(r=f(Object.getOwnPropertyNames(t))).next();!i.done;i=r.next())o.add(i.value);for(r={},i=(o=f(o)).next();!i.done;i=o.next())r[i=i.value]=t[i];o={__type__:"Error",contents:r}}else if(t instanceof TimeRanges)for(o={__type__:"TimeRanges",length:t.length,start:[],end:[]},i=0;i<t.length;++i)o.start.push(t.start(i)),o.end.push(t.end(i));else o=t instanceof Uint8Array?{__type__:"Uint8Array",entries:Array.from(t)}:"number"==typeof t?isNaN(t)?"NaN":isFinite(t)?t:0>t?"-Infinity":"Infinity":t;return o}}))}function oi(e){return JSON.parse(e,(function(e,t){if("NaN"==t)var i=NaN;else if("-Infinity"==t)i=-1/0;else if("Infinity"==t)i=1/0;else if(t&&"object"==(void 0===t?"undefined":n(t))&&"TimeRanges"==t.__type__)i=function(e){return{length:e.length,start:function(t){return e.start[t]},end:function(t){return e.end[t]}}}(t);else if(t&&"object"==(void 0===t?"undefined":n(t))&&"Uint8Array"==t.__type__)i=new Uint8Array(t.entries);else if(t&&"object"==(void 0===t?"undefined":n(t))&&"Error"==t.__type__){i=t.contents;var r,o=Error(i.message);for(r in i)o[r]=i[r];i=o}else i=t;return i}))}function ai(e,t,n,i,r,o){this.X=e,this.j=new Ie(t),this.Z=n,this.u=!1,this.F=i,this.P=r,this.L=o,this.h=this.m=!1,this.M="",this.o=null,this.A=this.yd.bind(this),this.C=this.ag.bind(this),this.g={video:{},player:{}},this.J=0,this.i={},this.l=null,gi.add(this)}var si=!1,ui=null;function ci(e){for(var t=f(gi),n=t.next();!n.done;n=t.next())li(n.value,e)}function li(e,t){Y.debug("CastSender: onExistingSessionJoined");var n=e.L();e.l=new ge,e.u=!0,e.Ad(n,t)}function di(e){for(var t=f(gi),n=t.next();!n.done;n=t.next()){n=n.value;var i=e;Y.debug("CastSender: receiver status",i),si="available"==i,n.j.Lc()}}function hi(e){var t=ui;t.removeUpdateListener(e.A),t.removeMessageListener("urn:x-cast:com.google.shaka.v2",e.C)}function fi(e){for(var t in e.i){var n=e.i[t];delete e.i[t],n.reject(new $(1,7,7e3))}}function pi(e,t){var n=ri(t),i=ui;try{i.sendMessage("urn:x-cast:com.google.shaka.v2",n,(function(){}),Y.error)}catch(t){throw Y.error("Cast session sendMessage threw",t),n=new $(2,8,8005,t),e.F("player",new Ue("error",{detail:n})),e.Bb(),n}}(r=ai.prototype).destroy=function(){return gi.delete(this),fi(this),ui&&hi(this),this.j&&(this.j.stop(),this.j=null),this.P=this.F=null,this.h=this.m=!1,this.C=this.A=this.l=this.i=this.g=this.o=null,Promise.resolve()},r.la=function(){return this.h},r.Dd=function(){return this.M},r.init=function(){if(this.X.length)if(e.chrome&&chrome.cast&&chrome.cast.isAvailable){this.m=!0,this.j.Lc();var t=new chrome.cast.SessionRequest(this.X);t=new chrome.cast.ApiConfig(t,ci.bind(this),di.bind(this),"origin_scoped"),chrome.cast.initialize(t,(function(){Y.debug("CastSender: init")}),(function(e){Y.error("CastSender: init error",e)})),si&&this.j.V(.02),(t=ui)&&t.status!=chrome.cast.SessionStatus.STOPPED?(Y.debug("CastSender: re-using existing connection"),li(this,t)):ui=null}else e.__onGCastApiAvailable||(e.__onGCastApiAvailable=mi),e.__onGCastApiAvailable!=mi&&Y.ba("A global Cast SDK hook is already installed! Shaka Player will be unable to receive a notification when the Cast SDK is ready.")},r.Md=function(e){this.o=e,this.h&&pi(this,{type:"appData",appData:this.o})},r.cast=function(e){return this.m?si?this.h?Promise.reject(new $(1,8,8002)):(this.l=new ge,chrome.cast.requestSession(this.Ad.bind(this,e),this.ve.bind(this)),this.l):Promise.reject(new $(1,8,8001)):Promise.reject(new $(1,8,8e3))},r.Bb=function(){if(this.h){if(fi(this),ui){hi(this);try{ui.stop((function(){}),(function(){}))}catch(e){}ui=null}this.yd()}},r.get=function(e,t){if("video"==e){if($n.includes(t))return this.Ee.bind(this,e,t)}else if("player"==e){if(Zn[t]&&!this.get("player","isLive")())return function(){};if(ni.includes(t))return this.Ee.bind(this,e,t);if(ii.includes(t))return this.rg.bind(this,e,t);if(Qn[t])return this.Be.bind(this,e,t)}return this.Be(e,t)},r.set=function(e,t,n){this.g[e][t]=n,pi(this,{type:"set",targetName:e,property:t,value:n})},r.Ad=function(e,t){Y.debug("CastSender: onSessionInitiated"),ui=t,t.addUpdateListener(this.A),t.addMessageListener("urn:x-cast:com.google.shaka.v2",this.C),this.yd(),pi(this,{type:"init",initState:e,appData:this.o}),this.l.resolve()},r.ve=function(e){var t=8003;switch(e.code){case"cancel":t=8004;break;case"timeout":t=8005;break;case"receiver_unavailable":t=8006}this.l.reject(new $(2,8,t,e))},r.Be=function(e,t){return this.g[e][t]},r.Ee=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];pi(this,{type:"call",targetName:e,methodName:t,args:i})},r.rg=function(e,t,n){for(var i=[],r=2;r<arguments.length;++r)i[r-2]=arguments[r];r=new ge;var o=this.J.toString();this.J++,this.i[o]=r;try{pi(this,{type:"asyncCall",targetName:e,methodName:t,args:i,id:o})}catch(e){r.reject(e)}return r},r.yd=function(){var e=!!ui&&"connected"==ui.status;if(Y.debug("CastSender: connection status",e),this.h&&!e){for(var t in this.P(),this.g)this.g[t]={};fi(this)}this.M=(this.h=e)?ui.receiver.friendlyName:"",this.j.Lc()},r.ag=function(e,t){var n=oi(t);switch(Y.O("CastSender: message",n),n.type){case"event":var i=n.event;this.F(n.targetName,new Ue(i.type,i));break;case"update":for(var r in i=n.update)for(var o in n=this.g[r]||{},i[r])n[o]=i[r][o];this.u&&(this.Z(),this.u=!1);break;case"asyncComplete":if(r=n.id,n=n.error,o=this.i[r],delete this.i[r],o)if(n){for(i in r=new $(n.severity,n.category,n.code),n)r[i]=n[i];o.reject(r)}else o.resolve()}};var gi=new Set;function mi(e){if(e)for(var t=(e=f(gi)).next();!t.done;t=e.next())t.value.init()}function vi(e,t,n){var i=this;Ke.call(this),this.i=e,this.h=t,this.o=this.l=this.j=this.u=this.m=null,this.C=n,this.A=new Map,this.g=new ai(n,(function(){return wi(i)}),(function(){return Ti(i)}),(function(e,t){return Ei(i,e,t)}),(function(){return Si(i)}),(function(){return bi(i)})),function(e){for(var t in e.g.init(),e.o=new Ze,Wn.forEach(function(e){this.o.H(this.i,e,this.L.bind(this))}.bind(e)),Jn.forEach(function(e){this.o.H(this.h,e,this.F.bind(this))}.bind(e)),e.m={},e.i)Object.defineProperty(e.m,t,{configurable:!1,enumerable:!0,get:e.J.bind(e,t),set:e.M.bind(e,t)});e.u={},yi(e,(function(t){Object.defineProperty(e.u,t,{configurable:!1,enumerable:!0,get:function(){return function e(t,n){if(t.A.has(n)&&(n=t.A.get(n)),"addEventListener"==n)return t.l.addEventListener.bind(t.l);if("removeEventListener"==n)return t.l.removeEventListener.bind(t.l);if("getMediaElement"==n)return function(){return this.m}.bind(t);if("getSharedConfiguration"==n)return Y.v("Can't share configuration across a network. Returning copy."),t.g.get("player","getConfiguration");if("getNetworkingEngine"==n)return t.g.la()&&Y.v("NOTE: getNetworkingEngine() is always local!"),t.h.Yb.bind(t.h);if(t.g.la()){if("getManifest"==n||"drmInfo"==n)return function(){return Y.ba(n+"() does not work while casting!"),null};if("getManifestUri"==n)return Vn("getManifestUri",'Please use "getAssetUri" instead.'),e(t,"getAssetUri");if("attach"==n||"detach"==n)return function(){return Y.ba(n+"() does not work while casting!"),Promise.resolve()}}return t.g.la()&&0==Object.keys(t.g.g.video).length&&Qn[n]||!t.g.la()?t.h[n].bind(t.h):t.g.get("player",n)}(e,t)}})})),function(e){var t=new Map;yi(e,(function(n,i){if(t.has(i)){var r=t.get(i);n.length<r.length?e.A.set(n,r):e.A.set(r,n)}else t.set(i,n)}))}(e),e.j=new Ke,e.j.jc=e.m,e.l=new Ke,e.l.jc=e.u}(this)}function yi(e,t){function n(e){return"constructor"!=e&&"function"==typeof i[e]&&!r.has(e)}var i=e.h,r=new Set;for(o in i)n(o)&&(r.add(o),t(o,i[o]));for(var o=Object.getPrototypeOf(i),a=Object.getPrototypeOf({});o&&o!=a;){for(var s=f(Object.getOwnPropertyNames(o)),u=s.next();!u.done;u=s.next())n(u=u.value)&&(r.add(u),t(u,i[u]));o=Object.getPrototypeOf(o)}}function bi(e){var t={video:{},player:{},playerAfterLoad:{},manifest:e.h.tc(),startTime:null};return e.i.pause(),Yn.forEach(function(e){t.video[e]=this.i[e]}.bind(e)),e.i.ended||(t.startTime=e.i.currentTime),ei.forEach(function(e){var n=e[1];e=this.h[e[0]](),t.player[n]=e}.bind(e)),ti.forEach(function(e){var n=e[1];e=this.h[e[0]](),t.playerAfterLoad[n]=e}.bind(e)),t}function wi(e){e.dispatchEvent(new Ue("caststatuschanged"))}function Ti(e){e.j.dispatchEvent(new Ue(e.m.paused?"pause":"play"))}function Si(e){ei.forEach(function(e){var t=e[1];e=this.g.get("player",e[0])(),this.h[t](e)}.bind(e));var t=e.g.get("player","getAssetUri")(),n=e.g.get("video","ended"),i=Promise.resolve(),r=e.i.autoplay,o=null;n||(o=e.g.get("video","currentTime")),t&&(e.i.autoplay=!1,i=e.h.load(t,o));var a={};Yn.forEach(function(e){a[e]=this.g.get("video",e)}.bind(e)),i.then((function(){e.i&&(Yn.forEach(function(e){this.i[e]=a[e]}.bind(e)),ti.forEach(function(e){var t=e[1];e=this.g.get("player",e[0])(),this.h[t](e)}.bind(e)),e.i.autoplay=r,t&&e.i.play())}),(function(t){e.h.dispatchEvent(new Ue("error",{detail:t}))}))}function Ei(e,t,n){e.g.la()&&("video"==t?e.j.dispatchEvent(n):"player"==t&&e.l.dispatchEvent(n))}function xi(e,t,n,i){var r=this;Ke.call(this),this.g=e,this.h=t,this.i=new Ze,this.L={video:e,player:t},this.C=n||function(){},this.M=i||function(e){return e},this.F=!1,this.m=!0,this.l=0,this.A=!1,this.u=!0,this.o=this.j=null,this.J=new Ie((function(){Ai(r)})),function(e){var t=cast.receiver.CastReceiverManager.getInstance();t.onSenderConnected=e.xe.bind(e),t.onSenderDisconnected=e.xe.bind(e),t.onSystemVolumeChanged=e.hf.bind(e),e.o=t.getCastMessageBus("urn:x-cast:com.google.cast.media"),e.o.onMessage=e.Wf.bind(e),e.j=t.getCastMessageBus("urn:x-cast:com.google.shaka.v2"),e.j.onMessage=e.fg.bind(e),t.start(),Wn.forEach(function(e){this.i.H(this.g,e,this.Ce.bind(this,"video"))}.bind(e)),Jn.forEach(function(e){this.i.H(this.h,e,this.Ce.bind(this,"player"))}.bind(e)),cast.__platform__&&cast.__platform__.canDisplayType('video/mp4; codecs="avc1.640028"; width=3840; height=2160')?e.h.Nd(3840,2160):e.h.Nd(1920,1080),e.i.H(e.g,"loadeddata",function(){this.A=!0}.bind(e)),e.i.H(e.h,"loading",function(){this.m=!1,ki(this)}.bind(e)),e.i.H(e.g,"playing",function(){this.m=!1,ki(this)}.bind(e)),e.i.H(e.g,"pause",function(){ki(this)}.bind(e)),e.i.H(e.h,"unloading",function(){this.m=!0,ki(this)}.bind(e)),e.i.H(e.g,"ended",function(){var e=this;new Ie((function(){e.g&&e.g.ended&&(e.m=!0,ki(e))})).V(5)}.bind(e))}(this)}function ki(e){Promise.resolve().then(function(){this.h&&(this.dispatchEvent(new Ue("caststatuschanged")),Mi(this)||Ci(this))}.bind(e))}function Ai(e){e.J.V(.5);var t={video:{},player:{}};if(Xn.forEach(function(e){t.video[e]=this.g[e]}.bind(e)),e.h.aa())for(var n in Zn)0==e.l%Zn[n]&&(t.player[n]=e.h[n]());for(var i in Qn)0==e.l%Qn[i]&&(t.player[i]=e.h[i]());(n=cast.receiver.CastReceiverManager.getInstance().getSystemVolume())&&(t.video.volume=n.level,t.video.muted=n.muted),e.A&&(e.l+=1),Pi(e,{type:"update",update:t},e.j),Mi(e)}function Mi(e){return!(!e.u||!e.g.duration&&!e.h.aa())&&(Ii(e),e.u=!1,!0)}function Ii(e,t){t=void 0===t?0:t;var n={contentId:e.h.tc(),streamType:e.h.aa()?"LIVE":"BUFFERED",contentType:""};e.h.aa()||(n.duration=e.g.duration),Ci(e,t,n)}function Pi(e,t,n,i){e.F&&(e=ri(t),i?n.getCastChannel(i).send(e):n.broadcast(e))}function Ci(e,t,n){t=void 0===t?0:t,n=void 0===n?null:n;var i=e.g.playbackRate,r=Ri;i={mediaSessionId:0,playbackRate:i,playerState:r=e.m?r.IDLE:e.h.jd()?r.Re:e.g.paused?r.Te:r.Ue,currentTime:e.g.currentTime,supportedMediaCommands:63,volume:{level:e.g.volume,muted:e.g.muted}},n&&(i.media=n),Pi(e,{requestId:t,type:"MEDIA_STATUS",status:[i]},e.o)}G(vi,Ke),V("shaka.cast.CastProxy",vi),vi.prototype.destroy=function(e){return e&&this.g.Bb(),this.o&&(this.o.release(),this.o=null),e=[],this.h&&(e.push(this.h.destroy()),this.h=null),this.g&&(e.push(this.g.destroy()),this.g=null),this.u=this.m=this.i=null,Promise.all(e)},vi.prototype.destroy=vi.prototype.destroy,vi.prototype.Mf=function(){return this.m},vi.prototype.getVideo=vi.prototype.Mf,vi.prototype.Df=function(){return this.u},vi.prototype.getPlayer=vi.prototype.Df,vi.prototype.Ye=function(){return this.g.m&&si},vi.prototype.canCast=vi.prototype.Ye,vi.prototype.la=function(){return this.g.la()},vi.prototype.isCasting=vi.prototype.la,vi.prototype.Dd=function(){return this.g.Dd()},vi.prototype.receiverName=vi.prototype.Dd,vi.prototype.cast=function(){var e=bi(this);return this.g.cast(e).then(function(){if(this.h)return this.h.Ud()}.bind(this))},vi.prototype.cast=vi.prototype.cast,vi.prototype.Md=function(e){this.g.Md(e)},vi.prototype.setAppData=vi.prototype.Md,vi.prototype.Kg=function(){var e=this.g;if(e.h){var t=e.L();chrome.cast.requestSession(e.Ad.bind(e,t),e.ve.bind(e))}},vi.prototype.suggestDisconnect=vi.prototype.Kg,vi.prototype.af=function(e){var t=this;return g((function n(){return U(n,(function(n){switch(n.s){case 1:return e==t.C?n.return():(t.C=e,t.g.Bb(),k(n,t.g.destroy(),2));case 2:t.g=null,t.g=new ai(e,(function(){return wi(t)}),(function(){return Ti(t)}),(function(e,n){return Ei(t,e,n)}),(function(){return Si(t)}),(function(){return bi(t)})),t.g.init(),A(n)}}))}))},vi.prototype.changeReceiverId=vi.prototype.af,vi.prototype.Bb=function(){this.g.Bb()},vi.prototype.forceDisconnect=vi.prototype.Bb,vi.prototype.J=function(e){if("addEventListener"==e)return this.j.addEventListener.bind(this.j);if("removeEventListener"==e)return this.j.removeEventListener.bind(this.j);if(this.g.la()&&0==Object.keys(this.g.g.video).length){var t=this.i[e];if("function"!=typeof t)return t}return this.g.la()?this.g.get("video",e):("function"==typeof(e=this.i[e])&&(e=e.bind(this.i)),e)},vi.prototype.M=function(e,t){this.g.la()?this.g.set("video",e,t):this.i[e]=t},vi.prototype.L=function(e){this.g.la()||this.j.dispatchEvent(new Ue(e.type,e))},vi.prototype.F=function(e){this.g.la()||this.l.dispatchEvent(e)},G(xi,Ke),V("shaka.cast.CastReceiver",xi),xi.prototype.isConnected=function(){return this.F},xi.prototype.isConnected=xi.prototype.isConnected,xi.prototype.Rf=function(){return this.m},xi.prototype.isIdle=xi.prototype.Rf,xi.prototype.destroy=function(){var e=this;return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:return e.i&&(e.i.release(),e.i=null),n=[],e.h&&(n.push(e.h.destroy()),e.h=null),e.J&&(e.J.stop(),e.J=null),e.g=null,e.L=null,e.C=null,e.F=!1,e.m=!0,e.j=null,e.o=null,k(t,Promise.all(n),2);case 2:cast.receiver.CastReceiverManager.getInstance().stop(),A(t)}}))}))},xi.prototype.destroy=xi.prototype.destroy,(r=xi.prototype).xe=function(){this.l=0,this.u=!0,this.F=0!=cast.receiver.CastReceiverManager.getInstance().getSenders().length,ki(this)},r.Ce=function(e,t){this.h&&(Ai(this),Pi(this,{type:"event",targetName:e,event:t},this.j))},r.hf=function(){var e=cast.receiver.CastReceiverManager.getInstance().getSystemVolume();e&&Pi(this,{type:"update",update:{video:{volume:e.level,muted:e.muted}}},this.j),Pi(this,{type:"event",targetName:"video",event:{type:"volumechange"}},this.j)},r.fg=function(e){var t=oi(e.data);switch(Y.debug("CastReceiver: message",t),t.type){case"init":this.l=0,this.A=!1,this.u=!0,function(e,t,n){for(var i in t.player)e.h[i](t.player[i]);e.C(n),n=Promise.resolve();var r=e.g.autoplay;t.manifest&&(e.g.autoplay=!1,n=e.h.load(t.manifest,t.startTime)),n.then((function(){if(e.h){for(var n in t.video)e.g[n]=t.video[n];for(var i in t.playerAfterLoad)e.h[i](t.playerAfterLoad[i]);e.g.autoplay=r,t.manifest&&(e.g.play(),Ci(e))}}),(function(t){e.h.dispatchEvent(new Ue("error",{detail:t}))}))}(this,t.initState,t.appData),Ai(this);break;case"appData":this.C(t.appData);break;case"set":var n=t.targetName,i=t.property;if(t=t.value,"video"==n){var r=cast.receiver.CastReceiverManager.getInstance();if("volume"==i){r.setSystemVolumeLevel(t);break}if("muted"==i){r.setSystemVolumeMuted(t);break}}this.L[n][i]=t;break;case"call":(n=this.L[t.targetName])[t.methodName].apply(n,t.args);break;case"asyncCall":n=t.targetName,i=t.methodName,"player"==n&&"load"==i&&(this.l=0,this.A=!1),r=t.id,e=e.senderId;var o=this.L[n];t=o[i].apply(o,t.args),"player"==n&&"load"==i&&(t=t.then(function(){this.u=!0}.bind(this))),t.then(this.Je.bind(this,e,r,null),this.Je.bind(this,e,r))}},r.Wf=function(e){var t=oi(e.data);switch(Y.debug("CastReceiver: message",t),t.type){case"PLAY":this.g.play(),Ci(this);break;case"PAUSE":this.g.pause(),Ci(this);break;case"SEEK":e=t.currentTime;var n=t.resumeState;null!=e&&(this.g.currentTime=Number(e)),n&&"PLAYBACK_START"==n?(this.g.play(),Ci(this)):n&&"PLAYBACK_PAUSE"==n&&(this.g.pause(),Ci(this));break;case"STOP":this.h.Ud().then(function(){this.h&&Ci(this)}.bind(this));break;case"GET_STATUS":Ii(this,Number(t.requestId));break;case"VOLUME":e=(n=t.volume).level,n=n.muted;var i=this.g.volume,r=this.g.muted;null!=e&&(this.g.volume=Number(e)),null!=n&&(this.g.muted=n),i==this.g.volume&&r==this.g.muted||Ci(this);break;case"LOAD":this.l=0,this.u=this.A=!1,e=t.media,n=t.currentTime,i=this.M(e.contentId),r=t.autoplay||!0,this.C(e.customData),r&&(this.g.autoplay=!0),this.h.load(i,n).then(function(){this.h&&Ii(this)}.bind(this)).catch(function(e){var n="LOAD_FAILED";7==e.category&&7e3==e.code&&(n="LOAD_CANCELLED"),Pi(this,{requestId:Number(t.requestId),type:n},this.o)}.bind(this));break;default:Y.v("Unrecognized message type from the generic Chromecast controller!",t.type),Pi(this,{requestId:Number(t.requestId),type:"INVALID_REQUEST",reason:"INVALID_COMMAND"},this.o)}},r.Je=function(e,t,n){this.h&&Pi(this,{type:"asyncComplete",id:t,error:n},this.j,e)};var Ri={IDLE:"IDLE",Ue:"PLAYING",Re:"BUFFERING",Te:"PAUSED"};function Ni(e,t){this.S=e,this.h=t==Di,this.g=0}V("shaka.util.DataViewReader",Ni);var Di=1;function ji(){throw new $(2,3,3e3)}function _i(){this.i=[],this.h=[],this.g=!1}function Li(e){for(var t=Fi(e);e.reader.Ca()&&!e.parser.g;)e.parser.Fc(e.start+t,e.reader,e.partialOkay)}function Ui(e){for(var t=Fi(e),n=e.reader.N();0<n&&!e.parser.g;--n)e.parser.Fc(e.start+t,e.reader,e.partialOkay)}function Oi(e){return function(t){e(t.reader.mb(t.reader.S.byteLength-t.reader.ka()))}}function Ki(e){for(var t=0,n=0;n<e.length;n++)t=t<<8|e.charCodeAt(n);return t}function Bi(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)}function Fi(e){return 8+(e.has64BitSize?8:0)+(null!=e.flags?4:0)}function Hi(e){var t=this;this.g=[],this.h=[],this.data=[],(new _i).box("moov",Li).ma("pssh",(function(e){if(1<e.version)Y.v("Unrecognized PSSH version found!");else{var n=e.reader.S;if(n=new Uint8Array(n.buffer,n.byteOffset-12,e.size),t.data.push(n),t.g.push(Ee.Nc(e.reader.mb(16))),0<e.version){n=e.reader.N();for(var i=0;i<n;++i){var r=Ee.Nc(e.reader.mb(16));t.h.push(r)}}}})).parse(e),0==this.data.length&&Y.v("No pssh box found!")}Ni.Endianness={Tg:0,Vg:Di},Ni.prototype.Ca=function(){return this.g<this.S.byteLength},Ni.prototype.hasMoreData=Ni.prototype.Ca,Ni.prototype.ka=function(){return this.g},Ni.prototype.getPosition=Ni.prototype.ka,Ni.prototype.sf=function(){return this.S.byteLength},Ni.prototype.getLength=Ni.prototype.sf,Ni.prototype.ra=function(){try{var e=this.S.getUint8(this.g);return this.g+=1,e}catch(e){ji()}},Ni.prototype.readUint8=Ni.prototype.ra,Ni.prototype.dc=function(){try{var e=this.S.getUint16(this.g,this.h);return this.g+=2,e}catch(e){ji()}},Ni.prototype.readUint16=Ni.prototype.dc,Ni.prototype.N=function(){try{var e=this.S.getUint32(this.g,this.h);return this.g+=4,e}catch(e){ji()}},Ni.prototype.readUint32=Ni.prototype.N,Ni.prototype.De=function(){try{var e=this.S.getInt32(this.g,this.h);return this.g+=4,e}catch(e){ji()}},Ni.prototype.readInt32=Ni.prototype.De,Ni.prototype.Pb=function(){try{if(this.h)var e=this.S.getUint32(this.g,!0),t=this.S.getUint32(this.g+4,!0);else t=this.S.getUint32(this.g,!1),e=this.S.getUint32(this.g+4,!1)}catch(e){ji()}if(2097151<t)throw new $(2,3,3001);return this.g+=8,t*Math.pow(2,32)+e},Ni.prototype.readUint64=Ni.prototype.Pb,Ni.prototype.mb=function(e){this.g+e>this.S.byteLength&&ji();var t=new Uint8Array(this.S.buffer,this.S.byteOffset+this.g,e);return this.g+=e,t},Ni.prototype.readBytes=Ni.prototype.mb,Ni.prototype.U=function(e){this.g+e>this.S.byteLength&&ji(),this.g+=e},Ni.prototype.skip=Ni.prototype.U,Ni.prototype.Fe=function(e){this.g<e&&ji(),this.g-=e},Ni.prototype.rewind=Ni.prototype.Fe,Ni.prototype.seek=function(e){(0>e||e>this.S.byteLength)&&ji(),this.g=e},Ni.prototype.seek=Ni.prototype.seek,Ni.prototype.Cd=function(){for(var e=this.g;this.Ca()&&0!=this.S.getUint8(this.g);)this.g+=1;return e=new Uint8Array(this.S.buffer,this.S.byteOffset+e,this.g-e),this.g+=1,me(e)},Ni.prototype.readTerminatedString=Ni.prototype.Cd,V("shaka.util.Mp4Parser",_i),_i.prototype.box=function(e,t){var n=Ki(e);return this.i[n]=0,this.h[n]=t,this},_i.prototype.box=_i.prototype.box,_i.prototype.ma=function(e,t){var n=Ki(e);return this.i[n]=1,this.h[n]=t,this},_i.prototype.fullBox=_i.prototype.ma,_i.prototype.stop=function(){this.g=!0},_i.prototype.stop=_i.prototype.stop,_i.prototype.parse=function(e,t){var n=new Uint8Array(e);for(n=new Ni(new DataView(n.buffer,n.byteOffset,n.byteLength),0),this.g=!1;n.Ca()&&!this.g;)this.Fc(0,n,t)},_i.prototype.parse=_i.prototype.parse,_i.prototype.Fc=function(e,t,n){var i=t.ka(),r=t.N(),o=t.N(),a=!1;switch(Y.O("Parsing MP4 box",Bi(o)),r){case 0:r=t.S.byteLength-i;break;case 1:r=t.Pb(),a=!0}var s=this.h[o];if(s){var u=null,c=null;1==this.i[o]&&(u=(c=t.N())>>>24,c&=16777215),o=i+r,n&&o>t.S.byteLength&&(o=t.S.byteLength),o-=t.ka(),t=0<o?t.mb(o):new Uint8Array(0),s({parser:this,partialOkay:n||!1,version:u,flags:c,reader:t=new Ni(new DataView(t.buffer,t.byteOffset,t.byteLength),0),size:r,start:i+e,has64BitSize:a})}else t.U(Math.min(i+r-t.ka(),t.S.byteLength-t.ka()))},_i.prototype.parseNext=_i.prototype.Fc,_i.children=Li,_i.sampleDescription=Ui,_i.allData=Oi,_i.typeToString=Bi,_i.headerSize=Fi;var Vi={sc:function(e,t){var n=Vi.Y(e,t);return 1!=n.length?null:n[0]},Yc:function(e,t,n){return 1!=(e=Vi.fe(e,t,n)).length?null:e[0]},Y:function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName==t}))},fe:function(e,t,n){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName==n&&e.namespaceURI==t}))},getAttributeNS:function(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null},uc:function(e){return Array.prototype.every.call(e.childNodes,(function(e){return e.nodeType==Node.TEXT_NODE||e.nodeType==Node.CDATA_SECTION_NODE}))?e.textContent.trim():null},R:function(e,t,n,i){i=void 0===i?null:i;var r=null;return null!=(e=e.getAttribute(t))&&(r=n(e)),null==r?i:r},jg:function(e){return e?(/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),e=Date.parse(e),isNaN(e)?null:Math.floor(e/1e3)):null},Ma:function(e){if(!e)return null;var t=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(e);return t?(e=31536e3*Number(t[1]||null)+2592e3*Number(t[2]||null)+86400*Number(t[3]||null)+3600*Number(t[4]||null)+60*Number(t[5]||null)+Number(t[6]||null),isFinite(e)?e:null):(Y.v("Invalid duration string:",e),null)},Hc:function(e){var t=/([0-9]+)-([0-9]+)/.exec(e);return t?(e=Number(t[1]),isFinite(e)?(t=Number(t[2]),isFinite(t)?{start:e,end:t}:null):null):null},parseInt:function(e){return 0==(e=Number(e))%1?e:null},Gc:function(e){return 0==(e=Number(e))%1&&0<e?e:null},Mb:function(e){return 0==(e=Number(e))%1&&0<=e?e:null},parseFloat:function(e){return e=Number(e),isNaN(e)?null:e},ff:function(e){var t;return e=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1])/Number(t[2]):Number(e),isNaN(e)?null:e},Ae:function(e,t){var n=new DOMParser;try{var i=n.parseFromString(e,"text/xml")}catch(e){}if(i&&i.documentElement.tagName==t)var r=i.documentElement;return r&&0<r.getElementsByTagName("parsererror").length?null:r},ze:function(e,t){try{var n=me(e);return Vi.Ae(n,t)}catch(e){}}},Gi=(new Map).set("urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b","org.w3.clearkey").set("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine.alpha").set("urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:79f0049a-4098-8642-ab92-e65be0885f95","com.microsoft.playready").set("urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb","com.adobe.primetime");function qi(e,t,n){var i=function(e){for(var t=[],n=(e=f(e)).next();!n.done;n=e.next())(n=Xi(n.value))&&t.push(n);return t}(e),r=null;e=[];var o=[],a=new Set(i.map((function(e){return e.keyId})));if(a.delete(null),1<a.size)throw new $(2,4,4010);if(n||(o=i.filter((function(e){return"urn:mpeg:dash:mp4protection:2011"!=e.Ge||(r=e.init||r,!1)}))).length&&(0==(e=function(e,t,n){for(var i=[],r=(n=f(n)).next();!r.done;r=n.next()){r=r.value;var o=Gi.get(r.Ge);if(o){var a;if(a=Vi.Yc(r.node,"urn:microsoft:playready","pro")){a=Ee.Ja(a.textContent);var s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),u=a.length,c=s.length+16+u,l=new ArrayBuffer(c),d=new Uint8Array(l);l=new DataView(l);var h=0;l.setUint32(h,c),h+=4,l.setUint32(h,1886614376),h+=4,l.setUint32(h,0),h+=4,d.set(s,h),h+=s.length,l.setUint32(h,u),h+=4,d.set(a,h),a=[{initData:d,initDataType:"cenc",keyId:r.keyId}]}else a=null;a=fe(o,r.init||e||a),(o=Wi.get(o))&&(a.licenseServerUri=o(r)),i.push(a)}else for(r=f(r=t(r.node)||[]),o=r.next();!o.done;o=r.next())i.push(o.value)}return i}(r,t,o)).length&&(e=[fe("",r)])),i.length&&(n||!o.length))for(e=[],n=(t=f(Gi.values())).next();!n.done;n=t.next())"org.w3.clearkey"!=(n=n.value)&&e.push(fe(n,r));if(a=Array.from(a)[0]||null)for(n=(t=f(e)).next();!n.done;n=t.next())for(i=(n=f(n.value.initData)).next();!i.done;i=n.next())i.value.keyId=a;return{be:a,Xg:r,drmInfos:e,ge:!0}}var zi,Wi=(new Map).set("com.widevine.alpha",(function(e){return(e=Vi.Yc(e.node,"urn:microsoft","laurl"))&&e.getAttribute("licenseUrl")||""})).set("com.microsoft.playready",(function(e){return(e=Vi.Yc(e.node,"urn:microsoft:playready","pro"))&&(e=function(e){var t=0,n=new DataView(e).getUint32(t,!0);if(t+=4,n!==e.byteLength)return Y.v("PlayReady Object with invalid length encountered."),[];t+=2,n=[];for(var i=new DataView(e);t<e.byteLength-1;){var r=i.getUint16(t,!0);t+=2;var o=i.getUint16(t,!0);t+=2;var a=new Uint8Array(e,t,o);n.push({type:r,value:a}),t+=o}return n}((e=Ee.Ja(e.textContent)).buffer).filter((function(e){return 1===e.type}))[0])?(e=ve(e.value,!0),(e=Vi.Ae(e,"WRMHEADER"))?function(e){for(var t=(e=f(e.getElementsByTagName("DATA"))).next();!t.done;t=e.next())for(var n=(t=f(t.value.childNodes)).next();!n.done;n=t.next())if((n=n.value)instanceof Element&&"LA_URL"==n.tagName)return n.textContent;return""}(e):""):""}));function Xi(e){var t=e.getAttribute("schemeIdUri"),n=Vi.getAttributeNS(e,"urn:mpeg:cenc:2013","default_KID"),i=Vi.fe(e,"urn:mpeg:cenc:2013","pssh").map(Vi.uc);if(!t)return Y.error("Missing required schemeIdUri attribute on","ContentProtection element",e),null;if(t=t.toLowerCase(),n&&(n=n.replace(/-/g,"").toLowerCase()).includes(" "))throw new $(2,4,4009);var r=[];try{r=i.map((function(e){return{initDataType:"cenc",initData:Ee.Ja(e),keyId:null}}))}catch(e){throw new $(2,4,4007)}return{node:e,Ge:t,keyId:n,init:0<r.length?r:null}}function Yi(t,n,i,r,o){var a={RepresentationID:n,Number:i,Bandwidth:r,Time:o};return t.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)([diouxX]))?\$/g,(function(n,i,r,o){if("$$"==n)return"$";var s=a[i];if(null==s)return Y.v("URL template does not have an available substitution for identifier",'"'+i+'":',t),n;switch("RepresentationID"==i&&r&&(Y.v("URL template should not contain a width specifier for identifier",'"RepresentationID":',t),r=void 0),"Time"==i&&(s=Math.round(s)),o){case void 0:case"d":case"i":case"u":n=s.toString();break;case"o":n=s.toString(8);break;case"x":n=s.toString(16);break;case"X":n=s.toString(16).toUpperCase();break;default:n=s.toString()}return r=e.parseInt(r,10)||1,Array(Math.max(0,r-n.length)+1).join("0")+n}))}function $i(e,t){var n=Ji(e,t,"timescale"),i=1;n&&(i=Vi.Gc(n)||1),n=Ji(e,t,"duration"),(n=Vi.Gc(n||""))&&(n/=i);var r=Ji(e,t,"startNumber"),o=Number(Ji(e,t,"presentationTimeOffset"))||0,a=Vi.Mb(r||"");null!=r&&null!=a||(a=1);var s=Qi(e,t,"SegmentTimeline");if(r=null,s){r=i;var u=e.$.duration||1/0;s=Vi.Y(s,"S");for(var c=[],l=-o,d=0;d<s.length;++d){var h=s[d],f=Vi.R(h,"t",Vi.Mb),p=Vi.R(h,"d",Vi.Mb),g=Vi.R(h,"r",Vi.parseInt);if(null!=f&&(f-=o),!p){Y.v('"S" element must have a duration:','ignoring the remaining "S" elements.',h);break}if(f=null!=f?f:l,0>(g=g||0))if(d+1<s.length){if(null==(g=Vi.R(s[d+1],"t",Vi.Mb))){Y.v('An "S" element cannot have a negative repeat','if the next "S" element does not have a valid start time:','ignoring the remaining "S" elements.',h);break}if(f>=g){Y.v('An "S" element cannot have a negative repeat','if its start time exceeds the next "S" element\'s start time:','ignoring the remaining "S" elements.',h);break}g=Math.ceil((g-f)/p)-1}else{if(1/0==u){Y.v('The last "S" element cannot have a negative repeat',"if the Period has an infinite duration:",'ignoring the last "S" element.',h);break}if(f/r>=u){Y.v('The last "S" element cannot have a negative repeat',"if its start time exceeds the Period's duration:",'igoring the last "S" element.',h);break}g=Math.ceil((u*r-f)/p)-1}for(0<c.length&&f!=l&&(Math.abs((f-l)/r)>=1/15&&Y.v("SegmentTimeline contains a large gap/overlap:","the content may have errors in it.",h),c[c.length-1].end=f/r),h=0;h<=g;++h)l=f+p,c.push({start:f/r,end:l/r,Pg:f}),f=l}r=c}return{timescale:i,ia:n,ob:a,sa:o/i||0,Vd:o,W:r}}function Ji(e,t,n){return[t(e.G),t(e.fa),t(e.qa)].filter(de.Ra).map((function(e){return e.getAttribute(n)})).reduce((function(e,t){return e||t}))}function Qi(e,t,n){return[t(e.G),t(e.fa),t(e.qa)].filter(de.Ra).map((function(e){return Vi.sc(e,n)})).reduce((function(e,t){return e||t}))}function Zi(e,t,n,i,r,o){if(o=void 0===o?0:o,Vi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href")){var a=function(e,t,n,i,r,o){for(var a=Vi.getAttributeNS(e,"http://www.w3.org/1999/xlink","href"),s=Vi.getAttributeNS(e,"http://www.w3.org/1999/xlink","actuate")||"onRequest",u=0;u<e.attributes.length;u++){var c=e.attributes[u];"http://www.w3.org/1999/xlink"==c.namespaceURI&&(e.removeAttributeNS(c.namespaceURI,c.localName),--u)}if(5<=o)return Ne(new $(2,4,4028));if("onLoad"!=s)return Ne(new $(2,4,4027));var l=he([i],[a]);return r.request(0,Ye(l,t)).ca((function(i){if(!(i=Vi.ze(i.data,e.tagName)))return Ne(new $(2,4,4001,a));for(;e.childNodes.length;)e.removeChild(e.childNodes[0]);for(;i.childNodes.length;){var s=i.childNodes[0];i.removeChild(s),e.appendChild(s)}for(s=0;s<i.attributes.length;s++){var u=i.attributes[s].nodeName,c=i.getAttribute(u);e.setAttribute(u,c)}return Zi(e,t,n,l[0],r,o+1)}))}(e,t,n,i,r,o);return n&&(a=a.ca(void 0,(function(){return Zi(e,t,n,i,r,o)}))),a}a=[];for(var s=0;s<e.childNodes.length;s++){var u=e.childNodes[s];u instanceof Element&&("urn:mpeg:dash:resolve-to-zero:2013"==Vi.getAttributeNS(u,"http://www.w3.org/1999/xlink","href")?(e.removeChild(u),--s):"SegmentTimeline"!=u.tagName&&a.push(Zi(u,t,n,i,r,o)))}return Le(a).ca((function(){return e}))}function er(e,t,n){this.i=e,this.h=t,this.g=n}function tr(e,t,n,i,r,o){this.position=e,this.startTime=t,this.endTime=n,this.i=i,this.h=r,this.g=o}function nr(e,t,n,i){var r,o=(new _i).ma("sidx",(function(e){r=function(e,t,n,i){var r=[];i.reader.U(4);var o=i.reader.N();if(0==o)throw Y.error("Invalid timescale."),new $(2,3,3005);if(0==i.version)var a=i.reader.N(),s=i.reader.N();else a=i.reader.Pb(),s=i.reader.Pb();i.reader.U(2);var u=i.reader.dc();for(e=e+i.size+s,s=0;s<u;s++){var c=i.reader.N(),l=(2147483648&c)>>>31;c&=2147483647;var d=i.reader.N();if(i.reader.U(4),1==l)throw Y.error("Heirarchical SIDXs are not supported."),new $(2,3,3006);r.push(new tr(r.length,a/o-t,(a+d)/o-t,(function(){return n}),e,e+c-1)),a+=d,e+=c}return i.parser.stop(),r}(t,i,n,e)}));if(e&&o.parse(e),r)return r;throw Y.error('Invalid box type, expected "sidx".'),new $(2,3,3004)}function ir(e){this.g=e}function rr(e,t){for(;e.g.length&&e.g[e.g.length-1].startTime>=t;)e.g.pop();for(;e.g.length&&0>=e.g[0].endTime;)e.g.shift();if(0!=e.g.length){var n=e.g[e.g.length-1];e.g[e.g.length-1]=new tr(n.position,n.startTime,t,n.i,n.h,n.g)}}function or(e){this.h=e,this.g=new Ni(e,0),zi||(zi=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}function ar(e){var t=sr(e);if(7<t.length)throw new $(2,3,3002);for(var n=0,i=0;i<t.length;i++)n=256*n+t[i];t=n,n=sr(e);e:{i=Ee.Ha;for(var r=0;r<zi.length;r++)if(i(n,zi[r])){i=!0;break e}i=!1}if(i)n=e.h.byteLength-e.g.ka();else{if(8==n.length&&224&n[1])throw new $(2,3,3001);for(i=n[0]&(1<<8-n.length)-1,r=1;r<n.length;r++)i=256*i+n[r];n=i}return n=e.g.ka()+n<=e.h.byteLength?n:e.h.byteLength-e.g.ka(),i=new DataView(e.h.buffer,e.h.byteOffset+e.g.ka(),n),e.g.U(n),new ur(t,i)}function sr(e){var t,n=e.g.ra();for(t=1;8>=t&&!(n&1<<8-t);t++);if(8<t)throw new $(2,3,3002);var i=new Uint8Array(t);for(i[0]=n,n=1;n<t;n++)i[n]=e.g.ra();return i}function ur(e,t){this.id=e,this.g=t}function cr(e){if(8<e.g.byteLength)throw new $(2,3,3002);if(8==e.g.byteLength&&224&e.g.getUint8(0))throw new $(2,3,3001);for(var t=0,n=0;n<e.g.byteLength;n++){t=256*t+e.g.getUint8(n)}return t}function lr(){}function dr(e){var t=new or(e.g);if(179!=(e=ar(t)).id)throw Y.v("Not a CueTime element."),new $(2,3,3013);if(e=cr(e),183!=(t=ar(t)).id)throw Y.v("Not a CueTrackPositions element."),new $(2,3,3012);t=new or(t.g);for(var n=0;t.Ca();){var i=ar(t);if(241==i.id){n=cr(i);break}}return{Qg:e,qg:n}}function hr(e,t){var n=Qi(e,t,"Initialization");if(!n)return null;var i=e.G.xa,r=n.getAttribute("sourceURL");r&&(i=he(e.G.xa,[r])),r=0;var o=null;return(n=Vi.R(n,"range",Vi.Hc))&&(r=n.start,o=n.end),new er((function(){return i}),r,o)}function fr(e,t,n,i,r,o,a,s){var u=e.presentationTimeline,c=!e.zb||!e.$.ld,l=e.$.start,d=e.$.duration,h=t,f=null;return{createSegmentIndex:function(){var e=[h(i,r,o),"webm"==a?h(n.i(),n.h,n.g):null];return h=null,Promise.all(e).then((function(e){var t=e[0];e=e[1]||null,t="mp4"==a?nr(t,r,i,s):(new lr).parse(t,e,i,s),u.Jb(t,l),f=new ir(t),c&&rr(f,d)}))},findSegmentPosition:function(e){return f.find(e)},getSegmentReference:function(e){return f.get(e)}}}function pr(e){return e.ec}function gr(e,t){var n=hr(e,mr),i=function(e){return[e.G.Ua,e.fa.Ua,e.qa.Ua].filter(de.Ra).map((function(e){return Vi.Y(e,"SegmentURL")})).reduce((function(e,t){return 0<e.length?e:t})).map((function(t){return t.getAttribute("indexRange")&&!e.me&&(e.me=!0,Y.v("We do not support the SegmentURL@indexRange attribute on SegmentList.  We only use the SegmentList@duration attribute or SegmentTimeline, which must be accurate.")),{Tf:t.getAttribute("media"),start:(t=Vi.R(t,"mediaRange",Vi.Hc,{start:0,end:null})).start,end:t.end}}))}(e),r=$i(e,mr),o=r.ob;0==o&&(Y.v("SegmentList@startNumber must be > 0"),o=1);var a=0;if(r.ia?a=r.ia*(o-1):r.W&&0<r.W.length&&(a=r.W[0].start),!(i={ia:r.ia,startTime:a,ob:o,sa:r.sa,W:r.W,jb:i}).ia&&!i.W&&1<i.jb.length)throw Y.v("SegmentList does not contain sufficient segment information:","the SegmentList specifies multiple segments,","but does not specify a segment duration or timeline.",e.G),new $(2,4,4002);if(!i.ia&&!e.$.duration&&!i.W&&1==i.jb.length)throw Y.v("SegmentList does not contain sufficient segment information:","the SegmentList specifies one segment,","but does not specify a segment duration, period duration,","or timeline.",e.G),new $(2,4,4002);if(i.W&&0==i.W.length)throw Y.v("SegmentList does not contain sufficient segment information:","the SegmentList has an empty timeline.",e.G),new $(2,4,4002);return o=r=null,e.qa.id&&e.G.id&&(r=t[o=e.qa.id+","+e.G.id]),a=function(e,t,n,i){var r=i.jb.length;i.W&&i.W.length!=i.jb.length&&(r=Math.min(i.W.length,i.jb.length),Y.v("The number of items in the segment timeline and the number of segment","URLs do not match, truncating",i.jb.length,"to",r));for(var o=[],a=i.startTime,s=0;s<r;s++){var u,c=i.jb[s],l=he(n,[c.Tf]);u=null!=i.ia?a+i.ia:i.W?i.W[s].end:a+e,o.push(new tr(s+t,a,u,function(e){return e}.bind(null,l),c.start,c.end)),a=u}return o}(e.$.duration,i.ob,e.G.xa,i),r?(r.sd(a),o=e.presentationTimeline.$b(),r.Vc(o-e.$.start)):(e.presentationTimeline.Jb(a,e.$.start),r=new ir(a),o&&e.zb&&(t[o]=r)),e.zb&&e.$.ld||rr(r,e.$.duration),{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:r.find.bind(r),getSegmentReference:r.get.bind(r),initSegmentReference:n,sa:i.sa}}function mr(e){return e.Ua}function vr(e,t,n,i){var r=function(e){var t=Ji(e,yr,"initialization");if(!t)return null;var n=e.G.id,i=e.bandwidth||null,r=e.G.xa;return new er((function(){var e=Yi(t,n,null,i,null);return he(r,[e])}),0,null)}(e),o=$i(e,yr),a=Ji(e,yr,"media"),s=Ji(e,yr,"index");if(a=(o={ia:o.ia,timescale:o.timescale,ob:o.ob,sa:o.sa,Vd:o.Vd,W:o.W,qd:a,bc:s}).bc?1:0,a+=o.W?1:0,0==(a+=o.ia?1:0))throw Y.error("SegmentTemplate does not contain any segment information:","the SegmentTemplate must contain either an index URL template","a SegmentTimeline, or a segment duration.",e.G),new $(2,4,4002);if(1!=a&&(Y.v("SegmentTemplate containes multiple segment information sources:","the SegmentTemplate should only contain an index URL template,","a SegmentTimeline or a segment duration.",e.G),o.bc?(Y.info("Using the index URL template by default."),o.W=null):Y.info("Using the SegmentTimeline by default."),o.ia=null),!o.bc&&!o.qd)throw Y.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate's media URL template is missing.",e.G),new $(2,4,4002);if(o.bc){if("mp4"!=(n=e.G.mimeType.split("/")[1])&&"webm"!=n)throw Y.error("SegmentTemplate specifies an unsupported container type.",e.G),new $(2,4,4006);if("webm"==n&&!r)throw Y.error("SegmentTemplate does not contain sufficient segment information:","the SegmentTemplate uses a WebM container,","but does not contain an initialization URL template.",e.G),new $(2,4,4005);i=Yi(o.bc,e.G.id,null,e.bandwidth||null,null),e=fr(e,t,r,i=he(e.G.xa,[i]),0,null,n,o.sa)}else o.ia?(i||(e.presentationTimeline.ud(o.ia),e.presentationTimeline.vd(e.$.start)),e=function(e,t){var n=e.$.duration,i=t.ia,r=t.ob,o=t.timescale,a=t.qd,s=e.bandwidth||null,u=e.G.id,c=e.G.xa;return{createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0>e||n&&e>=n?null:Math.floor(e/i)},getSegmentReference:function(e){var t=e*i,l=t+i;return n&&(l=Math.min(l,n)),0>l||n&&t>=n?null:new tr(e,t,l,(function(){var n=Yi(a,u,e+r,s,t*o);return he(c,[n])}),0,null)}}}(e,o)):(a=t=null,e.qa.id&&e.G.id&&(t=n[a=e.qa.id+","+e.G.id]),s=function(e,t){for(var n=[],i=0;i<t.W.length;i++){var r=i+t.ob;n.push(new tr(r,t.W[i].start,t.W[i].end,function(e,t,n,i,r,o){return he(i,[e=Yi(e,t,r,n,o)]).map((function(e){return e.toString()}))}.bind(null,t.qd,e.G.id,e.bandwidth||null,e.G.xa,r,t.W[i].Pg+t.Vd),0,null))}return n}(e,o),i=!e.zb||!e.$.ld,t?(i&&rr(new ir(s),e.$.duration),t.sd(s),n=e.presentationTimeline.$b(),t.Vc(n-e.$.start)):(e.presentationTimeline.Jb(s,e.$.start),t=new ir(s),a&&e.zb&&(n[a]=t)),i&&rr(t,e.$.duration),e={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:t.find.bind(t),getSegmentReference:t.get.bind(t)});return{createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:r,sa:o.sa}}function yr(e){return e.gc}V("shaka.media.InitSegmentReference",er),er.prototype.Tc=function(){return this.i()},er.prototype.createUris=er.prototype.Tc,er.prototype.dd=function(){return this.h},er.prototype.getStartByte=er.prototype.dd,er.prototype.cd=function(){return this.g},er.prototype.getEndByte=er.prototype.cd,V("shaka.media.SegmentReference",tr),tr.prototype.ka=function(){return this.position},tr.prototype.getPosition=tr.prototype.ka,tr.prototype.xc=function(){return this.startTime},tr.prototype.getStartTime=tr.prototype.xc,tr.prototype.qf=function(){return this.endTime},tr.prototype.getEndTime=tr.prototype.qf,tr.prototype.Tc=function(){return this.i()},tr.prototype.createUris=tr.prototype.Tc,tr.prototype.dd=function(){return this.h},tr.prototype.getStartByte=tr.prototype.dd,tr.prototype.cd=function(){return this.g},tr.prototype.getEndByte=tr.prototype.cd,V("shaka.media.SegmentIndex",ir),ir.prototype.destroy=function(){return this.g=null,Promise.resolve()},ir.prototype.destroy=ir.prototype.destroy,ir.prototype.find=function(e){for(var t=this.g.length-1,n=t;0<=n;--n){var i=this.g[n],r=n<t?this.g[n+1].startTime:i.endTime;if(e>=i.startTime&&e<r)return i.position}return this.g.length&&e<this.g[0].startTime?this.g[0].position:null},ir.prototype.find=ir.prototype.find,ir.prototype.get=function(e){return 0==this.g.length||0>(e-=this.g[0].position)||e>=this.g.length?null:this.g[e]},ir.prototype.get=ir.prototype.get,ir.prototype.offset=function(e){for(var t=0;t<this.g.length;++t)this.g[t].startTime+=e,this.g[t].endTime+=e},ir.prototype.offset=ir.prototype.offset,ir.prototype.sd=function(e){for(var t=[],n=0,i=0;n<this.g.length&&i<e.length;){var r=this.g[n],o=e[i];r.startTime<o.startTime?(t.push(r),n++):(r.startTime>o.startTime?0==n?t.push(o):Y.v("Refusing to rewrite original references on update!"):(.1<Math.abs(r.endTime-o.endTime)?t.push(new tr(r.position,o.startTime,o.endTime,o.i,o.h,o.g)):t.push(r),n++),i++)}for(;n<this.g.length;)t.push(this.g[n++]);if(t.length)for(n=t[t.length-1].position+1;i<e.length;)r=new tr(n++,(r=e[i++]).startTime,r.endTime,r.i,r.h,r.g),t.push(r);else t=e;this.g=t},ir.prototype.merge=ir.prototype.sd,ir.prototype.Vc=function(e){for(var t=0;t<this.g.length;++t)if(this.g[t].endTime>e)return void this.g.splice(0,t);this.g=[]},ir.prototype.evict=ir.prototype.Vc,or.prototype.Ca=function(){return this.g.Ca()},lr.prototype.parse=function(e,t,n,i){var r;if(440786851!=ar(t=new or(new DataView(t))).id)throw Y.error("Not an EBML element."),new $(2,3,3008);var o=ar(t);if(408125543!=o.id)throw Y.error("Not a Segment element."),new $(2,3,3009);for(t=o.g.byteOffset,o=new or(o.g),r=null;o.Ca();){var a=ar(o);if(357149030==a.id){r=a;break}}if(!r)throw Y.error("Not an Info element."),new $(2,3,3010);for(o=new or(r.g),r=1e6,a=null;o.Ca();){var s=ar(o);if(2807729==s.id)r=cr(s);else if(17545==s.id)if(4==(a=s).g.byteLength)a=a.g.getFloat32(0);else{if(8!=a.g.byteLength)throw new $(2,3,3003);a=a.g.getFloat64(0)}}if(null==a)throw new $(2,3,3011);if(r=a*(o=r/1e9),475249515!=(e=ar(new or(new DataView(e)))).id)throw Y.error("Not a Cues element."),new $(2,3,3007);return function(e,t,n,i,r,o){function a(){return r}var s=[];e=new or(e.g);for(var u=null,c=null;e.Ca();){var l=ar(e);if(187==l.id){var d=dr(l);d&&(l=n*d.Qg,d=t+d.qg,null!=u&&s.push(new tr(s.length,u-o,l-o,a,c,d-1)),u=l,c=d)}}return null!=u&&s.push(new tr(s.length,u-o,i-o,a,c,null)),s}(e,t,o,r,n,i)};var br={Nb:{},cc:{},Fd:function(e,t){br.cc[e]=t}};function wr(e,t,n){this.j=e,this.Ic=t,this.m=this.l=1/0,this.g=1,this.h=this.i=null,this.u=0,this.A=!0,this.o=0,this.C=void 0===n||n}function Tr(e,t,n,i){return e=Ye(e,i),0==t&&null==n||(e.headers.Range=n?"bytes="+t+"-"+n:"bytes="+t+"-"),e}function Sr(){var e=this;this.h=this.g=null,this.j=[],this.i=null,this.u=[],this.m=1,this.A={},this.C=0,this.F=new q(5),this.o=new Ie((function(){!function(e){g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return Y.info("Updating manifest..."),n=0,M(t,2),k(t,Er(e),4);case 4:n=t.B,P(t,3);break;case 2:i=C(t),e.h&&(i.severity=1,e.h.onError(i));case 3:if(!e.h)return t.return();Mr(e,n),A(t)}}))}))}(e)})),this.l=new Ge}function Er(e){var t=Date.now(),n=e.h.networkingEngine.request(0,Ye(e.j,e.g.retryParameters));return qe(e.l,n),n.promise.then((function(t){if(e.h)return t.uri&&!e.j.includes(t.uri)&&e.j.unshift(t.uri),function(e,t,n){if(!(t=Vi.ze(t,"MPD")))throw new $(2,4,4001,n);return t=Zi(t,e.g.retryParameters,e.g.dash.xlinkFailGracefully,n,e.h.networkingEngine),qe(e.l,t),t.promise.then((function(t){return function(e,t,n){return g((function i(){var r,o,a,s,u,c,l,d,h,f,p,g,m,v,y,b,w,T,S,E,x,M,I,P;return U(i,(function(i){switch(i.s){case 1:s=de,c=[n],0<(l=(u=Vi).Y(t,"Location").map(u.uc).filter(s.Ra)).length&&(d=he(c,l),c=e.j=d),h=u.Y(t,"BaseURL").map(u.uc),f=he(c,h),p=e.g.dash.ignoreMinBufferTime,g=0,p||(g=u.R(t,"minBufferTime",u.Ma)),e.C=u.R(t,"minimumUpdatePeriod",u.Ma,-1),m=u.R(t,"availabilityStartTime",u.jg),v=u.R(t,"timeShiftBufferDepth",u.Ma),y=u.R(t,"maxSegmentDuration",u.Ma),b=t.getAttribute("type")||"static",w=e.g.dash.ignoreSuggestedPresentationDelay,T=null,w||(T=u.R(t,"suggestedPresentationDelay",u.Ma)),e.i?S=e.i.presentationTimeline:(E=Math.max(e.g.dash.defaultPresentationDelay,1.5*g),S=new wr(m,null!=T?T:E,e.g.dash.autoCorrectDrift));for(var C={zb:"static"!=b,presentationTimeline:S,qa:null,$:null,fa:null,G:null,bandwidth:0,me:!1},R=f,N=Vi.R(t,"mediaPresentationDuration",Vi.Ma),D=[],j=0,_=Vi.Y(t,"Period"),L=0;L<_.length;L++){var U=_[L];j=Vi.R(U,"start",Vi.Ma,j);var O=Vi.R(U,"duration",Vi.Ma),K=null;if(L!=_.length-1){var B=Vi.R(_[L+1],"start",Vi.Ma);null!=B&&(K=B-j)}else null!=N&&(K=N-j);if(B=1/15,K&&O&&Math.abs(K-O)>B&&Y.v("There is a gap/overlap between Periods",U),null==K&&(K=O),U=xr(e,C,R,{start:j,duration:K,node:U,ld:null==K||L==_.length-1}),D.push(U),O=C.qa.id,e.u.includes(O)||(e.u.push(O),e.i&&(e.h.filterNewPeriod(U),e.i.periods.push(U))),null==K){L!=_.length-1&&Y.v("Skipping Period",L+1,"and any subsequent Periods:","Period",L+1,"does not have a valid start time.",D[L+1]),j=null;break}j+=K}if(null==e.i&&e.h.filterAllPeriods(D),null!=N?(j!=N&&Y.v("@mediaPresentationDuration does not match the total duration of all","Periods."),r=D,o=N,a=!1):(r=D,o=j,a=!0),x=o,M=r,S.hc("static"==b),"static"!=b&&a||S.Fa(x||1/0),S.aa()&&!isNaN(e.g.availabilityWindowOverride)&&(v=e.g.availabilityWindowOverride),null==v&&(v=1/0),S.Pd(v),S.ud(y||1),e.i){i.I(0);break}if(e.i={presentationTimeline:S,periods:M,offlineSessionIds:[],minBufferTime:g||0},!S.Pe()){i.I(0);break}return I=u.Y(t,"UTCTiming"),k(i,function(e,t,n){n=n.map((function(e){return{scheme:e.getAttribute("schemeIdUri"),value:e.getAttribute("value")}}));var i=e.g.dash.clockSyncUri;return!n.length&&i&&n.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:i}),de.df(n,function(e){var n=e.scheme;switch(e=e.value,n){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":return Pr(this,t,e,"HEAD");case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":return Pr(this,t,e,"GET");case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":return n=Date.parse(e),isNaN(n)?0:n-Date.now();case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":return Y.ba("NTP UTCTiming scheme is not supported"),Promise.reject();default:return Y.ba("Unrecognized scheme in UTCTiming element",n),Promise.reject()}}.bind(e)).catch((function(){return Y.ba("A UTCTiming element should always be given in live manifests! This content may not play on clients with bad clocks!"),0}))}(e,f,I),4);case 4:if(P=i.B,!e.h)return i.return();S.Ke(P),A(i)}}))}))}(e,t,n)}))}(e,t.data,t.uri)})).then((function(){var n=(Date.now()-t)/1e3;return z(e.F,1,n),n}))}function xr(e,t,n,i){if(t.qa=Ir(i.node,null,n),t.$=i,t.qa.id||(Y.info("No Period ID given for Period with start time "+i.start+",  Assigning a default"),t.qa.id="__shaka_period_"+i.start),Vi.Y(i.node,"EventStream").forEach(e.kg.bind(e,i.start,i.duration)),n=Vi.Y(i.node,"AdaptationSet").map(e.ig.bind(e,t)).filter(de.Ra),t.zb){t=[];for(var r=f(n),o=r.next();!o.done;o=r.next())for(var a=(o=f(o.value.tg)).next();!a.done;a=o.next())t.push(a.value);if(t.length!=new Set(t).size)throw new $(2,4,4018)}var s=n.filter((function(e){return!e.Td}));if(n.filter((function(e){return e.Td})).forEach((function(e){var t=e.Td.split(" ");s.forEach((function(n){t.includes(n.id)&&n.streams.forEach((function(t){t.trickModeVideo=e.streams.find((function(e){return lt(t.codecs)[0]==lt(e.codecs)[0]}))}))}))})),t=kr(s,"video"),r=kr(s,"audio"),!t.length&&!r.length)throw new $(2,4,4004);for(n=e.g.disableAudio,r.length&&!n||(r=[null]),n=e.g.disableVideo,t.length&&!n||(t=[null]),n=[],o=0;o<r.length;o++)for(a=0;a<t.length;a++)Ar(e,r[o],t[a],n);if(t=[],!e.g.disableText)for(e=kr(s,"text"),r=0;r<e.length;r++)t.push.apply(t,e[r].streams);return{startTime:i.start,textStreams:t,variants:n}}function kr(e,t){return e.filter((function(e){return e.contentType==t}))}function Ar(e,t,n,i){if(t||n)if(t&&n){var r=t.drmInfos,o=n.drmInfos;if(!r.length||!o.length||0<Ut(r,o).length){o=Ut(t.drmInfos,n.drmInfos);for(var a=0;a<t.streams.length;a++)for(var s=0;s<n.streams.length;s++)r=(n.streams[s].bandwidth||0)+(t.streams[a].bandwidth||0),r={id:e.m++,language:t.language,primary:t.pd||n.pd,audio:t.streams[a],video:n.streams[s],bandwidth:r,drmInfos:o,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}}else for(o=t||n,a=0;a<o.streams.length;a++)r=o.streams[a].bandwidth||0,r={id:e.m++,language:o.language||"und",primary:o.pd,audio:t?o.streams[a]:null,video:n?o.streams[a]:null,bandwidth:r,drmInfos:o.drmInfos,allowedByApplication:!0,allowedByKeySystem:!0},i.push(r)}function Mr(e,t){0>e.C||e.o.V(Math.max(3,e.C-t,W(e.F)))}function Ir(e,t,n){t=t||{contentType:"",mimeType:"",codecs:"",emsgSchemeIdUris:[],frameRate:void 0,wd:null,audioSamplingRate:null},n=n||t.xa;var i=Vi.Mb,r=Vi.ff,o=Vi.Y(e,"BaseURL").map(Vi.uc),a=e.getAttribute("contentType")||t.contentType,s=e.getAttribute("mimeType")||t.mimeType,u=e.getAttribute("codecs")||t.codecs;r=Vi.R(e,"frameRate",r)||t.frameRate;for(var c=e.getAttribute("sar")||t.pixelAspectRatio,l=Vi.Y(e,"InbandEventStream"),d=t.emsgSchemeIdUris.slice(),h=(l=f(l)).next();!h.done;h=l.next())h=h.value.getAttribute("schemeIdUri"),d.includes(h)||d.push(h);return l=function(e){for(var t=0;t<e.length;++t){var n=e[t],i=n.getAttribute("schemeIdUri");if(i&&(n=n.getAttribute("value")))switch(i){case"urn:mpeg:dash:outputChannelPositionList:2012":return n.trim().split(/ +/).length;case"urn:mpeg:dash:23003:3:audio_channel_configuration:2011":case"urn:dts:dash:audio_channel_configuration:2012":var r=parseInt(n,10);if(!r){Y.v("Channel parsing failure! Ignoring scheme and value",i,n);continue}return r;case"tag:dolby.com,2014:dash:audio_channel_configuration:2011":case"urn:dolby:dash:audio_channel_configuration:2011":if(!(r=parseInt(n,16))){Y.v("Channel parsing failure! Ignoring scheme and value",i,n);continue}for(e=0;r;)1&r&&++e,r>>=1;return e;default:Y.v("Unrecognized audio channel scheme:",i,n)}}return null}(l=Vi.Y(e,"AudioChannelConfiguration"))||t.wd,h=Vi.R(e,"audioSamplingRate",i)||t.audioSamplingRate,a||(a=Cr(s,u)),{xa:he(n,o),ec:Vi.sc(e,"SegmentBase")||t.ec,Ua:Vi.sc(e,"SegmentList")||t.Ua,gc:Vi.sc(e,"SegmentTemplate")||t.gc,width:Vi.R(e,"width",i)||t.width,height:Vi.R(e,"height",i)||t.height,contentType:a,mimeType:s,codecs:u,frameRate:r,pixelAspectRatio:c,emsgSchemeIdUris:d,id:e.getAttribute("id"),wd:l,audioSamplingRate:h}}function Pr(e,t,n,i){return(t=Ye(t=he(t,[n]),e.g.retryParameters)).method=i,t=e.h.networkingEngine.request(4,t),qe(e.l,t),t.promise.then((function(e){if("HEAD"==i){if(!e.headers||!e.headers.date)return Y.v("UTC timing response is missing","expected date header"),0;e=e.headers.date}else e=me(e.data);return e=Date.parse(e),isNaN(e)?(Y.v("Unable to parse date from UTC timing response"),0):e-Date.now()}))}function Cr(e,t){return mn(ut(e,t))?"text":e.split("/")[0]}function Rr(e,t,n,i){this.h=e,this.type=t,this.g=n,this.segments=i||null}function Nr(e,t,n,i){this.id=e,this.name=t,this.g=n,this.value=void 0===i?null:i}function Dr(e,t){this.name=e,this.value=t}function jr(e,t,n){return(e=e.getAttribute(t))?e.value:n||null}function _r(e,t){this.h=t,this.g=e}V("shaka.media.ManifestParser.registerParserByExtension",br.Fd),br.Qb=function(e,t){br.Nb[e]=t},V("shaka.media.ManifestParser.registerParserByMime",br.Qb),br.ng=function(){var e={};if(ht()){for(var t in br.Nb)e[t]=!0;for(var n in br.cc)e[n]=!0}t={mpd:"application/dash+xml",m3u8:"application/x-mpegurl",ism:"application/vnd.ms-sstr+xml"};for(var i=(n=f(["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"])).next();!i.done;i=n.next())e[i=i.value]=ht()?!!br.Nb[i]:ft(i);for(var r in t)e[r]=ht()?!!br.cc[r]:ft(t[r]);return e},br.create=function(e,t,n,i){return g((function r(){var o,a;return U(r,(function(r){switch(r.s){case 1:return M(r,2),k(r,br.rf(e,t,n,i),4);case 4:return o=r.B,r.return(new o);case 2:throw(a=C(r)).severity=2,a}}))}))},br.rf=function(e,t,n,i){return g((function r(){var o,a,s,u,c;return U(r,(function(r){switch(r.s){case 1:if(o=br,i){if(a=o.Nb[i.toLowerCase()])return r.return(a);Y.v("Could not determine manifest type using MIME type ",i)}if(s=o.getExtension(e)){if(u=o.cc[s])return r.return(u);Y.v("Could not determine manifest type for extension ",s)}else Y.v("Could not find extension for ",e);if(i){r.I(2);break}return k(r,o.zf(e,t,n),3);case 3:if(i=r.B){if(c=br.Nb[i])return r.return(c);Y.v("Could not determine manifest type using MIME type",i)}case 2:throw new $(2,4,4e3,e)}}))}))},br.zf=function(e,t,n){return g((function i(){var r,o,a;return U(i,(function(i){switch(i.s){case 1:return(r=Ye([e],n)).method="HEAD",k(i,t.request(0,r).promise,2);case 2:return o=i.B,a=o.headers["content-type"],i.return(a?a.toLowerCase().split(";").shift():"")}}))}))},br.getExtension=function(e){return 1==(e=new Q(e).pa.split("/").pop().split(".")).length?"":e.pop().toLowerCase()},br.isSupported=function(e,t){return!!ht()&&(t in br.Nb||br.getExtension(e)in br.cc)},V("shaka.media.PresentationTimeline",wr),wr.prototype.ha=function(){return this.l},wr.prototype.getDuration=wr.prototype.ha,wr.prototype.xf=function(){return this.g},wr.prototype.getMaxSegmentDuration=wr.prototype.xf,wr.prototype.Fa=function(e){this.l=e},wr.prototype.setDuration=wr.prototype.Fa,wr.prototype.Ff=function(){return this.j},wr.prototype.getPresentationStartTime=wr.prototype.Ff,wr.prototype.Ke=function(e){this.u=e},wr.prototype.setClockOffset=wr.prototype.Ke,wr.prototype.hc=function(e){this.A=e},wr.prototype.setStatic=wr.prototype.hc,wr.prototype.Pd=function(e){this.m=e},wr.prototype.setSegmentAvailabilityDuration=wr.prototype.Pd,wr.prototype.Ag=function(e){this.Ic=e},wr.prototype.setDelay=wr.prototype.Ag,wr.prototype.pf=function(){return this.Ic},wr.prototype.getDelay=wr.prototype.pf,wr.prototype.Jb=function(e,t){if(0!=e.length){var n=e[e.length-1].endTime+t;this.vd(e[0].startTime+t),this.g=e.reduce((function(e,t){return Math.max(e,t.endTime-t.startTime)}),this.g),this.h=Math.max(this.h,n),null!=this.j&&this.C&&(this.j=(Date.now()+this.u)/1e3-this.h-this.g),Y.K("notifySegments:","maxSegmentDuration="+this.g)}},wr.prototype.notifySegments=wr.prototype.Jb,wr.prototype.vd=function(e){this.i=null==this.i?e:Math.min(this.i,e)},wr.prototype.notifyMinSegmentStartTime=wr.prototype.vd,wr.prototype.ud=function(e){this.g=Math.max(this.g,e),Y.K("notifyNewSegmentDuration:","maxSegmentDuration="+this.g)},wr.prototype.notifyMaxSegmentDuration=wr.prototype.ud,wr.prototype.offset=function(e){null!=this.i&&(this.i+=e),null!=this.h&&(this.h+=e)},wr.prototype.offset=wr.prototype.offset,wr.prototype.aa=function(){return 1/0==this.l&&!this.A},wr.prototype.isLive=wr.prototype.aa,wr.prototype.ib=function(){return 1/0!=this.l&&!this.A},wr.prototype.isInProgress=wr.prototype.ib,wr.prototype.$b=function(){if(1/0==this.m)return this.o;var e=this.Db()-this.m;return Math.max(this.o,e)},wr.prototype.getSegmentAvailabilityStart=wr.prototype.$b,wr.prototype.Le=function(e){this.o=e},wr.prototype.setUserSeekStart=wr.prototype.Le,wr.prototype.Db=function(){return this.aa()||this.ib()?Math.min(Math.max(0,(Date.now()+this.u)/1e3-this.g-this.j),this.l):this.l},wr.prototype.getSegmentAvailabilityEnd=wr.prototype.Db,wr.prototype.Zb=function(e){var t=Math.max(this.i,this.o);if(1/0==this.m)return Math.ceil(1e3*t)/1e3;var n=this.Db()-this.m;return e=Math.min(n+e,this.Ka()),Math.max(t,e)},wr.prototype.getSafeSeekRangeStart=wr.prototype.Zb,wr.prototype.Cb=function(){return this.Zb(0)},wr.prototype.getSeekRangeStart=wr.prototype.Cb,wr.prototype.Ka=function(){var e=this.aa()||this.ib()?this.Ic:0;return Math.max(0,this.Db()-e)},wr.prototype.getSeekRangeEnd=wr.prototype.Ka,wr.prototype.Pe=function(){return!(null==this.j||null!=this.h&&this.C)},wr.prototype.usingPresentationStartTime=wr.prototype.Pe,V("shaka.dash.DashParser",Sr),(r=Sr.prototype).configure=function(e){this.g=e},r.start=function(e,t){var n=this;return g((function i(){var r;return U(i,(function(i){switch(i.s){case 1:return n.j=[e],n.h=t,k(i,Er(n),2);case 2:if(r=i.B,n.h&&Mr(n,r),!n.h)throw new $(2,7,7001);return i.return(n.i)}}))}))},r.stop=function(){return this.g=this.h=null,this.j=[],this.i=null,this.u=[],this.A={},null!=this.o&&(this.o.stop(),this.o=null),this.l.destroy()},r.update=function(){Er(this).catch(function(e){this.h&&this.h.onError(e)}.bind(this))},r.onExpirationUpdated=function(){},r.ig=function(e,t){if(e.fa=Ir(t,e.qa,null),"image"==e.fa.contentType)return Y.v("Skipping Image AdaptationSet",e.fa),null;var n=!1,i=Vi.Y(t,"Role"),r=i.map((function(e){return e.getAttribute("value")})).filter(de.Ra),o=void 0,a="text"==e.fa.contentType;a&&(o="subtitle");for(var s=0;s<i.length;s++){var u=i[s].getAttribute("schemeIdUri");if(null==u||"urn:mpeg:dash:role:2011"==u)switch(u=i[s].getAttribute("value"),u){case"main":n=!0;break;case"caption":case"subtitle":o=u}}var c=null,l=!1;Vi.Y(t,"EssentialProperty").forEach((function(e){"http://dashif.org/guidelines/trickmode"==e.getAttribute("schemeIdUri")?c=e.getAttribute("value"):l=!0})),s=Vi.Y(t,"Accessibility");var d=new Map;for(i={},u=(s=f(s)).next();!u.done;i={Vb:i.Vb},u=s.next()){var h=u.value;u=h.getAttribute("schemeIdUri"),h=h.getAttribute("value"),"urn:scte:dash:cc:cea-608:2015"==u||"urn:scte:dash:cc:cea-708:2015"==u?(i.Vb=1,null!=h?h.split(";").forEach(function(e){return function(t){if(t.includes("=")){var n=(t=t.split("="))[0].startsWith("CC")?t[0]:"CC"+t[0];t=t[1].split(",")[0].split(":").pop()}else n="CC"+e.Vb,e.Vb+=2;d.set(n,_n(t))}}(i)):d.set("CC1","und")):"urn:mpeg:dash:role:2011"==u&&null!=h&&(r.push(h),"captions"==h&&(o="caption"))}if(l)return null;var p=qi(i=Vi.Y(t,"ContentProtection"),this.g.dash.customScheme,this.g.dash.ignoreDrmInfo);if(i=_n(t.getAttribute("lang")||"und"),s=t.getAttribute("label"),(u=Vi.Y(t,"Label"))&&u.length&&((u=u[0]).textContent&&(s=u.textContent)),0==(r=(u=Vi.Y(t,"Representation")).map(this.lg.bind(this,e,p,o,i,s,n,r,d)).filter((function(e){return!!e}))).length){if(this.g.dash.ignoreEmptyAdaptationSet||a)return null;throw new $(2,4,4003)}return e.fa.contentType&&"application"!=e.fa.contentType||(e.fa.contentType=Cr(r[0].mimeType,r[0].codecs),r.forEach((function(t){t.type=e.fa.contentType}))),r.forEach((function(e){p.drmInfos.forEach((function(t){e.keyId&&t.keyIds.push(e.keyId)}))})),a=u.map((function(e){return e.getAttribute("id")})).filter(de.Ra),{id:e.fa.id||"__fake__"+this.m++,contentType:e.fa.contentType,language:i,pd:n,streams:r,drmInfos:p.drmInfos,Td:c,tg:a}},r.lg=function(e,t,n,i,r,o,a,s,u){if(e.G=Ir(u,e.fa,null),!function(e){var t=e.ec?1:0;if(t+=e.Ua?1:0,0==(t+=e.gc?1:0))return"text"==e.contentType||"application"==e.contentType||(Y.v("Representation does not contain a segment information source:","the Representation must contain one of SegmentBase, SegmentList,",'SegmentTemplate, or explicitly indicate that it is "text".',e),!1);return 1!=t&&(Y.v("Representation contains multiple segment information sources:","the Representation should only contain one of SegmentBase,","SegmentList, or SegmentTemplate.",e),e.ec?(Y.info("Using SegmentBase by default."),e.Ua=null):Y.info("Using SegmentList by default."),e.gc=null),!0}(e.G))return Y.v("Skipping Representation",e.G),null;e.bandwidth=Vi.R(u,"bandwidth",Vi.Gc)||0;var c=e.G.contentType;c="text"==c||"application"==c;try{var l=this.ug.bind(this);if(e.G.ec)var d=function(e,t){var n=Number(Ji(e,pr,"presentationTimeOffset"))||0,i=Ji(e,pr,"timescale"),r=1;i&&(r=Vi.Gc(i)||1),n=n/r||0,i=hr(e,pr);var o=e.G.contentType;if(r=e.G.mimeType.split("/")[1],"text"!=o&&"mp4"!=r&&"webm"!=r)throw Y.error("SegmentBase specifies an unsupported container type.",e.G),new $(2,4,4006);if("webm"==r&&!i)throw Y.error("SegmentBase does not contain sufficient segment information:","the SegmentBase uses a WebM container,","but does not contain an Initialization element.",e.G),new $(2,4,4005);o=Qi(e,pr,"RepresentationIndex");var a=Ji(e,pr,"indexRange"),s=e.G.xa;if(a=Vi.Hc(a||""),o){var u=o.getAttribute("sourceURL");u&&(s=he(e.G.xa,[u])),a=Vi.R(o,"range",Vi.Hc,a)}if(!a)throw Y.error("SegmentBase does not contain sufficient segment information:","the SegmentBase does not contain @indexRange","or a RepresentationIndex element.",e.G),new $(2,4,4002);return{createSegmentIndex:(r=fr(e,t,i,s,a.start,a.end,r,n)).createSegmentIndex,findSegmentPosition:r.findSegmentPosition,getSegmentReference:r.getSegmentReference,initSegmentReference:i,sa:n}}(e,l);else if(e.G.Ua)d=gr(e,this.A);else if(e.G.gc)d=vr(e,l,this.A,!!this.i);else{var h=e.G.xa,f=e.$.duration||0;d={createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(e){return 0<=e&&e<f?1:null},getSegmentReference:function(e){return 1!=e?null:new tr(1,0,f,(function(){return h}),0,null)},initSegmentReference:null,sa:0}}}catch(e){if(c&&4002==e.code)return null;throw e}return u=function(e,t,n,i){var r=qi(e,t,i);if(n.ge)e=1==n.drmInfos.length&&!n.drmInfos[0].keySystem,t=0==r.drmInfos.length,(0==n.drmInfos.length||e&&!t)&&(n.drmInfos=r.drmInfos),n.ge=!1;else if(0<r.drmInfos.length&&(n.drmInfos=n.drmInfos.filter((function(e){return r.drmInfos.some((function(t){return t.keySystem==e.keySystem}))})),0==n.drmInfos.length))throw new $(2,4,4008);return r.be||n.be}(u=Vi.Y(u,"ContentProtection"),this.g.dash.customScheme,t,this.g.dash.ignoreDrmInfo),{id:this.m++,originalId:e.G.id,createSegmentIndex:d.createSegmentIndex,findSegmentPosition:d.findSegmentPosition,getSegmentReference:d.getSegmentReference,initSegmentReference:d.initSegmentReference,presentationTimeOffset:d.sa,mimeType:e.G.mimeType,codecs:e.G.codecs,frameRate:e.G.frameRate,pixelAspectRatio:e.G.pixelAspectRatio,bandwidth:e.bandwidth,width:e.G.width,height:e.G.height,kind:n,encrypted:0<t.drmInfos.length,keyId:u,language:i,label:r,type:e.fa.contentType,primary:o,trickModeVideo:null,emsgSchemeIdUris:e.G.emsgSchemeIdUris,roles:a,channelsCount:e.G.wd,audioSamplingRate:e.G.audioSamplingRate,closedCaptions:s}},r.kg=function(e,t,n){var i=Vi.Mb,r=n.getAttribute("schemeIdUri")||"",o=n.getAttribute("value")||"",a=Vi.R(n,"timescale",i)||1;Vi.Y(n,"Event").forEach(function(n){var s=Vi.R(n,"presentationTime",i)||0,u=Vi.R(n,"duration",i)||0;u=(s=s/a+e)+u/a,null!=t&&(s=Math.min(s,e+t),u=Math.min(u,e+t)),n={schemeIdUri:r,value:o,startTime:s,endTime:u,id:n.getAttribute("id")||"",eventElement:n},this.h.onTimelineRegionAdded(n)}.bind(this))},r.ug=function(e,t,n){return e=Tr(e,t,n,this.g.retryParameters),e=this.h.networkingEngine.request(1,e),qe(this.l,e),e.promise.then((function(e){return e.data}))},br.Fd("mpd",Sr),br.Qb("application/dash+xml",Sr),br.Qb("video/vnd.mpeg.dash.mpd",Sr),Nr.prototype.toString=function(){var e="#"+this.name,t=this.g?this.g.map((function(e){return e.name+"="+(isNaN(Number(e.value))?'"'+e.value+'"':e.value)})):[];return this.value&&t.unshift(this.value),0<t.length&&(e+=":"+t.join(",")),e},Nr.prototype.getAttribute=function(e){var t=this.g.filter((function(t){return t.name==e}));return t.length?t[0]:null};var Lr={Ab:function(e,t){return e.filter((function(e){return e.name==t}))},cb:function(e,t){var n=Lr.Ab(e,t);return n.length?n[0]:null},Zc:function(e,t,n){return e.filter((function(e){var i=e.getAttribute("TYPE");return e=e.getAttribute("GROUP-ID"),i.value==t&&e.value==n}))},Sc:function(e,t){return he([e],[t])[0]},kd:function(e){return/^#(?!EXT)/m.test(e)}};function Ur(e){this.h=e,this.g=0}function Or(e){Kr(e,/[ \t]+/gm)}function Kr(e,t){t.lastIndex=e.g;var n=t.exec(e.h);return n=null==n?null:{position:n.index,length:n[0].length,wg:n},e.g==e.h.length||null==n||n.position!=e.g?null:(e.g+=n.length,n.wg)}function Br(e){return e.g==e.h.length?null:(e=Kr(e,/[^ \t\n]*/gm))?e[0]:null}function Fr(){this.g=0}function Hr(e,t,n){var i=(t=(t=me(t)).replace(/\r\n|\r(?=[^\n]|$)/gm,"\n").trim()).split(/\n+/m);if(!/^#EXTM3U($|[ \t\n])/m.test(i[0]))throw new $(2,4,4015);t=0;for(var r=1;r<i.length;r++)if(!Lr.kd(i[r])){var o=Gr(e,i[r]);if(--e.g,qr.includes(o.name)){t=1;break}"EXT-X-STREAM-INF"==o.name&&(r+=1)}for(r=[],o=1;o<i.length;)if(Lr.kd(i[o]))o+=1;else{var a=Gr(e,i[o]);if(zr.includes(a.name)){if(1!=t)throw new $(2,4,4017);return new Rr(n,t,r,e=Vr(e,n,i=i.splice(o,i.length-o),r))}r.push(a),o+=1,"EXT-X-STREAM-INF"==a.name&&(a.g.push(new Dr("URI",i[o])),o+=1)}return new Rr(n,t,r)}function Vr(e,t,n,i){var r=[],o=[];return n.forEach((function(n){if(/^(#EXT)/.test(n))n=Gr(e,n),qr.includes(n.name)?i.push(n):o.push(n);else{if(Lr.kd(n))return[];n=Lr.Sc(t,n.trim()),r.push(new _r(n,o)),o=[]}})),r}function Gr(e,t){var n=e.g++,i=t.match(/^#(EXT[^:]*)(?::(.*))?$/);if(!i)throw new $(2,4,4016,t);var r,o=i[1],a=i[2];if(i=[],a){var s;(s=Kr(a=new Ur(a),/^([^,=]+)(?:,|$)/g))&&(r=s[1]);for(var u=/([^=]+)=(?:"([^"]*)"|([^",]*))(?:,|$)/g;s=Kr(a,u);)i.push(new Dr(s[1],s[2]||s[3]))}return new Nr(n,o,i,r)}var qr="EXT-X-TARGETDURATION EXT-X-MEDIA-SEQUENCE EXT-X-DISCONTINUITY-SEQUENCE EXT-X-PLAYLIST-TYPE EXT-X-MAP EXT-X-I-FRAMES-ONLY EXT-X-ENDLIST".split(" "),zr="EXTINF EXT-X-BYTERANGE EXT-X-DISCONTINUITY EXT-X-PROGRAM-DATE-TIME EXT-X-KEY EXT-X-DATERANGE".split(" ");function Wr(e){try{var t=Wr.parse(e);return je({uri:e,Bd:e,data:t.data,headers:{"content-type":t.contentType}})}catch(e){return Ne(e)}}function Xr(){var e=this;this.g=this.j=null,this.ea=1,this.L=new Map,this.Z=new Set,this.h=new Map,this.i=null,this.F="",this.C=new Fr,this.X=0,this.m=new Ie((function(){!function(e){g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return Y.info("Updating manifest..."),e.j?(M(t,2),k(t,e.update(),4)):t.return();case 4:n=e.X,e.m.V(n),P(t,0);break;case 2:if(i=C(t),!e.j)return t.return();i.severity=1,e.j.onError(i),e.m.V(.1),A(t)}}))}))}(e)})),this.l=go,this.A=null,this.J=0,this.M=1/0,this.o=new Ge,this.P=[],this.u=new Map,this.da=!1}function Yr(e,t){return g((function n(){var i,r,o,a,s,u,c,l,d,h;return U(n,(function(n){switch(n.s){case 1:return i=Lr,r=mo,o=t.We,k(n,fo(e,Ye([o],e.g.retryParameters),0),2);case 2:if(a=n.B,1!=(s=Hr(e.C,a.data,a.uri)).type)throw new $(2,4,4017);return c=(u=i.cb(s.g,"EXT-X-MEDIA-SEQUENCE"))?Number(u.value):0,l=t.stream,k(n,io(e,t.Pc,s,c,l.mimeType,l.codecs),3);case 3:d=n.B,t.fc.g=d,h=d[d.length-1],i.cb(s.g,"EXT-X-ENDLIST")&&(ho(e,r.$a),e.i.Fa(h.endTime)),A(n)}}))}))}function $r(e){e.forEach((function(e){if(e){var t=e.stream.codecs.split(",");t=t.filter((function(e){return"mp4a.40.34"!=e})),e.stream.codecs=t.join(",")}}))}function Jr(e,t,n,i,r){return{id:e.ea++,language:t?t.language:"und",primary:!!t&&t.primary||!!n&&n.primary,audio:t,video:n,bandwidth:i,drmInfos:r,allowedByApplication:!0,allowedByKeySystem:!0}}function Qr(e,t,n){return g((function i(){var r,o,a,s,u,c,l,d,h,f,p;return U(i,(function(i){switch(i.s){case 1:if(r=ao(t,"URI"),e.h.has(r))return i.return(e.h.get(r));if(o=ao(t,"TYPE").toLowerCase(),a=pe,"subtitles"==o&&(o=a.za),s=_n(jr(t,"LANGUAGE","und")),u=jr(t,"NAME"),c=t.getAttribute("DEFAULT"),l="YES"==c,d=jr(t,"CHANNELS"),"audio"==o)if(d){var g=d.split("/")[0];g=parseInt(g,10)}else g=null;else g=null;return h=g,f=jr(t,"CHARACTERISTICS"),k(i,Zr(e,r,n,o,s,l,u,h,null,f),2);case 2:return p=i.B,e.h.has(r)?i.return(e.h.get(r)):null==p?i.return(null):(e.L.set(t.id,p),e.h.set(r,p),i.return(p))}}))}))}function Zr(e,t,n,i,r,o,a,s,u,c){return g((function l(){var d,h,p,m,v,y,b,w,T,S,E,x,A,I,R,N,D,j,_,L,O,K,B,F,H,V,G,q;return U(l,(function(l){switch(l.s){case 1:return h=(d=Lr).Sc(e.F,t),k(l,fo(e,Ye([h],e.g.retryParameters),0),2);case 2:if(p=l.B,h=p.uri,1!=(m=Hr(e.C,p.data,h)).type)throw new $(2,4,4017);v=[],m.segments.forEach((function(e){e=d.Ab(e.h,"EXT-X-KEY"),v.push.apply(v,e)})),y=!1,b=[],w=null;for(var z=f(v),W=z.next();!W.done;W=z.next())if(T=W.value,"NONE"!=(S=ao(T,"METHOD"))){if(y=!0,"AES-128"==S)return Y.v("Unsupported HLS Encryption",S),e.da=!0,l.return(null);E=ao(T,"KEYFORMAT"),(A=(x=po[E])?x(T):null)?(A.keyIds.length&&(w=A.keyIds[0]),b.push(A)):Y.v("Unsupported HLS KEYFORMAT",E)}if(y&&!b.length)throw new $(2,4,4026);return function(e,t){var n=mo,i=Lr.cb(t.g,"EXT-X-PLAYLIST-TYPE"),r=Lr.cb(t.g,"EXT-X-ENDLIST");r=i&&"VOD"==i.value||r,i=i&&"EVENT"==i.value&&!r,i=!r&&!i,r?ho(e,n.$a):(ho(e,i?n.Wd:n.Se),n=so(t.g,"EXT-X-TARGETDURATION"),n=Number(n.value),e.J=Math.max(n,e.J),e.M=Math.min(n,e.M))}(e,m),I=function(e,t){if(1==t.length)return t[0];var n=oo(e,t);if(null!=n)return n;throw new $(2,4,4025,t)}(i,n),k(l,function(e,t,n,i){return g((function r(){var o,a,s,u,c,l,d,h,f,p;return U(r,(function(r){switch(r.s){case 1:return o=pe,a=i.segments[0].g,s=new Q(a),u=s.pa.split(".").pop(),c=lo[t],(l=c[u])?r.return(l):t==o.za?n&&"vtt"!=n&&"wvtt"!=n?r.return("application/mp4"):r.return("text/vtt"):((d=Ye([a],e.g.retryParameters)).method="HEAD",k(r,fo(e,d,1),2));case 2:return h=r.B,(f=h.headers["content-type"])?r.return(f.split(";")[0]):(p=c.mp4,r.return(p))}}))}))}(e,i,I,m),3);case 3:return R=l.B,co.includes(R)&&(I=""),D=(N=d.cb(m.g,"EXT-X-MEDIA-SEQUENCE"))?Number(N.value):0,M(l,4),k(l,io(e,t,m,D,R,I),6);case 6:j=l.B,P(l,5);break;case 4:if(4035==(_=C(l)).code)return Y.ba("Skipping unsupported HLS stream",R,t),l.return(null);throw _;case 5:if(L=j[0].startTime,O=j[j.length-1].endTime,K=O-L,B=new ir(j),F=eo(m),H=void 0,"text"==i&&(H="subtitle"),V=[],c)for(W=(z=f(c.split(","))).next();!W.done;W=z.next())G=W.value,V.push(G);return q={id:e.ea++,originalId:a,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:B.find.bind(B),getSegmentReference:B.get.bind(B),initSegmentReference:F,presentationTimeOffset:0,mimeType:R,codecs:I,kind:H,encrypted:y,keyId:w,language:r,label:a,type:i,primary:o,trickModeVideo:null,emsgSchemeIdUris:null,frameRate:void 0,pixelAspectRatio:void 0,width:void 0,height:void 0,bandwidth:void 0,roles:V,channelsCount:s,audioSamplingRate:null,closedCaptions:u},l.return({stream:q,fc:B,drmInfos:b,Pc:t,We:h,td:L,Yg:O,duration:K})}}))}))}function eo(e){var t=Lr.Ab(e.g,"EXT-X-MAP");if(!t.length)return null;if(1<t.length)throw new $(2,4,4020);var n=ao(t=t[0],"URI"),i=Lr.Sc(e.h,n);return e=0,n=null,(t=jr(t,"BYTERANGE"))&&(e=t.split("@"),t=Number(e[0]),n=(e=Number(e[1]))+t-1),new er((function(){return[i]}),e,n)}function to(e,t,n,i){var r=t.h,o=t.g;t=so(r,"EXTINF").value.split(","),t=i+Number(t[0]);var a=0,s=null;return(r=Lr.cb(r,"EXT-X-BYTERANGE"))&&(a=r.value.split("@"),r=Number(a[0]),s=(a=a[1]?Number(a[1]):e.g+1)+r-1),new tr(n,i,t,(function(){return[o]}),a,s)}function no(e){e.i&&(e.P.forEach((function(t){e.i.Jb(t,0)})),e.P=[])}function io(e,t,n,i,r,o){return g((function a(){var s,u,c,l,d,h,f,p,m,v;return U(a,(function(a){switch(a.s){case 1:return s=n.segments,u=[],c=s[0].g,l=to(null,s[0],i,0),d=eo(n),k(a,function(e,t,n,i,r,o){return g((function a(){var s,u,c,l,d,h,f,p,g;return U(a,(function(a){switch(a.s){case 1:if(e.A){if(s=e.h.get(t),u=s.fc,c=u.get(i.position))return Y.K("Found segment start time in previous manifest"),a.return(c.startTime);Y.debug("Unable to find segment start time in previous manifest!")}if(Y.K("Fetching segment to find start time"),r=r.toLowerCase(),co.includes(r))throw Y.ba("Raw formats are not yet supported.  Skipping "+r),new $(1,4,4035);if("video/webm"==r)throw Y.ba("WebM in HLS is not yet supported.  Skipping."),new $(1,4,4035);if("video/mp4"!=r&&"audio/mp4"!=r){a.I(2);break}return l=[ro(e,i)],n&&l.push(ro(e,n)),k(a,Promise.all(l),3);case 3:return d=a.B,h=d[0],f=d[1]||d[0],a.return(function(e,t,n,i){var r=0;if((new _i).box("moov",Li).box("trak",Li).box("mdia",Li).ma("mdhd",(function(e){e.reader.U(0==e.version?8:16),r=e.reader.N(),e.parser.stop()})).parse(i,!0),!r)throw Y.error("Unable to find timescale in init segment!"),new $(2,4,4030,e,t);var o=0,a=!1;if((new _i).box("moof",Li).box("traf",Li).ma("tfdt",(function(e){o=(0==e.version?e.reader.N():e.reader.Pb())/r,a=!0,e.parser.stop()})).parse(n,!0),!a)throw new $(2,4,4030,e,t);return o}(t,h.uri,h.data,f.data));case 2:if("video/mp2t"!=r){a.I(4);break}return k(a,ro(e,i),5);case 5:return p=a.B,a.return(function(e,t,n){function i(){o.seek(a+188),71!=(s=o.ra())&&(o.seek(a+192),s=o.ra()),71!=s&&(o.seek(a+204),s=o.ra()),71!=s&&r(),o.Fe(1)}function r(){throw new $(2,4,4030,e,t)}for(var o=new Ni(new DataView(n),0),a=0,s=0;;)if(a=o.ka(),71!=(s=o.ra())&&r(),8191==(8191&(n=o.dc())))i();else if(16384&n){if(0!=(n=(48&o.ra())>>4)&&2!=n||r(),3==n&&(n=o.ra(),o.U(n)),1==o.N()>>8){o.U(3),0!=(n=o.ra()>>6)&&1!=n||r(),0==o.ra()&&r(),n=o.ra();var u=o.dc(),c=o.dc();return(1073741824*((14&n)>>1)+((65534&u)<<14|(65534&c)>>1))/9e4}i()}else i()}(t,p.uri,p.data));case 4:if("application/mp4"!=r&&!r.startsWith("text/")){a.I(6);break}return k(a,ro(e,i),7);case 7:return g=a.B,a.return(function(e,t,n){return mn(e=ut(e,t))?(vn(t=new pn(null),e),t.xc(n)):0}(r,o,g.data));case 6:throw new $(2,4,4030,t)}}))}))}(e,t,d,l,r,o),2);case 2:h=a.B,Y.debug("First segment",c.split("/").pop(),"starts at",h);for(var y=0;y<s.length;++y)f=s[y],p=u[u.length-1],m=0==y?h:p.endTime,v=to(p,f,i+y,m),u.push(v);return e.P.push(u),no(e),a.return(u)}}))}))}function ro(e,t){return g((function n(){var i,r,o,a,s,u;return U(n,(function(n){switch(n.s){case 1:return i=1,r=Tr(t.i(),t.h,t.h+2048-1,e.g.retryParameters),o=Tr(t.i(),t.h,t.g,e.g.retryParameters),e.g.hls.useFullSegmentsForStartTime?n.return(fo(e,o,i)):(M(n,2),k(n,fo(e,r,i),4));case 4:return a=n.B,n.return(a);case 2:if(7001==(s=C(n)).code)throw s;return Y.ba("Unable to fetch a partial HLS segment! Falling back to a full segment request, which is expensive!  Your server should support Range requests and CORS preflights.",r.uris[0]),k(n,fo(e,o,i),5);case 5:return u=n.B,n.return(u)}}))}))}function oo(e,t){for(var n=uo[e],i=0;i<n.length;i++)for(var r=0;r<t.length;r++)if(n[i].test(t[r].trim()))return t[r].trim();return"text"==e?"":null}function ao(e,t){var n=e.getAttribute(t);if(!n)throw new $(2,4,4023,t);return n.value}function so(e,t){var n=Lr.cb(e,t);if(!n)throw new $(2,4,4024,t);return n}V("shaka.net.DataUriPlugin",Wr),Wr.parse=function(t){var n=t.split(":");if(2>n.length||"data"!=n[0])throw Y.error("Bad data URI, failed to parse scheme"),new $(2,1,1004,t);if(2>(n=n.slice(1).join(":").split(",")).length)throw Y.error("Bad data URI, failed to extract encoding and MIME type"),new $(2,1,1004,t);var i=n[0];t=e.decodeURIComponent(n.slice(1).join(",")),n=i.split(";"),i=n[0];var r=!1;return 1<n.length&&"base64"==n[n.length-1]&&(r=!0,n.pop()),{data:r?Ee.Ja(t).buffer:be(t),contentType:i}},Xe("data",Wr),V("shaka.hls.HlsParser",Xr),(r=Xr.prototype).configure=function(e){this.g=e},r.start=function(e,t){var n=this;return g((function i(){var r,o;return U(i,(function(i){switch(i.s){case 1:return n.j=t,k(i,fo(n,Ye([e],n.g.retryParameters),0),2);case 2:return r=i.B,n.F=r.uri,k(i,function(e,t){return g((function n(){var i,r,o,a,s,u,c,l,d,h,p;return U(n,(function(n){switch(n.s){case 1:if(0!=(i=Hr(e.C,t,e.F)).type)throw new $(2,4,4022);return k(n,function(e,t){return g((function n(){var i,r,o,a,s,u,c,l,d,h,p,m;return U(n,(function(n){switch(n.s){case 1:return i=Lr,r=de,o=t.g,a=i.Ab(t.g,"EXT-X-MEDIA"),s=a.filter(function(e){return"SUBTITLES"==ao(e,"TYPE")}.bind(e)),u=s.map(function(e){var t=this;return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return t.g.disableText?n.return(null):(M(n,2),k(n,function(e,t){return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return ao(t,"TYPE"),k(n,Qr(e,t,[]),2);case 2:return i=n.B,n.return(i.stream)}}))}))}(t,e),4));case 4:return n.return(n.B);case 2:if(i=C(n),t.g.hls.ignoreTextStreamFailures)return n.return(null);throw i}}))}))}.bind(e)),c=a.filter((function(e){return"CLOSED-CAPTIONS"==ao(e,"TYPE")})),function(e,t){for(var n=f(t),i=n.next();!i.done;i=n.next()){ao(i=i.value,"TYPE");var r=jr(i,"LANGUAGE")||"und";r=_n(r);var o=ao(i,"GROUP-ID");i=ao(i,"INSTREAM-ID"),e.u.get(o)||e.u.set(o,new Map),e.u.get(o).set(i,r)}}(e,c),k(n,Promise.all(u),2);case 2:return l=n.B,d=i.Ab(o,"EXT-X-STREAM-INF"),h=d.map(function(e){return function(e,t,n){return g((function i(){var r,o,a,s,u,c,l,d,h,p,m,v,y,b,w,T,S,E,x,A,M,I,P,C,R,N,D,j,_;return U(i,(function(i){switch(i.s){case 1:return r=pe,o=Lr,a=[],e.g.disableVideo||a.push("avc1.42E01E"),e.g.disableAudio||a.push("mp4a.40.2"),s=a.join(","),u=jr(t,"CODECS",s),c=function(e){for(var t=new Set,n=[],i=(e=f(e)).next();!i.done;i=e.next()){var r=lt(i=i.value)[0];t.has(r)?Y.debug("Ignoring duplicate codec"):(n.push(i),t.add(r))}return n}(u.split(/\s*,\s*/)),l=t.getAttribute("RESOLUTION"),h=d=null,p=jr(t,"FRAME-RATE"),m=Number(jr(t,"AVERAGE-BANDWIDTH"))||Number(ao(t,"BANDWIDTH")),l&&(v=l.value.split("x"),d=v[0],h=v[1]),y=(y=(y=o.Ab(n.g,"EXT-X-MEDIA")).filter((function(e){return"CLOSED-CAPTIONS"!=ao(e,"TYPE")}))).filter((function(e){var t=jr(e,"URI")||"";return"SUBTITLES"==(jr(e,"TYPE")||"")||""!=t})),b=jr(t,"AUDIO"),w=jr(t,"VIDEO"),b?y=o.Zc(y,"AUDIO",b):w&&(y=o.Zc(y,"VIDEO",w)),(T=oo(r.za,c))&&((S=jr(t,"SUBTITLES"))&&((E=o.Zc(y,"SUBTITLES",S)).length&&(x=e.L.get(E[0].id))&&(x.stream.codecs=T)),He(c,T)),A=y.map(function(e){return Qr(this,e,c)}.bind(e)),M=[],I=[],k(i,Promise.all(A),2);case 2:if(C=(C=i.B).filter((function(e){return null!=e})),b?M=C:w&&(I=C),Y.debug("Guessing stream type for",t.toString()),N=!1,M.length||I.length?M.length?(j=ao(t,"URI"),_=M[0].Pc,j==_?(Y.debug("Guessing audio-only."),R=r.Sb,N=!0):(Y.debug("Guessing video."),R=r.Za)):(Y.debug("Guessing audio."),R=r.Sb):1==c.length?(D=oo(r.Za,c),l||p||D?(Y.debug("Guessing video-only."),R=r.Za):(Y.debug("Guessing audio-only."),R=r.Sb)):(Y.debug("Guessing multiplexed audio+video."),R=r.Za,c=[c.join(",")]),N){i.I(3);break}return k(i,function(e,t,n,i){return g((function r(){var o,a,s,u,c;return U(r,(function(r){switch(r.s){case 1:return o=pe,a=ao(t,"URI"),e.h.has(a)?r.return(e.h.get(a)):(s=jr(t,"CLOSED-CAPTIONS"),u=null,i==o.Za&&s&&"NONE"!=s&&(u=e.u.get(s)),k(r,Zr(e,a,n,i,"und",!1,null,null,u,null),2));case 2:return null==(c=r.B)?r.return(null):e.h.has(a)?r.return(e.h.get(a)):(e.h.set(a,c),r.return(c))}}))}))}(e,t,c,R),4);case 4:P=i.B;case 3:if(P)P.stream.type==r.Sb?M=[P]:I=[P];else if(null===P)return Y.debug("streamInfo is null"),i.return([]);return I&&$r(I),M&&$r(M),i.return(function(e,t,n,i,r,o,a){n.forEach(function(e){(e=e.stream)&&(e.width=Number(r)||void 0,e.height=Number(o)||void 0,e.frameRate=Number(a)||void 0)}.bind(e));var s=!!e.g&&e.g.disableAudio;t.length&&!s||(t=[null]);s=!!e.g&&e.g.disableVideo,(!n.length||s)&&(n=[null]);s=[];for(var u=(t=f(t)).next();!u.done;u=t.next()){u=u.value;for(var c=f(n),l=c.next();!l.done;l=c.next()){var d=l.value;l=u?u.stream:null;var h=d?d.stream:null,p=u?u.drmInfos:null,g=d?d.drmInfos:null;d=(d?d.Pc:"")+" - "+(u?u.Pc:"");var m=void 0;if(l&&h){if(p.length&&g.length&&!(0<Ut(p,g).length)){Y.v("Incompatible DRM info in HLS variant.  Skipping.");continue}m=Ut(p,g)}else l?m=p:h&&(m=g);e.Z.has(d)?Y.debug("Skipping variant which only differs in text streams."):(l=Jr(e,l,h,i,m),s.push(l),e.Z.add(d))}}return s}(e,M,I,m,d,h,p))}}))}))}(this,e,t)}.bind(e)),k(n,Promise.all(h),3);case 3:return p=n.B,m=(m=p.reduce(r.Rc,[])).filter((function(e){return null!=e})),n.return({startTime:0,variants:m,textStreams:l.filter((function(e){return null!=e}))})}}))}))}(e,i),2);case 2:if(r=n.B,!e.j)throw new $(2,7,7001);if(e.da&&0==r.variants.length)throw Y.info("No stream is created, because we don't support AES-128","encryption yet"),new $(2,4,4034);e.j.filterAllPeriods([r]),o=1/0,a=0,s=1/0;for(var m=f(e.h.values()),v=m.next();!v.done;v=m.next())u=v.value,o=Math.min(o,u.td),a=Math.max(a,u.td),"text"!=u.stream.type&&(s=Math.min(s,u.duration));if(e.l!=mo.$a?(e.i=new wr(0,3*e.J),e.i.hc(!1)):(e.i=new wr(null,0),e.i.hc(!0)),no(e),e.l!=mo.$a){for(e.X=e.M,c=mo,e.l==c.Wd&&(l=e.i.Ic,isNaN(e.g.availabilityWindowOverride)||(l=e.g.availabilityWindowOverride),e.i.Pd(l)),d=0;95443.7176888889<=a;)d+=95443.7176888889,a-=95443.7176888889;if(d)for(Y.debug("Offsetting live streams by",d,"to compensate for rollover"),v=(m=f(e.h.values())).next();!v.done;v=m.next())95443.7176888889>(h=v.value).td?(Y.K("Offset applied to",h.stream.type),h.stream.presentationTimeOffset=-d,h.fc.offset(d)):Y.K("Offset NOT applied to",h.stream.type)}else for(e.i.Fa(s),e.i.offset(-o),v=(m=f(e.h.values())).next();!v.done;v=m.next())(p=v.value).stream.presentationTimeOffset=o,p.fc.offset(-o),rr(p.fc,s);e.A={presentationTimeline:e.i,periods:[r],offlineSessionIds:[],minBufferTime:0},A(n)}}))}))}(n,r.data),3);case 3:return 0<(o=n.X)&&n.m.V(o),i.return(n.A)}}))}))},r.stop=function(){this.m&&(this.m.stop(),this.m=null);var e=[];return this.o&&(e.push(this.o.destroy()),this.o=null),this.g=this.j=null,this.L.clear(),this.Z.clear(),this.h.clear(),this.A=null,Promise.all(e)},r.update=function(){if(this.l!=mo.$a){for(var e=[],t=f(this.h.values()),n=t.next();!n.done;n=t.next())e.push(Yr(this,n.value));return Promise.all(e)}},r.onExpirationUpdated=function(){};var uo={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/],text:[/^vtt$/,/^wvtt/,/^stpp/]},co=["audio/aac","audio/ac3","audio/ec3","audio/mpeg"],lo={audio:{mp4:"audio/mp4",mp4a:"audio/mp4",m4s:"audio/mp4",m4i:"audio/mp4",m4a:"audio/mp4",m4f:"audio/mp4",cmfa:"audio/mp4",ts:"video/mp2t",aac:"audio/aac",ac3:"audio/ac3",ec3:"audio/ec3",mp3:"audio/mpeg"},video:{mp4:"video/mp4",mp4v:"video/mp4",m4s:"video/mp4",m4i:"video/mp4",m4v:"video/mp4",m4f:"video/mp4",cmfv:"video/mp4",ts:"video/mp2t"},text:{mp4:"application/mp4",m4s:"application/mp4",m4i:"application/mp4",m4f:"application/mp4",cmft:"application/mp4",vtt:"text/vtt",ttml:"application/ttml+xml"}};function ho(e,t){e.l=t,e.i&&e.i.hc(e.l==mo.$a),e.l!=mo.$a||e.m.stop()}function fo(e,t,n){if(!e.o)throw new $(2,7,7001);return t=e.j.networkingEngine.request(n,t),qe(e.o,t),t.promise}var po={"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":function(e){var t=ao(e,"METHOD");Vn("HLS SAMPLE-AES-CENC","SAMPLE-AES-CENC will no longer be supported, see Issue #1227");var n=["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"];return n.includes(t)?(t=ao(e,"URI"),t=Wr.parse(t),t=fe("com.widevine.alpha",[{initDataType:"cenc",initData:t=new Uint8Array(t.data)}]),(e=jr(e,"KEYID"))&&(t.keyIds=[e.toLowerCase().substr(2)]),t):(Y.error("Widevine in HLS is only supported with [",n.join(", "),"], not",t),null)}},go="VOD",mo={$a:go,Se:"EVENT",Wd:"LIVE"};function vo(){this.g=new Map}function yo(e,t,n){bo(e,t).text=n}function bo(e,t){return e.g.has(t)||e.g.set(t,new wo),e.g.get(t)}function wo(){this.text=this.variant=null}function To(e,t){this.g=e,this.h=new Set([e]);for(var n=f(t=t||[]),i=n.next();!i.done;i=n.next())this.add(i.value)}function So(e,t){var n;if(!(n=!!e.audio!=!!t.audio||!!e.video!=!!t.video||e.language!=t.language)&&(n=e.audio&&t.audio)){n=e.audio;var i=t.audio;n=!(n.channelsCount==i.channelsCount&&Eo(n,i)&&xo(n.roles,i.roles))}return!n&&(n=e.video&&t.video)&&(n=!(Eo(n=e.video,i=t.video)&&xo(n.roles,i.roles))),!n}function Eo(e,t){if(e.mimeType!=t.mimeType)return!1;var n=e.codecs.split(",").map((function(e){return lt(e)[0]})),i=t.codecs.split(",").map((function(e){return lt(e)[0]}));if(n.length!=i.length)return!1;n.sort(),i.sort();for(var r=0;r<n.length;r++)if(n[r]!=i[r])return!1;return!0}function xo(e,t){var n=new Set(e),i=new Set(t);if(n.delete("main"),i.delete("main"),n.size!=i.size)return!1;for(var r=(n=f(n)).next();!r.done;r=n.next())if(!i.has(r.value))return!1;return!0}function ko(e){this.g=e,this.h=new Ao(e.language,"",e.audio&&e.audio.channelsCount?e.audio.channelsCount:0,"")}function Ao(e,t,n,i){this.i=e,this.j=t,this.g=n,this.h=void 0===i?"":i}function Mo(){this.g=Co,this.h=(new Map).set(Co,2).set(Po,1)}function Io(e,t,n){e.h.set(Co,n).set(Po,t)}br.Fd("m3u8",Xr),br.Qb("application/x-mpegurl",Xr),br.Qb("application/vnd.apple.mpegurl",Xr),To.prototype.add=function(e){return So(this.g,e)?(this.h.add(e),!0):(Y.v("Rejecting variant - not compatible with root."),!1)},To.prototype.values=function(){return this.h.values()},ko.prototype.create=function(e){var t=this,n=e.filter((function(e){return So(t.g,e)}));return n.length?new To(n[0],n):this.h.create(e)},Ao.prototype.create=function(e){var t=[];t=function(e,t){var n=Un(_n(t),e.map((function(e){return Ln(e)})));return n?e.filter((function(e){return n==Ln(e)})):[]}(e,this.i);var n=e.filter((function(e){return e.primary}));for((e=function(e,t){return e.filter((function(e){return!!e.audio&&(t?e.audio.roles.includes(t):0==e.audio.roles.length)}))}(t=t.length?t:n.length?n:e,this.j)).length?t=e:Y.v("No exact match for variant role could be found."),this.g&&((e=Kn.ee(t,this.g)).length?t=e:Y.v("No exact match for the channel count could be found.")),this.h&&((e=function(e,t){return e.filter((function(e){return!!e.audio&&e.audio.label.toLowerCase()==t.toLowerCase()}))}(t,this.h)).length?t=e:Y.v("No exact match for variant label could be found.")),e=new To(t[0]),n=(t=f(t)).next();!n.done;n=t.next())n=n.value,So(e.g,n)&&e.add(n);return e};var Po=0,Co=1;function Ro(e,t){this.l=e,this.m=Do(e),this.g=e.g.currentTime,this.j=Date.now()/1e3,this.h=!1,this.o=t,this.i=function(){}}function No(e){this.g=e}function Do(e){if(e.g.paused||0==e.g.playbackRate||0==e.g.buffered.length)var t=!1;else e:{t=e.g.buffered,e=e.g.currentTime;for(var n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(!(e<i-.1||e>r-.5)){t=!0;break e}}t=!1}return t}function jo(e,t,n,i,r){var o=this;this.g=e,this.F=t,this.C=n,this.u=r,this.j=new Ze,this.o=!1,this.A=e.readyState,this.i=!1,this.h=i,this.m=!1,this.j.H(e,"waiting",(function(){return _o(o)})),this.l=new Ie((function(){_o(o)})).Oa(.25)}function _o(e){if(0!=e.g.readyState){if(e.g.seeking){if(!e.o)return}else e.o=!1;if(!e.g.paused||0==e.g.currentTime){var t;if(e.g.readyState!=e.A&&(e.i=!1,e.A=e.g.readyState),!(t=!e.h)){var n=(t=e.h).l,i=Do(n),r=n.g.currentTime,o=Date.now()/1e3;t.g==r&&t.m==i||(t.j=o,t.g=r,t.m=i,t.h=!1),(i=(r=o-t.j)>=t.o&&i&&!t.h)&&(t.i(t.g,r),t.h=!0,t.g=n.g.currentTime),t=!i}if(t){o=e.C.smallGapLimit,t=e.g.currentTime;e:{if((n=e.g.buffered)&&n.length&&!(1==n.length&&1e-6>n.end(0)-n.start(0)))for(i=navigator.userAgent.match(/Edge\//)||vt("Trident/")||pt()||vt("CrKey")?.5:.1,r=0;r<n.length;r++)if(n.start(r)>t&&(0==r||n.end(r-1)-t<=i)){i=r;break e}i=null}if(null!=i&&(0!=i||e.m)){r=n.start(i);var a=e.F.Ka();if(!(r>=a)){o=(a=r-t)<=o;var s=!1;if(!(.001>a)){if(!o&&!e.i){e.i=!0;var u=new Ue("largegap",{currentTime:t,gapSize:a});u.cancelable=!0,e.u(u),e.C.jumpLargeGaps&&!u.defaultPrevented?s=!0:Y.info("Ignoring large gap at",t,"size",a)}(o||s)&&(0==i?Y.info("Jumping forward",a,"seconds because of gap before start time of",r):Y.info("Jumping forward",a,"seconds because of gap starting at",n.end(i-1),"and ending at",r),e.g.currentTime=r)}}}}}}}function Lo(e){var t=this;this.i=e,this.g=new Set,this.h=new Ie((function(){Uo(t,!1)})).Oa(.25)}function Uo(e,t){for(var n=f(e.g),i=n.next();!i.done;i=n.next())i.value.l(e.i.currentTime,t)}function Oo(e){for(var t=[],n=(e=f(e)).next();!n.done;n=e.next())for(var i=(n=f(n.value.variants)).next();!i.done;i=n.next())t.push(i.value);return t}function Ko(e,t){for(var n=null,i=f(e),r=i.next();!r.done;r=i.next())t>=(r=r.value).startTime&&(n=r);return n}function Bo(e){this.i=e,this.g=null,this.h=function(){}}function Fo(e){var t=this;this.g=e,this.j=!1,this.i=this.g.wc(),this.h=new Ie((function(){t.g.pe(.25*t.i)}))}function Ho(e){e.h.stop();var t=e.j?0:e.i;if(0<=t)try{return void(e.g.wc()!=t&&e.g.Od(t))}catch(e){}e.h.Oa(.25),0!=e.g.wc()&&e.g.Od(0)}function Vo(e,t,n,i){t==HTMLMediaElement.HAVE_NOTHING||e.readyState>=t?i():(t=Go.get(t),n.ya(e,t,i))}Ro.prototype.release=function(){this.l=null,this.i=function(){}},jo.prototype.release=function(){this.j&&(this.j.release(),this.j=null),null!=this.l&&(this.l.stop(),this.l=null),this.h&&(this.h.release(),this.h=null),this.g=this.F=this.u=null},jo.prototype.zd=function(){this.m=!0,_o(this)},Lo.prototype.release=function(){this.h.stop();for(var e=f(this.g),t=e.next();!t.done;t=e.next())t.value.release();this.g.clear()},Bo.prototype.release=function(){this.g=this.i=null,this.h=function(){}},Bo.prototype.l=function(e){var t=this.g,n=this.i.periods;t!=(e=Ko(n,e)||n[0])&&this.h(e),this.g=e},Fo.prototype.release=function(){this.h&&(this.h.stop(),this.h=null),this.g=null},Fo.prototype.set=function(e){this.i=e,Ho(this)},Fo.prototype.vc=function(){return this.g.vc()};var Go=new Map([[HTMLMediaElement.HAVE_METADATA,"loadedmetadata"],[HTMLMediaElement.HAVE_CURRENT_DATA,"loadeddata"],[HTMLMediaElement.HAVE_FUTURE_DATA,"canplay"],[HTMLMediaElement.HAVE_ENOUGH_DATA,"canplaythrough"]]);function qo(e,t,n){var i=this;this.g=e,this.l=t,this.j=n,this.m=!1,this.h=new Ze,this.i=new $o(e),Vo(this.g,HTMLMediaElement.HAVE_METADATA,this.h,(function(){Xo(i,i.j)}))}function zo(e){return e.m?e.g.currentTime:e.j}function Wo(e,t){0<e.g.readyState?Jo(e.i,t):Vo(e.g,HTMLMediaElement.HAVE_METADATA,e.h,(function(){Xo(e,e.j)}))}function Xo(e,t){.001>Math.abs(e.g.currentTime-t)?Yo(e):(e.h.ya(e.g,"seeking",(function(){Yo(e)})),Jo(e.i,0==e.g.currentTime?t:e.g.currentTime))}function Yo(e){e.m=!0,e.h.H(e.g,"seeking",(function(){return e.l()}))}function $o(e){var t=this;this.h=e,this.m=10,this.l=this.i=this.j=0,this.g=new Ie((function(){0>=t.j?(Y.v(["Failed to move playhead from",t.i,"to",t.l].join(" ")),t.g.stop()):t.h.currentTime!=t.i?t.g.stop():(t.h.currentTime=t.l,t.j--)}))}function Jo(e,t){e.i=e.h.currentTime,e.l=t,e.j=e.m,e.h.currentTime=t,e.g.Oa(.1)}function Qo(e){var t=this;this.g=e,this.j=!1,this.i=null,this.h=new Ze,Vo(this.g,HTMLMediaElement.HAVE_CURRENT_DATA,this.h,(function(){null==t.i?t.j=!0:(t.h.ya(t.g,"seeking",(function(){t.j=!0})),t.g.currentTime=Math.max(0,t.g.currentTime+t.i))}))}function Zo(e,t,n,i,r,o){var a=this;this.i=e,this.g=t.presentationTimeline,this.J=t.minBufferTime||0,this.m=n,this.F=r,this.u=null,this.j=new jo(e,t.presentationTimeline,n,function(e,t){if(!t.stallEnabled)return null;var n=t.stallSkip,i=new Ro(new No(e),t.stallThreshold);return function(e,t){e.i=t}(i,(function(t,i){Y.debug("Stall detected at "+t+" for "+i+" seconds."),n?(Y.debug("Seeking forward "+n+" seconds to break stall."),e.currentTime+=n):(Y.debug("Pausing and unpausing to break stall."),e.pause(),e.play())})),i}(e,n),o),this.h=new qo(e,(function(){e:{var e=a.j;e.o=!0,e.m=!1,e.i=!1,e=zo(a.h);var t=ta(a,e);if(.001<Math.abs(t-e)){var n=Date.now()/1e3;if(!a.u||a.u<n-1){a.u=n,Wo(a.h,t),e=void 0;break e}}Y.K("Seek to "+e),a.F(),e=void 0}return e}),function(e,t){return null==t?t=1/0>e.g.ha()?e.g.Cb():e.g.Ka():0>t&&(t=e.g.Ka()+t),ea(e,na(e,t))}(this,i)),this.o=new Ie((function(){if(0!=a.i.readyState&&!a.i.paused){var e=zo(a.h),t=a.g.Cb(),n=a.g.Ka();3>n-t&&(t=n-3),e<t&&(t=ta(a,e),Y.info("Jumping forward "+(t-e)+" seconds to catch up with the seek range."),a.i.currentTime=t)}})).Oa(.25)}function ea(e,t){var n=e.g.ha();return t>=n?n-e.m.durationBackoff:t}function ta(e,t){var n=Wt.bind(null,e.i.buffered),i=Math.max(e.J,e.m.rebufferingGoal),r=e.m.safeSeekOffset,o=e.g.Cb(),a=e.g.Ka(),s=e.g.ha();3>a-o&&(o=a-3);var u=e.g.Zb(i),c=e.g.Zb(r);return i=e.g.Zb(i+r),t>=s?(Y.K("Playhead past duration."),ea(e,t)):t>a?(Y.K("Playhead past end."),a):t<o?n(c)?(Y.K("Playhead before start & start is buffered"),c):(Y.K("Playhead before start & start is unbuffered"),i):t>=u||n(t)?(Y.K("Playhead in safe region or in buffered region."),t):(Y.K("Playhead outside safe region & in unbuffered region."),i)}function na(e,t){var n=e.g.Cb();return t<n||t>(n=e.g.Ka())?n:t}function ia(e){var t=this;this.h=function(){},this.g=new Set,this.j=e,this.i=new Ie((function(){for(var e=t.j(),n=f(t.g),i=n.next();!i.done;i=n.next())(i=i.value).endTime<e.start&&t.g.delete(i)})).Oa(2)}function ra(e){var t=this;this.m=e,this.j=new Map,this.g=function(){},this.h=function(){},this.i=function(){},this.o=[{rb:null,qb:aa,hb:function(e,n){return t.g(e,n)}},{rb:oa,qb:aa,hb:function(e,n){return t.g(e,n)}},{rb:sa,qb:aa,hb:function(e,n){return t.g(e,n)}},{rb:aa,qb:oa,hb:function(e,n){return t.h(e,n)}},{rb:aa,qb:sa,hb:function(e,n){return t.h(e,n)}},{rb:oa,qb:sa,hb:function(e,n){return t.i(e,n)}},{rb:sa,qb:oa,hb:function(e,n){return t.i(e,n)}}]}qo.prototype.release=function(){this.h&&(this.h.release(),this.h=null),null!=this.i&&(this.i.release(),this.i=null),this.l=function(){},this.g=null},$o.prototype.release=function(){this.g&&(this.g.stop(),this.g=null),this.h=null},Qo.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.g=null},Qo.prototype.A=function(e){this.i=this.j?this.i:e},Qo.prototype.l=function(){return(this.j?this.g.currentTime:this.i)||0},Qo.prototype.C=function(){},Zo.prototype.release=function(){this.h&&(this.h.release(),this.h=null),this.j&&(this.j.release(),this.j=null),this.o&&(this.o.stop(),this.o=null),this.i=this.h=this.g=this.m=null,this.F=function(){}},Zo.prototype.A=function(e){Wo(this.h,e)},Zo.prototype.l=function(){var e=zo(this.h);return 0<this.i.readyState&&!this.i.paused?na(this,e):e},Zo.prototype.C=function(){this.j.zd()},ia.prototype.release=function(){this.h=function(){},this.g.clear(),this.i.stop()},ra.prototype.release=function(){this.m=null,this.j.clear(),this.g=function(){},this.h=function(){},this.i=function(){}},ra.prototype.l=function(e,t){for(var n=f(this.m.g),i=n.next();!i.done;i=n.next()){i=i.value;var r=this.j.get(i),o=e<i.startTime?oa:e>i.endTime?sa:aa;this.j.set(i,o);for(var a=f(this.o),s=a.next();!s.done;s=a.next())(s=s.value).rb==r&&s.qb==o&&s.hb(i,t)}};var oa=1,aa=2,sa=3;function ua(e,t){this.g=t,this.i=e,this.l=null,this.u=1,this.F=Promise.resolve(),this.m=[],this.o=new Map,this.h=new Map,this.C=!1,this.M=null,this.L=this.j=this.A=!1,this.J=0}function ca(e){return da(e,"audio")}function la(e){return da(e,"video")}function da(e,t){var n=e.h.get(t);return n?n.Ta||n.stream:null}function ha(e,t){return g((function n(){var i,r,o,a,s,u,c,l,d;return U(n,(function(n){switch(n.s){case 1:return i=pe,k(n,Pn(e.g.T,i.za),2);case 2:return e.J++,e.L=!1,r=e.J,o=e.g.T,a=new Map,s=new Set,a.set(i.za,t),s.add(t),k(n,o.init(a,!1),3);case 3:return e.j?n.return():k(n,wa(e,s),4);case 4:if(e.j)return n.return();u=e.g.T.l.isTextVisible()||e.l.alwaysStreamText,e.J!=r||e.h.has(i.za)||e.L||!u||(c=e.g.eb(),l=Ia(e,c),d=ya(t,l,0),e.h.set(i.za,d),Na(e,d,0)),A(n)}}))}))}function fa(e,t){var n=e.h.get("video");if(n){var i=n.stream;if(i)if(Y.debug("setTrickPlay",t),t){var r=i.trickModeVideo;r&&!n.Ta&&(Y.debug("Engaging trick mode stream",r),ga(e,r,!1,0,!1),n.Ta=i)}else(i=n.Ta)&&(Y.debug("Restoring non-trick-mode stream",i),n.Ta=null,ga(e,i,!0,0,!1))}}function pa(e,t,n,i){var r=!1;if(t.video){var o=ga(e,t.video,n,i,!1);r=r||o}return t.audio&&(e=ga(e,t.audio,n,i,!1),r=r||e),r}function ga(e,t,n,i,r){var o=e.h.get(t.type);if(!o&&"text"==t.type&&e.l.ignoreTextStreamFailures)return ha(e,t),!0;if(!o)return!1;var a=Pa(e,t),s=Array.from(e.h.values()).every((function(e){return e.oa==o.oa}));return n&&a!=o.oa&&s?(Y.debug("switch: switching to stream in another Period; clearing buffer and changing Periods"),e.h.forEach((function(t){ma(e,t)})),!0):(o.Ta&&(Y.debug("switch during trick play mode",t),t.trickModeVideo?(o.Ta=t,t=t.trickModeVideo,Y.debug("switch found trick play stream",t)):(o.Ta=null,Y.debug("switch found no special trick play stream"))),!(!(s=e.m[a])||!s.Rb)&&(!(!(s=e.o.get(t.id))||!s.Rb)&&(o.stream!=t||r?("text"==t.type&&Sn(e.g.T,ut(t.mimeType,t.codecs)),o.stream=t,o.Ac=!0,Y.debug("switch: switching to Stream "+La(o)),function(e,t,n){if(!t.lb)return!1;var i=e.g.eb(),r=kn(e.g.T,t.type),o=Ea(e,t,i,r,n);return n=o&&o.g?o.g-o.h:null,o&&!n&&(n=(o.endTime-o.xc())*t.stream.bandwidth/8),!isNaN(n)&&((o=t.stream.initSegmentReference)&&(n+=(o.g?o.g-o.h:null)||0),o=e.g.getBandwidthEstimate(),8*n/o<r-i-Math.max(e.i.minBufferTime||0,e.l.rebufferingGoal)||t.lb.h.g>n)}(e,o,a)&&(Y.info("Aborting current segment request to switch."),o.lb.abort()),n&&(o.ab?o.Qc=!0:o.Sa?(o.Wa=!0,o.oc=i,o.Qc=!0):(Da(o),Ra(e,o,!0,i).catch((function(t){e.g&&e.g.onError(t)})))),!0):(Y.debug("switch: Stream "+La(o)+" already active"),!1))))}function ma(e,t){var n=La(t);t.ab?Y.debug(n,"clear: already clearing the buffer"):t.Wa?Y.debug(n,"clear: already waiting"):t.Sa?(Y.debug(n,"clear: currently updating"),t.Wa=!0,t.oc=0):null==xn(e.g.T,t.type)?(Y.debug(n,"clear: nothing buffered"),null==t.Pa&&Na(e,t,0)):(Y.debug(n,"clear: handling right now"),Da(t),Ra(e,t,!1,0).catch((function(t){e.g&&e.g.onError(t)})))}function va(e,t,n,i,r){return g((function o(){var a,s,u,c,l,d,h;return U(o,(function(o){switch(o.s){case 1:return a=e.g.eb(),s=Ia(e,a),u=pe,c=new Map,l=new Set,t&&(c.set(u.Sb,t),l.add(t)),n&&(c.set(u.Za,n),l.add(n)),i&&(c.set(u.za,i),l.add(i)),d=e.g.T,h=e.l.forceTransmuxTS,k(o,d.init(c,h),2);case 2:return e.j?o.return():(function(e){var t=e.i.presentationTimeline.ha();1/0>t?e.g.T.Fa(t):e.g.T.Fa(Math.pow(2,32))}(e),k(o,wa(e,l),3));case 3:if(e.j)return o.return();c.forEach((function(t,n){if(!e.h.has(n)){var i=ya(t,s,r);e.h.set(n,i),Na(e,i,0)}})),A(o)}}))}))}function ya(e,t,n){return{stream:e,type:e.type,Hb:null,La:null,Ta:null,Ac:!0,oa:t,endOfStream:!1,Sa:!1,Pa:null,Wa:!1,oc:0,Qc:!1,ab:!1,Ed:!1,ac:!1,Hd:n||0,lb:null}}function ba(e,t){var n=e.m[t];if(n)return Y.debug("(all) Period "+t+" is being or has been set up"),n.promise;Y.debug("(all) setting up Period "+t),n={promise:new ge,Rb:!1},e.m[t]=n;for(var i=new Set,r=f(e.i.periods[t].variants),o=r.next();!o.done;o=r.next())(o=o.value).video&&i.add(o.video),o.video&&o.video.trickModeVideo&&i.add(o.video.trickModeVideo),o.audio&&i.add(o.audio);for(o=(r=f(e.i.periods[t].textStreams)).next();!o.done;o=r.next())i.add(o.value);return e.F=e.F.then(function(){if(!this.j)return wa(this,i)}.bind(e)).then(function(){this.j||(this.m[t].promise.resolve(),this.m[t].Rb=!0,Y.K("(all) setup Period "+t))}.bind(e)).catch(function(e){this.j||(this.m[t].promise.catch((function(){})),this.m[t].promise.reject(),delete this.m[t],Y.v("(all) failed to setup Period "+t),this.g.onError(e))}.bind(e)),n.promise}function wa(e,t){return g((function n(){var i,r,o,a,s,u,c;return U(n,(function(n){switch(n.s){case 1:i=[];for(var l=f(t),d=l.next();!d.done;d=l.next())r=d.value,(o=e.o.get(r.id))?(Y.debug("(all) Stream "+r.id+" is being or has been set up"),i.push(o.promise)):(Y.K("(all) setting up Stream "+r.id),e.o.set(r.id,{promise:new ge,Rb:!1}),i.push(r.createSegmentIndex()));return M(n,2),k(n,Promise.all(i),4);case 4:if(e.j)return n.return();P(n,3);break;case 2:if(a=C(n),e.j)return n.return();for(d=(n=f(t)).next();!d.done;d=n.next())s=d.value,e.o.get(s.id).promise.catch((function(){})),e.o.get(s.id).promise.reject(),e.o.delete(s.id);throw a;case 3:for(d=(l=f(t)).next();!d.done;d=l.next())u=d.value,(c=e.o.get(u.id)).Rb||(c.promise.resolve(),c.Rb=!0,Y.K("(all) setup Stream "+u.id));A(n)}}))}))}function Ta(e,t){if(!e.j){var n=La(t);if(!t.Sa&&null!=t.Pa&&!t.ab)if(t.Pa=null,t.Wa)Y.debug(n,"skipping update and clearing the buffer"),Ra(e,t,t.Qc,t.oc);else{try{var i=function(e,t){if(Aa(t))return In(e.g.T,t.stream.originalId||""),null;var n=La(t),i=e.g.eb(),r=Sa(e,t,i);Y.O(n,"timeNeeded="+r);var o=Pa(e,t.stream),a=Ia(e,r),s=function(e,t,n){return"text"==t?null==(e=e.g).h||e.h<n?0:e.h-Math.max(n,e.g):Xt(e=An(e,t),n)}(e.g.T,t.type,i);Y.O(n,"update_:","presentationTime="+i,"bufferedAhead="+s);var u=Math.max(e.i.minBufferTime||0,e.l.rebufferingGoal,e.l.bufferingGoal)*e.u;if(r>=e.i.presentationTimeline.ha())return Y.debug(n,"buffered to end of presentation"),t.endOfStream=!0,"video"==t.type&&(r=e.h.get("text"))&&"application/cea-608"==r.stream.mimeType&&(r.endOfStream=!0),null;if(t.endOfStream=!1,t.oa=a,a!=o)return Y.debug(n,"need Period "+a,"presentationTime="+i,"timeNeeded="+r,"currentPeriodIndex="+o),null;if(s>=u)return Y.O(n,"buffering goal met"),.5;if(n=kn(e.g.T,t.type),!(n=Ea(e,t,i,n,o)))return 1;var c=1/0;return Array.from(e.h.values()).forEach((function(t){Aa(t)||(t=Sa(e,t,i),c=Math.min(c,t))})),r>=c+e.i.presentationTimeline.g?1:(t.Hd=0,function(e,t,n,i,r){var o=La(t),a=e.i.periods[i];Y.K(o,"fetchAndAppend_:","presentationTime="+n,"currentPeriod.startTime="+a.startTime,"reference.position="+r.position,"reference.startTime="+r.startTime,"reference.endTime="+r.endTime);var s=t.stream,u=e.i.presentationTimeline.ha(),c=e.i.periods[i+1];i=function(e,t,n,i,r){if(!t.Ac)return Promise.resolve();var o=La(t);return n=e.i.periods[n].startTime-t.stream.presentationTimeOffset,Y.K(o,"setting timestamp offset to "+n),Y.K(o,"setting append window start to "+i),Y.K(o,"setting append window end to "+r),i=function(e,t,n,i,r){return"text"==t?(e.g.A=n,(e=e.g).j=i,e.m=r,Promise.resolve()):Promise.all([Cn(e,t,e.Ve.bind(e,t)),Cn(e,t,e.Cg.bind(e,t,n)),Cn(e,t,e.zg.bind(e,t,i,r))])}(e.g.T,t.type,n,i,r),t.stream.initSegmentReference?(Y.K(o,"fetching init segment"),e=Ca(e,t,t.stream.initSegmentReference).then(function(e){if(!this.j)return Y.K(o,"appending init segment"),Mn(this.g.T,t.type,e,null,null,t.stream.closedCaptions&&0<t.stream.closedCaptions.size)}.bind(e)).catch((function(e){return t.Ac=!0,Promise.reject(e)})),Promise.all([i,e])):i}(e,t,i,Math.max(0,a.startTime-.1),c?c.startTime+.01:u),t.Sa=!0,t.Ac=!1,Y.O(o,"fetching segment"),u=Ca(e,t,r),Promise.all([i,u]).then(function(e){if(!this.j&&!this.A)return function(e,t,n,i,r,o,a){var s=La(t),u=r.closedCaptions&&0<r.closedCaptions.size;return null!=r.emsgSchemeIdUris&&0<r.emsgSchemeIdUris.length&&(new _i).ma("emsg",e.P.bind(e,i,o,r.emsgSchemeIdUris)).parse(a),function(e,t,n){var i=La(t);Y.O(i,"checking buffer length");var r=Math.max(e.l.bufferBehind,e.i.presentationTimeline.g),o=xn(e.g.T,t.type);if(null==o)return Y.O(i,"buffer behind okay because nothing buffered:","presentationTime="+n,"bufferBehind="+r),Promise.resolve();var a=n-o,s=a-r;return.01>=s?(Y.O(i,"buffer behind okay:","presentationTime="+n,"bufferedBehind="+a,"bufferBehind="+r,"underflow="+Math.abs(s)),Promise.resolve()):(Y.K(i,"buffer behind too large:","presentationTime="+n,"bufferedBehind="+a,"bufferBehind="+r,"overflow="+s),e.g.T.remove(t.type,o,o+s).then(function(){this.j||Y.K(i,"evicted "+s+" seconds")}.bind(e)))}(e,t,n).then(function(){if(!this.j)return Y.K(s,"appending media segment"),Mn(this.g.T,t.type,a,o.startTime+i.startTime,o.endTime+i.startTime,u)}.bind(e)).then(function(){if(!this.j)return Y.O(s,"appended media segment"),t.Hb=r,t.La=o,Promise.resolve()}.bind(e))}(this,t,n,a,s,r,e[1])}.bind(e)).then(function(){this.j||this.A||(t.Sa=!1,t.Ed=!1,t.Wa||this.g.zd(),Na(this,t,0),function(e,t,n){if(!e.C){var i=La(t);if(1==(t=Array.from(e.h.values())).length&&"text"==t[0].type||(e.C=t.every((function(e){return"text"==e.type||!e.Wa&&!e.ab&&e.La}))),e.C){for(Y.debug(i,"startup complete"),n=Pa(e,n),e.m[n]||ba(e,n).then(function(){this.j||(Y.K(i,"calling onCanSwitch()..."),this.g.te())}.bind(e)).catch(de.Bc),n=0;n<e.i.periods.length;++n)ba(e,n).catch(de.Bc);e.g.gg&&(Y.K(i,"calling onStartupComplete()..."),e.g.gg())}}}(this,t,s),Y.K(o,"finished fetch and append"))}.bind(e)).catch(function(e){this.j||this.A||(t.Sa=!1,"text"==t.type&&this.l.ignoreTextStreamFailures?(1001==e.code?Y.v(o,"Text stream failed to download. Proceeding without it."):Y.v(o,"Text stream failed to parse. Proceeding without it."),this.h.delete("text")):7001==e.code?(t.Sa=!1,t.Pa=null,Na(this,t,0)):3017==e.code?function(e,t,n){var i=La(t);if(Array.from(e.h.values()).some((function(e){return e!=t&&e.Ed})))Y.debug(i,"MediaSource threw QuotaExceededError:","waiting for another stream to recover...");else{var r=Math.round(100*e.u);if(20<r)e.u-=.2;else{if(!(4<r))return Y.error(i,"MediaSource threw QuotaExceededError too many times"),t.ac=!0,e.A=!0,void e.g.onError(n);e.u-=.04}Y.v(i,"MediaSource threw QuotaExceededError:","reducing buffering goals by "+(100-Math.round(100*e.u))+"%"),t.Ed=!0}Na(e,t,4)}(this,t,e):(Y.error(o,"failed fetch and append: code="+e.code),t.ac=!0,e.severity=2,_a(this,e)))}.bind(e))}(e,t,i,o,n),null)}(e,t);null!=i&&(Na(e,t,i),t.ac=!1)}catch(t){return void _a(e,t)}i=Array.from(e.h.values()),function(e,t){var n=La(t),i=Pa(e,t.stream);if(t.oa!=i){var r=t.oa,o=Array.from(e.h.values());o.every((function(e){return e.oa==r||Aa(e)}))?o.every(Ma)?(Y.debug(n,"all need Period "+r),ba(e,r).then(function(){if(!this.j)if(o.every(function(e){var t=Ma(e),n=Pa(this,e.stream);return!!Aa(e)||t&&e.oa==r&&n!=r}.bind(this))){var e=this.i.periods[r];Y.K(n,"calling onChooseStreams()...");var t=this.g.ue(e),i=new Map;t.variant&&t.variant.video&&i.set("video",t.variant.video),t.variant&&t.variant.audio&&i.set("audio",t.variant.audio),t.text&&i.set("text",t.text);for(var a=(t=f(this.h.keys())).next();!a.done;a=t.next())if(a=a.value,!i.has(a)&&"text"!=a)return Y.error(n,"invalid Streams chosen: missing "+a+" Stream"),void this.g.onError(new $(2,5,5005));for(a=(t=f(Array.from(i.keys()))).next();!a.done;a=t.next())if(a=a.value,!this.h.has(a)){if("text"!=a)return Y.error(n,"invalid Streams chosen: unusable "+a+" Stream"),void this.g.onError(new $(2,5,5005));va(this,null,null,i.get("text"),e.startTime),i.delete(a)}for(a=(t=f(Array.from(this.h.keys()))).next();!a.done;a=t.next()){a=a.value;var s=this.h.get(a),u=i.get(a);if(u){var c=Aa(s);c&&(s.oa=r,s.Hd=e.startTime),ga(this,u,!1,0,!1),c&&Aa(s)||Na(this,this.h.get(a),0)}else this.h.delete(a)}Y.K(n,"calling onCanSwitch()..."),this.g.te()}else Y.debug(n,"ignoring transition to Period",r,"since another is happening")}.bind(e)).catch(de.Bc)):Y.debug(n,"all MediaStates need Period "+r+", but not all MediaStates are idle"):Y.debug(n,"not all MediaStates need Period "+r)}}(e,t),e.C&&i.every((function(e){return e.endOfStream}))&&(Y.K(n,"calling endOfStream()..."),e.g.T.endOfStream().then(function(){if(!this.j){var e=this.g.T.ha();0!=e&&e<this.i.presentationTimeline.ha()&&this.i.presentationTimeline.Fa(e)}}.bind(e)))}}}function Sa(e,t,n){return t.Hb&&t.La?(n=Pa(e,t.Hb),e.i.periods[n].startTime+t.La.endTime):Math.max(n,t.Hd)}function Ea(e,t,n,i,r){var o=La(t);return t.La&&t.stream==t.Hb?(i=t.La.position+1,Y.O(o,"next position known:","position="+i),ka(e,t,r,i)):(t.La?(Y.K(o,"next position unknown: another Stream buffered"),o=Pa(e,t.Hb),o=xa(e,t,e.i.periods[o].startTime+t.La.endTime,r)):(Y.K(o,"next position unknown: nothing buffered"),o=xa(e,t,i||n,r)),null==o?null:(n=null,null==i&&(n=ka(e,t,r,Math.max(0,o-1))),n||ka(e,t,r,o)))}function xa(e,t,n,i){var r=La(t);return e=e.i.periods[i],Y.debug(r,"looking up segment:","presentationTime="+n,"currentPeriod.startTime="+e.startTime),n=Math.max(0,n-e.startTime),null==(t=t.stream.findSegmentPosition(n))&&Y.v(r,"cannot find segment:","currentPeriod.startTime="+e.startTime,"lookupTime="+n),t}function ka(e,t,n,i){var r=La(t);return n=e.i.periods[n],(t=t.stream.getSegmentReference(i))?(e=(i=e.i.presentationTimeline).$b(),i=i.Db(),n.startTime+t.endTime<e||n.startTime+t.startTime>i?(Y.O(r,"segment is not available:","currentPeriod.startTime="+n.startTime,"reference.startTime="+t.startTime,"reference.endTime="+t.endTime,"availabilityStart="+e,"availabilityEnd="+i),null):t):(Y.K(r,"segment does not exist:","currentPeriod.startTime="+n.startTime,"position="+i),null)}function Aa(e){return e&&"text"==e.type&&"application/cea-608"==e.stream.mimeType}function Ma(e){return!e.Sa&&null==e.Pa&&!e.Wa&&!e.ab}function Ia(e,t){var n=Ko(e.i.periods,t+1/15);return n?e.i.periods.indexOf(n):0}function Pa(e,t){for(var n=e.i.periods,i=0;i<n.length;i++){for(var r=n[i],o=new Set,a=f(r.variants),s=a.next();!s.done;s=a.next())(s=s.value).audio&&o.add(s.audio),s.video&&o.add(s.video),s.video&&s.video.trickModeVideo&&o.add(s.video.trickModeVideo);for(a=(r=f(r.textStreams)).next();!a.done;a=r.next())o.add(a.value);if(o.has(t))return i}return-1}function Ca(e,t,n){var i=Tr(n.i(),n.h,n.g,e.l.retryParameters);return Y.O("fetching: reference=",n),e=e.g.Ib.request(1,i),t.lb=e,e.promise.then((function(e){return t.lb=null,e.data}))}function Ra(e,t,n,i){return g((function r(){var o,a,s,u;return U(r,(function(r){switch(r.s){case 1:return o=La(t),t.Wa=!1,t.Qc=!1,t.oc=0,t.ab=!0,t.Hb=null,t.La=null,Y.debug(o,"clearing buffer"),i?(s=e.g.eb(),u=e.g.T.ha(),a=e.g.T.remove(t.type,s+i,u)):a=Pn(e.g.T,t.type).then(function(){if(!this.j&&n)return this.g.T.flush(t.type)}.bind(e)),k(r,a,2);case 2:if(e.j)return r.return();Y.debug(o,"cleared buffer"),t.ab=!1,t.endOfStream=!1,Na(e,t,0),A(r)}}))}))}function Na(e,t,n){var i=La(t),r=t.type;"text"!=r||e.h.has(r)?(Y.O(i,"updating in "+n+" seconds"),t.Pa=new Me((function(){return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return M(n,2),k(n,Ta(e,t),4);case 4:P(n,0);break;case 2:i=C(n),e.g&&e.g.onError(i),A(n)}}))}))})).V(n)):Y.K(i,"Text stream is unloaded. No update is needed.")}function Da(e){null!=e.Pa&&(e.Pa.stop(),e.Pa=null)}function ja(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:if(e.lb)return k(t,e.lb.abort(),0);t.I(0)}}))}))}function _a(e,t){Ce(e.M).then(function(){this.j||(this.g.onError(t),t.handled||this.l.failureCallback(t))}.bind(e))}function La(e){return"("+e.type+":"+e.stream.id+")"}function Ua(e,t,n,i,r,o){if(200<=n&&299>=n&&202!=n)return{uri:r||i,Bd:i,data:t,headers:e,fromCache:!!e["x-shaka-from-cache"]};r=null;try{r=ye(t)}catch(e){}throw Y.debug("HTTP error text:",r),new $(401==n||403==n?2:1,1,1001,i,n,r,e,o)}function Oa(e,t,n,i){var r=new Oa.h;at(t.headers).forEach((function(e,t){r.append(t,e)}));var o=new Oa.g,a={Zd:!1,Oe:!1};if(e=new Re(e=Oa.u(e,n,{body:t.body||void 0,headers:r,method:t.method,signal:o.signal,credentials:t.allowCrossSiteCredentials?"include":void 0},a,i),(function(){return a.Zd=!0,o.abort(),Promise.resolve()})),t=t.retryParameters.timeout){var s=new Ie((function(){a.Oe=!0,o.abort()}));s.V(t/1e3),e.finally((function(){s.stop()}))}return e}function Ka(e,t,n,i){var r=new Ka.j,o=Date.now(),a=0;return new Re(new Promise((function(s,u){for(var c in r.open(t.method,e,!0),r.responseType="arraybuffer",r.timeout=t.retryParameters.timeout,r.withCredentials=t.allowCrossSiteCredentials,r.onabort=function(){u(new $(1,1,7001,e,n))},r.onload=function(t){for(var i=(t=t.target).getAllResponseHeaders().trim().split("\r\n"),r={},o=(i=f(i)).next();!o.done;o=i.next())r[(o=o.value.split(": "))[0].toLowerCase()]=o.slice(1).join(": ");try{var a=Ua(r,t.response,t.status,e,t.responseURL,n);s(a)}catch(e){u(e)}},r.onerror=function(t){u(new $(1,1,1002,e,t,n))},r.ontimeout=function(){u(new $(1,1,1003,e,n))},r.onprogress=function(e){var t=Date.now();(100<t-o||e.lengthComputable&&e.loaded==e.total)&&(i(t-o,e.loaded-a,e.total-e.loaded),a=e.loaded,o=t)},t.headers)r.setRequestHeader(c.toLowerCase(),t.headers[c]);r.send(t.body)})),(function(){return r.abort(),Promise.resolve()}))}function Ba(){this.g=this.j=this.h=0,this.i=new Map,this.l=0}function Fa(e,t,n){this.m=e,this.h=new Map,this.i=!1,this.l=t,this.j=n,this.g=new Ba}function Ha(e,t,n,i,r,o){var a=function(e,t){e.h+=t;var n=e.l;return e.l++,e.i.set(n,t),n}(e.g,i);i=e.h.get(t)||Promise.resolve(),e.h.set(t,i.then((function(){return g((function t(){var i,s,u,c,l,d;return U(t,(function(t){switch(t.s){case 1:return k(t,function(e,t){return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return k(n,e.m.request(1,t).promise,2);case 2:return i=n.B,n.return(i.data)}}))}))}(e,n),2);case 2:if(i=t.B,e.i)throw new $(2,9,7001);if(r)for(var h in s=new Uint8Array(i),(u=new Hi(s)).data)c=Number(h),l=u.data[c],d=u.g[c],e.j(l,d);return e.g.close(a,i.byteLength),h=e.g,e.l(0==h.h?0:h.j/h.h,e.g.g),t.return(o(i))}}))}))})))}function Va(e,t){var n=this;this.i=e,this.h=e.objectStore(t),this.g=new ge,e.onabort=function(e){e.preventDefault(),n.g.reject()},e.onerror=function(e){e.preventDefault(),n.g.reject()},e.oncomplete=function(){n.g.resolve()}}function Ga(e,t){return new Promise((function(n,i){var r=e.h.openCursor();r.onerror=i,r.onsuccess=function(e){if(!(e=e.target.result))return n();t(e.key,e.value,e),e.continue()}}))}function qa(e){this.h=e,this.g=[]}function za(e,t){return Wa(e,t,"readwrite")}function Wa(e,t,n){var i=new Va(n=e.h.transaction([t],n),t);return e.g.push(i),i.promise().then((function(){He(e.g,i)}),(function(){He(e.g,i)})),i}function Xa(e,t,n){this.h=new qa(e),this.i=t,this.g=n}function Ya(e){return Promise.reject(new $(2,9,9011,"Cannot add new value to "+e))}function $a(e,t,n,i){t=(e=za(e.h,t)).store();for(var r={},o=(n=f(n)).next();!o.done;r={key:r.key},o=n.next())r.key=o.value,t.delete(r.key).onsuccess=function(e){return function(){return i(e.key)}}(r);return e.promise()}function Ja(e,t,n){return g((function i(){var r,o,a,s,u,c,l;return U(i,(function(i){switch(i.s){case 1:for(r=Wa(e.h,t,"readonly"),o=r.store(),a={},s=[],u={},c=f(n),l=c.next();!l.done;u={request:u.request,key:u.key},l=c.next())u.key=l.value,u.request=o.get(u.key),u.request.onsuccess=function(e){return function(){null==e.request.result&&s.push(e.key),a[e.key]=e.request.result}}(u);return k(i,r.promise(),2);case 2:if(s.length)throw new $(2,9,9012,"Could not find values for "+s);return i.return(n.map((function(e){return a[e]})))}}))}))}function Qa(e){this.g=new qa(e)}function Za(){this.g=new Map}function es(e,t,n){if(!(e=e.g.get(t)))throw new $(2,9,9013,"Could not find mechanism with name "+t);if(!(t=e.getCells().get(n)))throw new $(2,9,9013,"Could not find cell with name "+n);return t}function ts(e,t){ns.set(e,t)}ua.prototype.destroy=function(){var e=this;return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:n=[];for(var r=f(e.h.values()),o=r.next();!o.done;o=r.next())Da(i=o.value),n.push(ja(i));return k(t,Promise.all(n),2);case 2:e.h.clear(),e.o.clear(),e.g=null,e.i=null,e.F=null,e.m=null,e.l=null,e.j=!0,A(t)}}))}))},ua.prototype.configure=function(e){this.l=e,this.M=new Pe({maxAttempts:Math.max(e.retryParameters.maxAttempts,2),baseDelay:e.retryParameters.baseDelay,backoffFactor:e.retryParameters.backoffFactor,fuzzFactor:e.retryParameters.fuzzFactor,timeout:0},!0)},ua.prototype.start=function(){var e=this;return g((function t(){var n,i,r;return U(t,(function(t){switch(t.s){case 1:return n=e.g.eb(),i=Ia(e,n),(r=e.g.ue(e.i.periods[i])).variant||r.text?k(t,va(e,r.variant?r.variant.audio:null,r.variant?r.variant.video:null,r.text,n),2):(Y.error("init: no Streams chosen"),t.return(new $(2,5,5005)));case 2:if(e.j)return t.return();Y.debug("init: completed initial Stream setup"),e.g&&e.g.Yf&&(Y.K("init: calling onInitialStreamsSetup()..."),e.g.Yf()),A(t)}}))}))},ua.prototype.P=function(e,t,n,i){var r=i.reader.Cd(),o=i.reader.Cd(),a=i.reader.N(),s=i.reader.N(),u=i.reader.N(),c=i.reader.N();i=i.reader.mb(i.reader.S.byteLength-i.reader.ka()),e=e.startTime+t.startTime+s/a,n.includes(r)&&("urn:mpeg:dash:event:2012"==r?this.g.Zf():this.g.onEvent(new Ue("emsg",{detail:{startTime:e,endTime:e+u/a,schemeIdUri:r,value:o,timescale:a,presentationTimeDelta:s,eventDuration:u,id:c,messageData:i}})))},V("shaka.net.HttpFetchPlugin",Oa),Oa.u=function(e,t,n,i,r){return g((function o(){var a,s,u,c,l,d,h,f,p,m,v,y;return U(o,(function(o){switch(o.s){case 1:return a=Oa.l,s=Oa.i,d=l=0,h=Date.now(),M(o,2),k(o,a(e,n),4);case 4:return u=o.B,f=u.clone().body.getReader(),m=(p=u.headers.get("Content-Length"))?parseInt(p,10):0,new s({start:function(e){!function t(){return g((function n(){var i,o,a;return U(n,(function(n){switch(n.s){case 1:return M(n,2),k(n,f.read(),4);case 4:i=n.B,P(n,3);break;case 2:return o=C(n),Y.K("error reading from stream",o.message),n.return();case 3:i.done||(l+=i.value.byteLength),(100<(a=Date.now())-h||i.done)&&(r(a-h,l-d,m-l),d=l,h=a),i.done?e.close():(e.enqueue(i.value),t()),A(n)}}))}))}()}}),k(o,u.arrayBuffer(),5);case 5:c=o.B,P(o,3);break;case 2:if(v=C(o),i.Zd)throw new $(1,1,7001,e,t);if(i.Oe)throw new $(1,1,1003,e,t);throw new $(1,1,1002,e,v,t);case 3:return y={},u.headers.forEach((function(e,t){y[t.trim()]=e})),o.return(Ua(y,c,u.status,e,u.url,t))}}))}))},Oa.isSupported=function(){if(!e.ReadableStream)return!1;try{new ReadableStream({})}catch(e){return!1}return!(!e.fetch||!e.AbortController)},Oa.isSupported=Oa.isSupported,Oa.l=e.fetch,Oa.g=e.AbortController,Oa.i=e.ReadableStream,Oa.h=e.Headers,Oa.isSupported()&&(Xe("http",Oa,2),Xe("https",Oa,2)),V("shaka.net.HttpXHRPlugin",Ka),Ka.j=e.XMLHttpRequest,Xe("http",Ka,1),Xe("https",Ka,1),Ba.prototype.close=function(e,t){if(this.i.has(e)){var n=this.i.get(e);this.i.delete(e),this.j+=n,this.g+=t}},Fa.prototype.destroy=function(){return this.i=!0,Promise.all(this.h.values()).then((function(){}),(function(){}))},Va.prototype.abort=function(){try{this.i.abort()}catch(e){}return this.g.catch((function(){}))},Va.prototype.store=function(){return this.h},Va.prototype.promise=function(){return this.g},qa.prototype.destroy=function(){return Promise.all(this.g.map((function(e){return e.abort()})))},(r=Xa.prototype).destroy=function(){return this.h.destroy()},r.hasFixedKeySpace=function(){return!0},r.addSegments=function(){return Ya(this.i)},r.removeSegments=function(e,t){return $a(this,this.i,e,t)},r.getSegments=function(e){var t=this;return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return k(n,Ja(t,t.i,e),2);case 2:return i=n.B,n.return(i.map((function(e){return t.ae(e)})))}}))}))},r.addManifests=function(){return Ya(this.g)},r.updateManifestExpiration=function(e,t){var n=za(this.h,this.g),i=n.store();return i.get(e).onsuccess=function(n){(n=n.target.result)&&(n.expiration=t,i.put(n,e))},n.promise()},r.removeManifests=function(e,t){return $a(this,this.g,e,t)},r.getManifests=function(e){var t=this;return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return k(n,Ja(t,t.g,e),2);case 2:return i=n.B,n.return(i.map((function(e){return t.pc(e)})))}}))}))},r.getAllManifests=function(){var e=this;return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return n=Wa(e.h,e.g,"readonly"),i=new Map,k(t,Ga(n,(function(t,n){i.set(t,e.pc(n))})),2);case 2:return k(t,n.promise(),3);case 3:return t.return(i)}}))}))},r.ae=function(e){return e},r.pc=function(e){return e},r.add=function(e,t){var n=this;return g((function i(){var r,o,a,s;return U(i,(function(i){switch(i.s){case 1:r=za(n.h,e),o=r.store(),a=[];for(var u=f(t),c=u.next();!c.done;c=u.next())s=c.value,o.add(s).onsuccess=function(e){a.push(e.target.result)};return k(i,r.promise(),2);case 2:return i.return(a)}}))}))},Qa.prototype.destroy=function(){return this.g.destroy()},Qa.prototype.getAll=function(){var e=this;return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return n=Wa(e.g,"session-ids","readonly"),i=[],k(t,Ga(n,(function(e,t){i.push(t)})),2);case 2:return k(t,n.promise(),3);case 3:return t.return(i)}}))}))},Qa.prototype.add=function(e){for(var t=za(this.g,"session-ids"),n=t.store(),i=(e=f(e)).next();!i.done;i=e.next())n.add(i.value);return t.promise()},Qa.prototype.remove=function(e){var t=this;return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return k(n,Ga(i=za(t.g,"session-ids"),(function(t,n,i){0<=e.indexOf(n.sessionId)&&i.delete()})),2);case 2:return k(n,i.promise(),0)}}))}))},Za.prototype.destroy=function(){for(var e=[],t=f(this.g.values()),n=t.next();!n.done;n=t.next())e.push(n.value.destroy());return this.g.clear(),Promise.all(e)},Za.prototype.init=function(){var e=this;ns.forEach((function(t,n){var i=t();i?e.g.set(n,i):Y.info("Skipping "+n+" as it is not supported on this platform")}));for(var t=[],n=f(this.g.values()),i=n.next();!i.done;i=n.next())t.push(i.value.init());return Promise.all(t)},Za.prototype.erase=function(){var e=this;return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return n=Array.from(e.g.values()),(i=0<n.length)||ns.forEach((function(e){(e=e())&&n.push(e)})),k(t,Promise.all(n.map((function(e){return e.erase()}))),2);case 2:if(!i)return k(t,Promise.all(n.map((function(e){return e.destroy()}))),0);t.I(0)}}))}))},V("shaka.offline.StorageMuxer.register",ts),V("shaka.offline.StorageMuxer.unregister",(function(e){ns.delete(e)}));var ns=new Map;function is(e){Xa.apply(this,arguments)}function rs(e){return function(e){var t=e.streams.filter((function(e){return"audio"==e.contentType})),n=e.streams.filter((function(e){return"video"==e.contentType}));if(!t.every((function(e){return e.variantIds}))||!n.every((function(e){return e.variantIds}))){t.forEach((function(e){e.variantIds=[]})),n.forEach((function(e){e.variantIds=[]}));var i=0;if(n.length&&!t.length){Y.debug("Found video-only content. Creating variants for video.");var r=i++;n.forEach((function(e){e.variantIds.push(r)}))}if(!n.length&&t.length){Y.debug("Found audio-only content. Creating variants for audio.");var o=i++;t.forEach((function(e){e.variantIds.push(o)}))}n.length&&t.length&&(Y.debug("Found audio-video content. Creating variants."),t.forEach((function(e){n.forEach((function(t){var n=i++;e.variantIds.push(n),t.variantIds.push(n)}))})))}}(e),e.streams.forEach((function(){})),{startTime:e.startTime,streams:e.streams.map(os)}}function os(e){var t=e.initSegmentUri?ss(e.initSegmentUri):null;return{id:e.id,originalId:null,primary:e.primary,presentationTimeOffset:e.presentationTimeOffset,contentType:e.contentType,mimeType:e.mimeType,codecs:e.codecs,frameRate:e.frameRate,pixelAspectRatio:void 0,kind:e.kind,language:e.language,label:e.label,width:e.width,height:e.height,initSegmentKey:t,encrypted:e.encrypted,keyId:e.keyId,segments:e.segments.map(as),variantIds:e.variantIds}}function as(e){var t=ss(e.uri);return{startTime:e.startTime,endTime:e.endTime,dataKey:t}}function ss(e){var t;if((t=/^offline:[0-9]+\/[0-9]+\/([0-9]+)$/.exec(e))||(t=/^offline:segment\/([0-9]+)$/.exec(e)))return Number(t[1]);throw new $(2,9,9004,"Could not parse uri "+e)}function us(e,t,n,i){Xa.call(this,e,t,n),this.j=i}function cs(){this.l=this.i=this.h=this.g=this.j=null}function ls(e,t,n,i){this.g=e,this.l=t,this.j=n,this.i=i,this.h=["offline:",e,"/",t,"/",n,"/",i].join("")}function ds(e){if(null==(e=/^offline:([a-z]+)\/([^/]+)\/([^/]+)\/([0-9]+)$/.exec(e)))return null;var t=e[1];if("manifest"!=t&&"segment"!=t)return null;var n=e[2];if(!n)return null;var i=e[3];return i&&null!=t?new ls(t,n,i,Number(e[4])):null}function hs(e,t){this.h=e,this.g=t}function fs(e,t,n){var i=t.streams.filter((function(e){return"audio"==e.contentType})),r=t.streams.filter((function(e){return"video"==e.contentType}));return i=function(e,t,n){for(var i=new Set,r=f(t),o=r.next();!o.done;o=r.next()){var a=f(o.value.variantIds);for(o=a.next();!o.done;o=a.next())i.add(o.value)}for(r=f(n),o=r.next();!o.done;o=r.next())for(a=f(o.value.variantIds),o=a.next();!o.done;o=a.next())i.add(o.value);for(r=new Map,i=f(i),o=i.next();!o.done;o=i.next())o=o.value,r.set(o,{id:o,language:"",primary:!1,audio:null,video:null,bandwidth:0,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0});for(t=f(t),i=t.next();!i.done;i=t.next())for(i=i.value,o=ps(e,i),a=f(i.variantIds),i=a.next();!i.done;i=a.next())(i=r.get(i.value)).language=o.language,i.primary=i.primary||o.primary,i.audio=o;for(n=f(n),t=n.next();!t.done;t=n.next())for(i=t.value,t=ps(e,i),o=f(i.variantIds),i=o.next();!i.done;i=o.next())(i=r.get(i.value)).primary=i.primary||t.primary,i.video=t;return r}(e,i,r),r=t.streams.filter((function(e){return"text"==e.contentType})).map((function(t){return ps(e,t)})),t.streams.forEach((function(i){i=i.segments.map((function(t,n){return gs(e,n,t)})),n.Jb(i,t.startTime)})),{startTime:t.startTime,variants:Array.from(i.values()),textStreams:r}}function ps(e,t){var n=t.segments.map((function(t,n){return gs(e,n,t)})),i=new ir(n);return n={id:t.id,originalId:t.originalId,createSegmentIndex:function(){return Promise.resolve()},findSegmentPosition:function(e){return i.find(e)},getSegmentReference:function(e){return i.get(e)},initSegmentReference:null,presentationTimeOffset:t.presentationTimeOffset,mimeType:t.mimeType,codecs:t.codecs,width:t.width||void 0,height:t.height||void 0,frameRate:t.frameRate||void 0,pixelAspectRatio:t.pixelAspectRatio||void 0,kind:t.kind,encrypted:t.encrypted,keyId:t.keyId,language:t.language,label:t.label||null,type:t.contentType,primary:t.primary,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},null!=t.initSegmentKey&&(n.initSegmentReference=function(e,t){var n=new ls("segment",e.h,e.g,t);return new er((function(){return[n.toString()]}),0,null)}(e,t.initSegmentKey)),n}function gs(e,t,n){var i=new ls("segment",e.h,e.g,n.dataKey);return new tr(t,n.startTime,n.endTime,(function(){return[i.toString()]}),0,null)}function ms(){this.g=null}function vs(e){var t=ds(e);return t&&"manifest"==t.g?vs.m(e):t&&"segment"==t.g?vs.o(t.key(),t):Ne(new $(2,1,9004,e))}function ys(e,t,n){return g((function i(){var r,o,a,s,u,c;return U(i,(function(i){switch(i.s){case 1:r=[];for(var l=[],d=f(n),h=d.next();!h.done;h=d.next()){h=h.value;for(var p=!1,m=f(l),v=m.next();!v.done;v=m.next())if(bs((v=v.value).info,h)){v.sessionIds.push(h.sessionId),p=!0;break}p||l.push({info:h,sessionIds:[h.sessionId]})}o=f(l),a=o.next();case 2:if(a.done){i.I(4);break}return s=a.value,u=function(e,t,n){return g((function i(){var r,o,a,s;return U(i,(function(i){switch(i.s){case 1:return r=new Tt({Ib:t,onError:function(){},Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),M(i,2),r.configure(e),k(i,function(e,t,n,i,r,o){var a=new Map;return a.set(t,{audioCapabilities:r,videoCapabilities:o,distinctiveIdentifier:"optional",persistentState:"required",sessionTypes:["persistent-license"],label:t,drmInfos:[{keySystem:t,licenseServerUri:n,distinctiveIdentifierRequired:!1,persistentStateRequired:!0,audioRobustness:"",videoRobustness:"",serverCertificate:i,initData:null,keyIds:null}]}),Rt(e,a)}(r,n.info.keySystem,n.info.licenseUri,n.info.serverCertificate,n.info.audioCapabilities,n.info.videoCapabilities),4);case 4:P(i,3);break;case 2:return o=C(i),Y.v("Error initializing EME",o),k(i,r.destroy(),5);case 5:return i.return([]);case 3:return M(i,6),k(i,xt(r),8);case 8:P(i,7);break;case 6:return a=C(i),Y.v("Error setting server certificate",a),k(i,r.destroy(),9);case 9:return i.return([]);case 7:return s=[],k(i,Promise.all(n.sessionIds.map((function(e){return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:return M(t,2),k(t,function(e,t){return g((function n(){var i,r,o;return U(n,(function(n){switch(n.s){case 1:return k(n,Nt(e,t),2);case 2:return(i=n.B)?(r=[],(o=e.h.get(i))&&(o.Ga=new ge,r.push(o.Ga)),Y.O("Attempting to remove session",t),r.push(i.remove()),k(n,Promise.all(r),0)):(Y.O("Ignoring attempt to remove missing session",t),n.return())}}))}))}(r,e),4);case 4:s.push(e),P(t,0);break;case 2:n=C(t),Y.v("Error deleting offline session",n),A(t)}}))}))}))),10);case 10:return k(i,r.destroy(),11);case 11:return i.return(s)}}))}))}(e,t,s),k(i,u,5);case 5:c=i.B,r=r.concat(c),a=o.next(),i.I(2);break;case 4:return i.return(r)}}))}))}function bs(e,t){function n(e,t){return e.robustness==t.robustness&&e.contentType==t.contentType}return e.keySystem==t.keySystem&&e.licenseUri==t.licenseUri&&Ve(e.audioCapabilities,t.audioCapabilities,n)&&Ve(e.videoCapabilities,t.videoCapabilities,n)}function ws(e,t){var n={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},i=this;this.m=t,this.i=e,this.j=n,this.o=null,this.l=[],this.h=this.g=null,this.u=!0,this.A=Promise.resolve().then((function(){return function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:if(e.u){if(0==e.l.length||e.g&&!e.g.gb)var n=!1;else{e.g&&(e.g.Da.kb(),e.g=null);var i=(n=e.l.shift()).create(e.j);i?(n.Da.Kb(),e.g={node:i.node,payload:i.payload,gb:i.gb,Da:n.Da}):n.Da.Ec(),n=!0}return n?n=Promise.resolve():e.g?n=function(e){return g((function t(){var n,i;return U(t,(function(t){switch(t.s){case 1:return e.i=e.m.Af(e.i,e.j,e.g.node,e.g.payload),M(t,2),e.h=e.m.ef(e.i,e.j,e.g.payload),k(t,e.h.promise,4);case 4:e.h=null,e.i==e.g.node&&(e.g.Da.Cc(),e.g=null),P(t,0);break;case 2:return 7001==(n=C(t)).code?e.g.Da.kb():e.g.Da.onError(n),e.g=null,e.h=null,i=e,k(t,e.m.handleError(e.j,n),5);case 5:i.i=t.B,A(t)}}))}))}(e):(e.m.Xf(e.i),e.o=new ge,n=e.o),k(t,n,1)}t.I(0)}}))}))}(i)}))}function Ts(e,t){var n={Kb:function(){},Cc:function(){},kb:function(){},onError:function(){},Ec:function(){},$g:function(){}};return e.l.push({create:t,Da:n}),e.h&&e.h.abort(),Ss(e),n}function Ss(e){e.o&&(e.o.resolve(),e.o=null)}function Es(e){this.g=null;for(var t=0;t<e.textTracks.length;++t){var n=e.textTracks[t];n.mode="disabled","Shaka Player TextTrack"==n.label&&(this.g=n)}this.g||(this.g=e.addTextTrack("subtitles","Shaka Player TextTrack")),this.g.mode="hidden"}function xs(e){if(e.startTime>=e.endTime)return Y.v("Invalid cue times: "+e.startTime+" - "+e.endTime),null;var t=new VTTCue(e.startTime,e.endTime,e.payload);t.lineAlign=e.lineAlign,t.positionAlign=e.positionAlign,e.size&&(t.size=e.size);try{t.align=e.textAlign}catch(e){}return"center"==e.textAlign&&"center"!=t.align&&(t.align="middle"),"vertical-lr"==e.writingMode?t.vertical="lr":"vertical-rl"==e.writingMode&&(t.vertical="rl"),1==e.lineInterpretation&&(t.snapToLines=!1),null!=e.line&&(t.line=e.line),null!=e.position&&(t.position=e.position),t}function ks(e,t){var n=e.mode;e.mode="showing"==n?"showing":"hidden";for(var i=e.cues,r=i.length-1;0<=r;r--){var o=i[r];o&&t(o)&&e.removeCue(o)}e.mode=n}function As(e,t,i,r,o){var a,s=o in r,u=!0;for(a in t){var c=o+"."+a,l=s?r[o]:i[a];s||a in i?void 0===t[a]?void 0===l||s?delete e[a]:e[a]=Be(l):l.constructor==Object&&t[a]&&t[a].constructor==Object?(e[a]||(e[a]=Be(l)),c=As(e[a],t[a],l,r,c),u=u&&c):n(t[a])!=(void 0===l?"undefined":n(l))||null==t[a]||"function"!=typeof t[a]&&t[a].constructor!=l.constructor?(Y.kc("Invalid config, wrong type for "+c),u=!1):("function"==typeof i[a]&&i[a].length!=t[a].length&&Y.ba("Unexpected number of arguments for "+c),e[a]=t[a]):(Y.kc("Invalid config, unrecognized key "+c),u=!1)}return u}function Ms(e,t){for(var n={},i=n,r=0,o=0;!(0>(r=e.indexOf(".",r)));)0!=r&&"\\"==e[r-1]||(i[o=e.substring(o,r).replace(/\\\./g,".")]={},i=i[o],o=r+1),r+=1;return i[e.substring(o).replace(/\\\./g,".")]=t,n}function Is(){}function Ps(){var e=5e5,t=1/0;navigator.connection&&(navigator.connection.downlink&&(e=1e6*navigator.connection.downlink),navigator.connection.saveData&&(t=360));var n={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},servers:{},clearKeys:{},advanced:{},delayLicenseRequestUntilPlayed:!1,initDataTransform:Dt,fairPlayTransform:!0,updateExpirationTime:1},i={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},availabilityWindowOverride:NaN,disableAudio:!1,disableVideo:!1,disableText:!1,dash:{customScheme:function(e){if(e)return null},clockSyncUri:"",ignoreDrmInfo:!1,xlinkFailGracefully:!1,defaultPresentationDelay:10,ignoreMinBufferTime:!1,autoCorrectDrift:!0,ignoreSuggestedPresentationDelay:!1,ignoreEmptyAdaptationSet:!1},hls:{ignoreTextStreamFailures:!1,useFullSegmentsForStartTime:!1}},r={retryParameters:{maxAttempts:2,baseDelay:1e3,backoffFactor:2,fuzzFactor:.5,timeout:0},failureCallback:function(e){return Y.error("Unhandled streaming error",e),[e]},rebufferingGoal:2,bufferingGoal:10,bufferBehind:30,ignoreTextStreamFailures:!1,alwaysStreamText:!1,startAtSegmentBoundary:!1,smallGapLimit:.5,jumpLargeGaps:!1,durationBackoff:1,forceTransmuxTS:!1,safeSeekOffset:5,stallEnabled:!0,stallThreshold:1,stallSkip:.1,useNativeHlsOnSafari:!0};(vt("Web0S")||pt()||vt("CrKey"))&&(r.stallSkip=0);var o={trackSelectionCallback:function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:return t.return(e)}}))}))},progressCallback:function(e,t){return[e,t]},usePersistentLicense:!0},a={drm:n,manifest:i,streaming:r,offline:o,abrFactory:Bn,abr:{enabled:!0,defaultBandwidthEstimate:e,switchInterval:8,bandwidthUpgradeTarget:.85,bandwidthDowngradeTarget:.95,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:t,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0}},preferredAudioLanguage:"",preferredTextLanguage:"",preferredVariantRole:"",preferredTextRole:"",preferredAudioChannelCount:2,restrictions:{minWidth:0,maxWidth:1/0,minHeight:0,maxHeight:1/0,minPixels:0,maxPixels:1/0,minFrameRate:0,maxFrameRate:1/0,minBandwidth:0,maxBandwidth:1/0},playRangeStart:0,playRangeEnd:1/0,textDisplayFactory:function(){return null}};return o.trackSelectionCallback=function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:return t.return(function(e,t){var n=e.filter((function(e){return"variant"==e.type})),i=[],r=Un(t,n.map((function(e){return e.language})));r&&(i=n.filter((function(e){return _n(e.language)==r}))),0==i.length&&(i=n.filter((function(e){return e.primary}))),0==i.length&&(1<new Set(n.map((function(e){return e.language}))).size&&Y.v("Could not choose a good audio track based on language preferences or primary tracks.  An arbitrary language will be stored!"),i=n);var o=i.filter((function(e){return e.height&&480>=e.height}));if(o.length&&(o.sort((function(e,t){return t.height-e.height})),i=o.filter((function(e){return e.height==o[0].height}))),n=[],i.length){var a=Math.floor(i.length/2);i.sort((function(e,t){return e.bandwidth-t.bandwidth})),n.push(i[a])}for(i=f(e),a=i.next();!a.done;a=i.next())"text"==(a=a.value).type&&n.push(a);return n}(e,a.preferredAudioLanguage))}}))}))},a}function Cs(e,t,n){var i={".drm.servers":"",".drm.clearKeys":"",".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:new Uint8Array(0),individualizationServer:""}};return As(e,t,n||Ps(),i,"")}function Rs(){this.g=null,this.h=[]}function Ns(e,t){if(null==e.g)e.g={timestamp:Date.now()/1e3,state:t,duration:0};else{var n=Date.now()/1e3;e.g.duration=n-e.g.timestamp,e.g.state!=t&&(e.h.push(e.g),e.g={timestamp:n,state:t,duration:0})}}function Ds(e,t){var n=0;e.g&&e.g.state==t&&(n+=e.g.duration);for(var i=f(e.h),r=i.next();!r.done;r=i.next())n+=(r=r.value).state==t?r.duration:0;return n}function js(){this.h=this.i=null,this.g=[]}function _s(){this.j=this.C=this.m=this.h=this.o=this.u=this.A=this.l=this.F=NaN,this.g=new Rs,this.i=new js}function Ls(t,n){var i=this;Ke.call(this),this.o=ku,this.g=null,this.ub=!1,this.l=new Ze,this.Uc=this.u=this.Tb=this.i=this.C=this.j=this.rc=this.L=this.ic=this.J=this.wb=this.A=this.M=this.m=this.X=null,this.re=1e9,this.lc=new Set,this.yb=!0,this.wa=null,this.qe=!1,this.oe=0,this.va=null,this.Z=new vo,this.h=Xs(this),this.mc={width:1/0,height:1/0},this.F=null,this.tb=new Ao(this.h.preferredAudioLanguage,this.h.preferredVariantRole,this.h.preferredAudioChannelCount),this.ua=this.h.preferredTextLanguage,this.Xa=this.h.preferredTextRole,this.Wc=[],n&&n(this),this.X=function(e){return new ze((function(t,n){e.u&&e.u.segmentDownloaded(t,n)}))}(this),this.l.H(e,"online",(function(){i.Id()})),this.P={name:"detach"},this.da={name:"attach"},this.Qa={name:"unload"},this.nd={name:"manifest-parser"},this.md={name:"manifest"},this.vb={name:"media-source"},this.ad={name:"drm-engine"},this.ea={name:"load"},this.od={name:"src-equals-drm-engine"},this.xb={name:"src-equals"};var r=new Map;r.set(this.da,(function(e,t){return _e(function(e,t,n){return null==t.D&&(t.D=n.D,e.l.H(t.D,"error",(function(){var t=du(e);t&&e.Va(t)}))),e.g=t.D,Promise.resolve()}(i,e,t))})),r.set(this.P,(function(e){return e.D&&(i.l.ta(e.D,"error"),e.D=null),i.g=null,_e(e=Promise.resolve())})),r.set(this.Qa,(function(e){return _e(Bs(i,e))})),r.set(this.vb,(function(t){return _e(t=function(t,n){return g((function i(){var r,o,a,s;return U(i,(function(i){switch(i.s){case 1:return r=e.muxjs?new Gt:new qt,o=t.h.textDisplayFactory,a=new o,t.fd=o,k(i,(s=new bn(n.D,r,a)).C,2);case 2:t.M=s,A(i)}}))}))}(i,t))})),r.set(this.nd,(function(e,t){return _e(function(e,t,n){return g((function i(){var r,o,a,s;return U(i,(function(i){switch(i.s){case 1:if(t.Ia=n.Ia,t.mimeType=n.mimeType,t.uri=n.uri,r=t.uri,o=e.X,e.Tb=r,t.Ia){e.C=t.Ia(),i.I(2);break}return a=e,k(i,br.create(r,o,e.h.manifest.retryParameters,t.mimeType),3);case 3:a.C=i.B;case 2:s=Be(e.h.manifest),n.D&&"AUDIO"===n.D.nodeName&&(s.disableVideo=!0),e.C.configure(s),A(i)}}))}))}(i,e,t))})),r.set(this.md,(function(e){return function(e,t){var n=t.uri,i=e.X;e.rc=new ia((function(){return e.He()})),function(e,t){e.h=t}(e.rc,(function(t){lu(e,"timelineregionadded",t)}));var r={networkingEngine:i,filterNewPeriod:function(t){return e.Xc(t)},filterAllPeriods:function(t){return Ys(e,t)},onTimelineRegionAdded:function(t){var n=e.rc;e:{for(var i=f(n.g),r=i.next();!r.done;r=i.next())if((r=r.value).schemeIdUri==t.schemeIdUri&&r.id==t.id&&r.startTime==t.startTime&&r.endTime==t.endTime){i=r;break e}i=null}null==i&&(n.g.add(t),n.h(t))},onEvent:function(t){return e.dispatchEvent(t)},onError:function(t){return e.Va(t)}};return new Re(Promise.resolve().then((function(){return g((function t(){var i;return U(t,(function(t){switch(t.s){case 1:return i=e,k(t,e.C.start(n,r),2);case 2:if(i.i=t.B,e.dispatchEvent(new Ue("manifestparsed")),0==e.i.periods.length)throw new $(2,4,4014);!function(e){function t(e){return e.video&&e.audio||e.video&&e.video.codecs.includes(",")}e.some((function(e){return e.variants.some(t)}))&&(Y.debug("Found variant with audio and video content, so filtering out audio-only content in all periods."),e.forEach((function(e){e.variants=e.variants.filter(t)})))}(e.i.periods),A(t)}}))}))})),(function(){return Y.info("Aborting parser step..."),e.C.stop()}))}(i,e)})),r.set(this.ad,(function(e){return _e(e=function(e,t){return g((function n(){return U(n,(function(n){switch(n.s){case 1:return e.m=Fs(e,{Ib:e.X,onError:function(t){e.Va(t)},Dc:function(t){hu(e,t)},onExpirationUpdated:function(t,n){fu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.m.configure(e.h.drm),k(n,St(e.m,Oo(e.i.periods),e.i.offlineSessionIds),2);case 2:return k(n,e.m.Ub(t.D),3);case 3:Ys(e,e.i.periods),A(n)}}))}))}(i,e))})),r.set(this.ea,(function(e,t){return _e(function(e,t,n){return g((function i(){var r,o,a,s,u,c,l,d,h,p;return U(i,(function(i){switch(i.s){case 1:return t.startTime=n.startTime,r=t.D,o=t.uri,e.Tb=o,e.J=new Fo({wc:function(){return t.D.playbackRate},vc:function(){return t.D.defaultPlaybackRate},Od:function(e){t.D.playbackRate=e},pe:function(e){t.D.currentTime+=e}}),e.F=new _s,a=function(){return eu(e)},s=function(){return Zs(e)},e.l.H(r,"playing",a),e.l.H(r,"pause",a),e.l.H(r,"ended",a),e.l.H(r,"ratechange",s),u=e.h.abrFactory,e.u&&e.Uc==u||(e.Uc=u,e.u=new u,e.u.configure(e.h.abr)),function(e,t){for(var n=0;n<t.length;n++){for(var i=t[n],r=new Map,o=f(i.variants),a=o.next();!a.done;a=o.next())if((a=a.value).video&&a.video.closedCaptions)for(var s=f((a=a.video).closedCaptions.keys()),u=s.next();!u.done;u=s.next())if(u=u.value,!r.has(u)){var c={id:e.re++,originalId:u,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:"application/cea-608",codecs:"",kind:"caption",encrypted:!1,keyId:null,language:a.closedCaptions.get(u),label:null,type:"text",primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:a.roles,channelsCount:null,audioSamplingRate:null,closedCaptions:null};r.set(u,c)}for(r=f(r.values()),o=r.next();!o.done;o=r.next())i.textStreams.push(o.value)}}(e,e.i.periods),e.tb=new Ao(e.h.preferredAudioLanguage,e.h.preferredVariantRole,e.h.preferredAudioChannelCount),e.ua=e.h.preferredTextLanguage,e.Xa=e.h.preferredTextRole,function(e,t,n){0<t&&(e.aa()?Y.v("|playRangeStart| has been configured for live content. Ignoring the setting."):e.Le(t)),n<e.ha()&&(e.aa()?Y.v("|playRangeEnd| has been configured for live content. Ignoring the setting."):e.Fa(n))}(e.i.presentationTimeline,e.h.playRangeStart,e.h.playRangeEnd),e.u.init((function(t,n,i){n=void 0!==n&&n,i=void 0===i?0:i,Y.debug("switch_");e:{for(var r=f(e.i.periods),o=r.next();!o.done;o=r.next())if((o=o.value).variants.includes(t)){r=o;break e}r=null}zs(e,r,t,!0),e.j&&pa(e.j,t,n,i)&&ru(e)})),e.A=function(e,t){return new Zo(e.g,e.i,e.h.streaming,t,(function(){e.wb&&Uo(e.wb,!0),e.j&&function(e){function t(t){var r=e.g.T;return"text"==t?t=null!=(t=r.g).g&&null!=t.h&&(n>=t.g&&n<t.h):t=Wt(t=An(r,t),n,i),t}var n=e.g.eb(),i=e.l.smallGapLimit,r=!1,o=Ia(e,n);if(ot(e.h.values(),(function(e){return e.oa==o})))for(var a=f(e.h.keys()),s=a.next();!s.done;s=a.next())t(s=s.value)||(ma(e,e.h.get(s)),r=!0);else ot(e.h.keys(),t)||(Y.debug("(all): seeked: unbuffered seek: clearing all buffers"),e.h.forEach((function(t){ma(e,t)})),r=!0);r||Y.debug("(all): seeked: buffered seek: presentationTime="+n)}(e.j),e.L&&Vs(e)}),(function(t){return e.dispatchEvent(t)}))}(e,t.startTime),e.wb=function(e){var t=new Bo(e.i);!function(e,t){e.h=t}(t,(function(){ou(e)}));var n=new ra(e.rc);!function(e,t,n,i){e.g=t,e.h=n,e.i=i}(n,(function(t){lu(e,"timelineregionenter",t)}),(function(t){lu(e,"timelineregionexit",t)}),(function(t,n){n||(lu(e,"timelineregionenter",t),lu(e,"timelineregionexit",t))}));var i=new Lo(e.g);return i.g.add(t),i.g.add(n),i}(e),c=Math.max(e.i.minBufferTime,e.h.streaming.rebufferingGoal),Hs(e,c),e.j=function(e){return new ua(e.i,{eb:function(){return e.A.l()},getBandwidthEstimate:function(){return e.u.getBandwidthEstimate()},T:e.M,Ib:e.X,ue:e.Vf.bind(e),te:e.Ze.bind(e),onError:e.Va.bind(e),onEvent:function(t){return e.dispatchEvent(t)},Zf:e.$f.bind(e),zd:e.eg.bind(e)})}(e),e.j.configure(e.h.streaming),Kn.$d(e.i,e.h.preferredAudioChannelCount),e.o=Au,e.dispatchEvent(new Ue("streaming")),k(i,e.j.start(),2);case 2:e.h.streaming.startAtSegmentBoundary&&(l=e.A.l(),d=function(e,t){function n(e,t){if(!e)return null;var n=e.findSegmentPosition(t-o.startTime);return null==n?null:(n=e.getSegmentReference(n))?n.startTime+o.startTime:null}var i=ca(e.j),r=la(e.j),o=bu(e);return i=n(i,t),null!=(r=n(r,t))&&null!=i?Math.max(r,i):null!=r?r:null!=i?i:t}(e,l),e.A.A(d)),e.i.periods.forEach(e.Xc.bind(e)),ou(e),ru(e),h=bu(e)||e.i.periods[0],p=h.variants.some((function(e){return e.primary})),e.h.preferredAudioLanguage||p||Y.v("No preferred audio language set.  We will choose an arbitrary language initially"),tu(e,h.variants),e.l.ya(r,"loadedmetadata",(function(){e.F.h=Date.now()/1e3-n.Rd})),A(i)}}))}))}(i,e,t))})),r.set(this.od,(function(e,t){return _e(function(e,t,n){return g((function i(){var r,o;return U(i,(function(i){switch(i.s){case 1:return r=pe,e.m=Fs(e,{Ib:e.X,onError:function(t){e.Va(t)},Dc:function(t){hu(e,t)},onExpirationUpdated:function(t,n){fu(e,t,n)},onEvent:function(t){e.dispatchEvent(t)}}),e.m.configure(e.h.drm),o={id:0,language:"und",primary:!1,audio:null,video:{id:0,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return null},getSegmentReference:function(){return null},initSegmentReference:null,presentationTimeOffset:0,mimeType:n.mimeType?n.mimeType.split(";")[0]:"video/mp4",codecs:n.mimeType?ct(n.mimeType):"",encrypted:!0,keyId:null,language:"und",label:null,type:r.Za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},bandwidth:100,drmInfos:[],allowedByApplication:!0,allowedByKeySystem:!0},k(i,St(e.m,[o],[]),2);case 2:return k(i,e.m.Ub(t.D),0)}}))}))}(i,e,t))})),r.set(this.xb,(function(e,t){return function(e,t,n){function i(){return eu(e)}if(t.uri=n.uri,t.startTime=n.startTime,e.Tb=t.uri,e.F=new _s,e.A=new Qo(t.D),null!=t.startTime&&e.A.A(t.startTime),e.J=new Fo({wc:function(){return t.D.playbackRate},vc:function(){return t.D.defaultPlaybackRate},Od:function(e){t.D.playbackRate=e},pe:function(e){t.D.currentTime+=e}}),Hs(e,e.h.streaming.rebufferingGoal),e.l.H(t.D,"playing",i),e.l.H(t.D,"pause",i),e.l.H(t.D,"ended",i),e.l.H(t.D,"ratechange",(function(){return Zs(e)})),"none"!=e.g.preload&&e.l.ya(t.D,"loadedmetadata",(function(){e.F.h=Date.now()/1e3-n.Rd})),e.g.audioTracks&&(e.l.H(e.g.audioTracks,"addtrack",(function(){return ou(e)})),e.l.H(e.g.audioTracks,"removetrack",(function(){return ou(e)})),e.l.H(e.g.audioTracks,"change",(function(){return ou(e)}))),e.g.textTracks){var r=e.g.textTracks;e.l.H(r,"addtrack",(function(){return ou(e)})),e.l.H(r,"removetrack",(function(){return ou(e)})),e.l.H(r,"change",(function(){return ou(e)}))}t.D.src=t.uri,(pt()||vt("Web0S"))&&t.D.load(),e.o=Mu,e.dispatchEvent(new Ue("streaming"));var o=new ge;Vo(e.g,HTMLMediaElement.HAVE_METADATA,e.l,(function(){o.resolve()}));var a=!1;return e.Wc.push((function(){a=!0})),Vo(e.g,HTMLMediaElement.HAVE_CURRENT_DATA,e.l,(function(){return g((function t(){return U(t,(function(t){switch(t.s){case 1:if(a)return t.return();if(function(e){var t=e.h.preferredAudioLanguage;if(""!=t){e.Jd(t);var n=e.h.preferredVariantRole;""!=n&&e.Jd(t,n)}}(e),qs(e).find((function(e){return"disabled"!=e.mode}))){t.I(2);break}return k(t,new Promise((function(t){e.l.ya(e.g.textTracks,"change",t),new Ie(t).V(1)})),2);case 2:if(a)return t.return();!function(e){var t=e.h.preferredTextLanguage;if(""!=t){e.Kd(t);var n=e.h.preferredTextRole;""!=n&&e.Kd(t,n)}}(e),A(t)}}))}))})),e.g.error?o.reject(du(e)):"none"==e.g.preload&&(Y.ba('With <video preload="none">, the browser will not load anything until play() is called. We are unable to measure load latency in a meaningful way, and we cannot provide track info yet. Please do not use preload="none" with Shaka Player.'),o.resolve()),e.l.ya(e.g,"error",(function(){o.reject(du(e))})),new Re(o,(function(){return o.reject(new $(2,7,7001)),Promise.resolve()}))}(i,e,t)})),this.Ya=new ws(this.P,{Af:function(e,t,n,r){var o=null;return e==i.P&&(o=n==i.P?i.P:i.da),e==i.da&&(o=n==i.P||t.D!=r.D?i.P:n==i.da?i.da:n==i.vb||n==i.ea?i.vb:n==i.xb?i.od:null),e==i.vb&&(o=n==i.ea&&t.D==r.D?i.nd:i.Qa),e==i.nd&&(o=Su(i.ea,i.md,i.Qa,n,t,r)),e==i.md&&(o=Su(i.ea,i.ad,i.Qa,n,t,r)),e==i.ad&&(o=Su(i.ea,i.ea,i.Qa,n,t,r)),e==i.od&&(o=n==i.xb&&t.D==r.D?i.xb:i.Qa),e!=i.ea&&e!=i.xb||(o=i.Qa),e==i.Qa&&(o=r.D&&t.D==r.D?i.da:i.P),o},ef:function(e,t,n){return i.dispatchEvent(new Ue("onstatechange",{state:e.name})),r.get(e)(t,n)},handleError:function(e,t){return g((function n(){return U(n,(function(n){switch(n.s){case 1:return Y.v("The walker saw an error:"),t instanceof $?Y.v("Error Code:",t.code):(Y.v("Error Message:",t.message),Y.v("Error Stack:",t.stack)),k(n,Bs(i,e),2);case 2:return n.return(e.D?i.da:i.P)}}))}))},Xf:function(e){i.dispatchEvent(new Ue("onstateidle",{state:e.name}))}}),t&&this.Ub(t,!0)}T(is,Xa),is.prototype.updateManifestExpiration=function(e,t){var n=za(this.h,this.g),i=n.store(),r=new ge;return i.get(e).onsuccess=function(n){(n=n.target.result)?(n.expiration=t,i.put(n),r.resolve()):r.reject(new $(2,9,9012,"Could not find values for "+e))},n.promise().then((function(){return r}))},is.prototype.pc=function(e){return{originalManifestUri:e.originalManifestUri,duration:e.duration,size:e.size,expiration:null==e.expiration?1/0:e.expiration,periods:e.periods.map(rs),sessionIds:e.sessionIds,drmInfo:e.drmInfo,appMetadata:e.appMetadata}},is.prototype.ae=function(e){return{data:e.data}},T(us,Xa),us.prototype.hasFixedKeySpace=function(){return this.j},us.prototype.addSegments=function(e){return this.j?Ya(this.i):this.add(this.i,e)},us.prototype.addManifests=function(e){return this.j?Ya(this.g):this.add(this.g,e)},us.prototype.pc=function(e){return null==e.expiration&&(e.expiration=1/0),e},(r=cs.prototype).init=function(){var t=this,n=new ge,i=e.indexedDB.open("shaka_offline_db",4);return i.onsuccess=function(e){e=e.target.result,t.j=e;var i=e.objectStoreNames;i.contains("manifest")&&i.contains("segment")?(Y.debug("Mounting v1 idb storage cell"),i=new is(e,"segment","manifest")):i=null,t.g=i,(i=e.objectStoreNames).contains("manifest-v2")&&i.contains("segment-v2")?(Y.debug("Mounting v2 idb storage cell"),i=new us(e,"segment-v2","manifest-v2",!0)):i=null,t.h=i,(i=e.objectStoreNames).contains("manifest-v3")&&i.contains("segment-v3")?(Y.debug("Mounting v3 idb storage cell"),i=new us(e,"segment-v3","manifest-v3",!1)):i=null,t.i=i,e.objectStoreNames.contains("session-ids")?(Y.debug("Mounting session ID idb storage cell"),e=new Qa(e)):e=null,t.l=e,n.resolve()},i.onupgradeneeded=function(e){e=e.target.result;for(var t=f(["segment-v3","manifest-v3","session-ids"]),n=t.next();!n.done;n=t.next())n=n.value,e.objectStoreNames.contains(n)||e.createObjectStore(n,{autoIncrement:!0})},i.onerror=function(e){n.reject(new $(2,9,9001,i.error)),e.preventDefault()},n},r.destroy=function(){var e=this;return g((function t(){return U(t,(function(t){switch(t.s){case 1:if(!e.g){t.I(2);break}return k(t,e.g.destroy(),2);case 2:if(!e.h){t.I(4);break}return k(t,e.h.destroy(),4);case 4:if(!e.i){t.I(6);break}return k(t,e.i.destroy(),6);case 6:if(!e.l){t.I(8);break}return k(t,e.l.destroy(),8);case 8:e.j&&e.j.close(),A(t)}}))}))},r.getCells=function(){var e=new Map;return this.g&&e.set("v1",this.g),this.h&&e.set("v2",this.h),this.i&&e.set("v3",this.i),e},r.getEmeSessionCell=function(){return this.l},r.erase=function(){var t=this;return g((function n(){return U(n,(function(n){switch(n.s){case 1:if(!t.g){n.I(2);break}return k(n,t.g.destroy(),2);case 2:if(!t.h){n.I(4);break}return k(n,t.h.destroy(),4);case 4:if(!t.i){n.I(6);break}return k(n,t.i.destroy(),6);case 6:return t.j&&t.j.close(),k(n,function(){var t=new ge,n=e.indexedDB.deleteDatabase("shaka_offline_db");return n.onblocked=function(){Y.v("Deleting","shaka_offline_db","is being blocked")},n.onsuccess=function(){t.resolve()},n.onerror=function(e){t.reject(new $(2,9,9001,n.error)),e.preventDefault()},t}(),8);case 8:return t.j=null,t.g=null,t.h=null,t.i=null,k(n,t.init(),0)}}))}))},ts("idb",(function(){return vt("CrKey")||!e.indexedDB?null:new cs})),ls.prototype.Ea=function(){return this.l},ls.prototype.ja=function(){return this.j},ls.prototype.key=function(){return this.i},ls.prototype.toString=function(){return this.h},(r=ms.prototype).configure=function(){},r.start=function(e){var t=this;return g((function n(){var i,r,o,a,s;return U(n,(function(n){switch(n.s){case 1:return i=ds(e),t.g=i,null==i||"manifest"!=i.g?n.return(Promise.reject(new $(2,1,9004,i))):(r=new Za,I(n,2),k(n,r.init(),4));case 4:return k(n,es(r,i.Ea(),i.ja()),5);case 5:return k(n,n.B.getManifests([i.key()]),6);case 6:return o=n.B,a=o[0],s=new hs(i.Ea(),i.ja()),n.return(function(e,t){var n=new wr(null,0);n.Fa(t.duration);var i=t.periods.map((function(t){return fs(e,t,n)})),r=t.drmInfo?[t.drmInfo]:[];return t.drmInfo&&i.forEach((function(e){e.variants.forEach((function(e){e.drmInfos=r}))})),{presentationTimeline:n,minBufferTime:2,offlineSessionIds:t.sessionIds,periods:i}}(s,a));case 2:return R(n),k(n,r.destroy(),7);case 7:N(n,0)}}))}))},r.stop=function(){return Promise.resolve()},r.update=function(){},r.onExpirationUpdated=function(e,t){var n=this;return g((function i(){var r,o,a,s,u,c,l,d;return U(i,(function(i){switch(i.s){case 1:return r=n.g,o=new Za,M(i,2,3),k(i,o.init(),5);case 5:return k(i,es(o,r.Ea(),r.ja()),6);case 6:return k(i,(a=i.B).getManifests([r.key()]),7);case 7:if(s=i.B,u=s[0],c=u.sessionIds.includes(e),l=null==u.expiration||u.expiration>t,!c||!l){i.I(3);break}return Y.debug("Updating expiration for stored content"),k(i,a.updateManifestExpiration(r.key(),t),3);case 3:return R(i),k(i,o.destroy(),10);case 10:N(i,0);break;case 2:d=C(i),Y.error("There was an error updating",r,d),i.I(3)}}))}))},br.Qb("application/x-offline-manifest",ms),V("shaka.offline.OfflineScheme",vs),vs.m=function(e){return je(e={uri:e,Bd:e,data:new ArrayBuffer(0),headers:{"content-type":"application/x-offline-manifest"}})},vs.o=function(e,t){var n=new Za;return je(void 0).ca((function(){return n.init()})).ca((function(){return es(n,t.Ea(),t.ja())})).ca((function(e){return e.getSegments([t.key()])})).ca((function(e){return{uri:t,Bd:t,data:e[0].data,headers:{}}})).finally((function(){return n.destroy()}))},Xe("offline",vs),ws.prototype.destroy=function(){var e=this;return g((function t(){return U(t,(function(t){switch(t.s){case 1:return e.u=!1,e.h&&e.h.abort(),Ss(e),k(t,e.A,2);case 2:e.g&&e.g.Da.kb();for(var n=f(e.l),i=n.next();!i.done;i=n.next())i.value.Da.kb();e.g=null,e.l=[],e.m=null,A(t)}}))}))},V("shaka.text.SimpleTextDisplayer",Es),Es.prototype.remove=function(e,t){return!!this.g&&(ks(this.g,(function(n){return n.startTime<t&&n.endTime>e})),!0)},Es.prototype.remove=Es.prototype.remove,Es.prototype.append=function(e){var t=xs,n=e.map((function(e){if(e.nestedCues.length){var t=e.nestedCues.map((function(e){return e.spacer?"\n":e.payload+" "})).join("").replace(/ $/m,"");(e=e.clone()).nestedCues=[],e.payload=t}return e})),i=[];e=this.g.cues?Array.from(this.g.cues):[];for(var r={},o=(n=f(n)).next();!o.done;r={Fb:r.Fb},o=n.next())r.Fb=o.value,e.some(function(e){return function(t){return t.startTime==e.Fb.startTime&&t.endTime==e.Fb.endTime&&t.text==e.Fb.payload}}(r))||(o=t(r.Fb))&&i.push(o);i.slice().sort((function(e,t){return e.startTime!=t.startTime?e.startTime-t.startTime:e.endTime!=t.endTime?e.endTime-t.startTime:"line"in VTTCue.prototype?i.indexOf(t)-i.indexOf(e):i.indexOf(e)-i.indexOf(t)})).forEach(function(e){this.g.addCue(e)}.bind(this))},Es.prototype.append=Es.prototype.append,Es.prototype.destroy=function(){return this.g&&ks(this.g,(function(){return!0})),this.g=null,Promise.resolve()},Es.prototype.destroy=Es.prototype.destroy,Es.prototype.isTextVisible=function(){return"showing"==this.g.mode},Es.prototype.isTextVisible=Es.prototype.isTextVisible,Es.prototype.setTextVisibility=function(e){this.g.mode=e?"showing":"hidden"},Es.prototype.setTextVisibility=Es.prototype.setTextVisibility,V("shaka.util.ConfigUtils.mergeConfigObjects",As),V("shaka.util.ConfigUtils.convertToConfigObject",Ms),V("shaka.util.PlayerConfiguration",Is),Is.mergeConfigObjects=Cs,G(Ls,Ke),V("shaka.Player",Ls),Ls.prototype.destroy=function(){var e=this;return g((function t(){var n;return U(t,(function(t){switch(t.s){case 1:return e.o==xu?t.return():(e.o=xu,n=Ts(e.Ya,(function(){return{node:e.P,payload:{Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},gb:!1}})),k(t,new Promise((function(t){n.Kb=function(){Y.info("Preparing to destroy walker...")},n.Cc=function(){t(),e.dispatchEvent(new Ue("loaded"))},n.kb=function(){t()},n.onError=function(){t()},n.Ec=function(){t()}})),2));case 2:return k(t,e.Ya.destroy(),3);case 3:if(e.l&&(e.l.release(),e.l=null),e.Uc=null,e.u=null,e.h=null,!e.X){t.I(0);break}return k(t,e.X.destroy(),5);case 5:e.X=null,A(t)}}))}))},Ls.prototype.destroy=Ls.prototype.destroy,Ls.version="v2.5.23";var Us=["2","5"];zn=new function(e){this.g=e,this.i=Gn,this.h=qn}(new Hn(Number(Us[0]),Number(Us[1])));var Os=["output-restricted","internal-error"],Ks={};function Bs(e,t){return g((function n(){var i;return U(n,(function(n){switch(n.s){case 1:return e.o!=xu&&(e.o=ku),i=e.Wc.map((function(e){return e()})),e.Wc=[],k(n,Promise.all(i),2);case 2:if(e.dispatchEvent(new Ue("unloading")),t.Ia=null,t.mimeType=null,t.startTime=null,t.uri=null,t.D&&(e.l.ta(t.D,"loadedmetadata"),e.l.ta(t.D,"playing"),e.l.ta(t.D,"pause"),e.l.ta(t.D,"ended"),e.l.ta(t.D,"ratechange")),e.wb&&(e.wb.release(),e.wb=null),e.ic&&(e.ic.stop(),e.ic=null),!e.C){n.I(3);break}return k(n,e.C.stop(),4);case 4:e.C=null;case 3:if(!e.u){n.I(5);break}return k(n,e.u.stop(),5);case 5:if(!e.j){n.I(7);break}return k(n,e.j.destroy(),8);case 8:e.j=null;case 7:if(e.J&&(e.J.release(),e.J=null),e.A&&(e.A.release(),e.A=null),!e.M){n.I(9);break}return k(n,e.M.destroy(),10);case 10:e.M=null;case 9:if(!t.D||!t.D.src){n.I(11);break}return k(n,new Promise((function(e){return new Ie(e).V(.1)})),12);case 12:t.D.removeAttribute("src"),t.D.load();case 11:if(!e.m){n.I(13);break}return k(n,e.m.destroy(),14);case 14:e.m=null;case 13:e.Z.g.clear(),e.Tb=null,e.L=null,e.lc.clear(),e.i=null,e.F=null,e.fd=null,e.yb=!0,Qs(e),A(n)}}))}))}function Fs(e,t){return new Tt(t,e.h.drm.updateExpirationTime)}function Hs(e,t){e.L=new Mo,e.L.g=Po,Io(e.L,t,Math.min(.5,t/2)),Qs(e),e.ic=new Ie((function(){Vs(e)})).Oa(.25)}function Vs(e){switch(e.o){case Mu:var t=!!e.g.ended||zt(e.g.buffered)>=e.g.duration-1;break;case Au:e:if(e.g.ended||En(e.M))t=!0;else{if(e.i.presentationTimeline.aa()){var n=e.i.presentationTimeline.Db();if(zt(e.g.buffered)>=n){t=!0;break e}}t=!1}break;default:t=!1}var i=Xt(e.g.buffered,e.g.currentTime),r=t,o=(n=e.L).h.get(n.g);t=n.g,i=r||i>=o?Co:Po,n.g=i,t!=i&&Qs(e)}function Gs(e){if(e.C){var t=Be(e.h.manifest);e.g&&"AUDIO"===e.g.nodeName&&(t.disableVideo=!0),e.C.configure(t)}if(e.m&&e.m.configure(e.h.drm),e.j){e.j.configure(e.h.streaming);try{e.i.periods.forEach(e.Xc.bind(e))}catch(t){e.Va(t)}var n=ca(e.j),i=la(e.j);t=bu(e),n=Kn.ie(n,i,t.variants),e.u&&n&&n.allowedByApplication&&n.allowedByKeySystem?tu(e,t.variants):(Y.debug("Choosing new streams after changing configuration"),nu(e,t))}if(e.M&&(t=e.h.textDisplayFactory,e.fd!=t)){n=new t;var r=(i=e.M).l;i.l=n,r&&(n.setTextVisibility(r.isTextVisible()),r.destroy()),i.g&&(i.g.i=n),e.fd=t,e.j&&((n=(t=e.j).h.get("text"))&&ga(t,n.stream,!0,0,!0))}e.u&&(e.u.configure(e.h.abr),e.h.abr.enabled&&!e.yb?e.u.enable():e.u.disable(),cu(e)),e.L&&(t=e.h.streaming.rebufferingGoal,e.i&&(t=Math.max(t,e.i.minBufferTime)),Io(e.L,t,Math.min(.5,t/2)))}function qs(e){return Array.from(e.g.textTracks).filter((function(e){return"metadata"!=e.kind&&"chapters"!=e.kind&&"Shaka Player TextTrack"!=e.label}))}function zs(e,t,n,i){bo(e.Z,t).variant=n,(e=e.F.i).i!=n&&(e.i=n,e.g.push({timestamp:Date.now()/1e3,id:n.id,type:"variant",fromAdaptation:i,bandwidth:n.bandwidth}))}function Ws(e,t,n,i){yo(e.Z,t,n),(e=e.F.i).h!=n&&(e.h=n,e.g.push({timestamp:Date.now()/1e3,id:n.id,type:"text",fromAdaptation:i,bandwidth:null}))}function Xs(e){var t=Ps();return t.streaming.failureCallback=function(t){e.aa()&&[1001,1002,1003].includes(t.code)&&(t.severity=1,Y.v("Live streaming error.  Retrying automatically..."),e.Id())},t.textDisplayFactory=function(){return new Es(e.g)},t}function Ys(e,t){var n=e.j?ca(e.j):null,i=e.j?la(e.j):null;if(t.forEach(Kn.filterNewPeriod.bind(null,e.m,n,i)),0==(n=function(e,t){var n=0;return e.forEach((function(e){n+=t(e)?1:0})),n}(t,(function(e){return e.variants.some(Kn.Gb)}))))throw new $(2,4,4032);if(n<t.length)throw new $(2,4,4011);t.forEach(function(e){Kn.Xd(e.variants,this.h.restrictions,this.mc)&&this.j&&bu(this)==e&&ou(this),pu(this,e.variants)}.bind(e))}function $s(e,t,n,i){return n=void 0!==n&&n,i=void 0===i?0:i,e.yb?(e.wa=t,e.qe=n,e.oe=i,!0):((t=pa(e.j,t,n,i))&&au(e),t)}function Js(e,t){if(e.yb)return e.va=t,!0;var n=ga(e.j,t,!0,0,!1);return n&&su(e),n}function Qs(e){var t=e.jd();if(e.F&&e.L&&e.A){var n=e.J;n.j=t,Ho(n),eu(e)}e.dispatchEvent(new Ue("buffering",{buffering:t}))}function Zs(e){var t=e.g.playbackRate;0!=t&&e.J.set(t)}function eu(e){if(e.F&&e.L){var t=e.F.g;e.L.g==Po?Ns(t,"buffering"):e.g.paused?Ns(t,"paused"):e.g.ended?Ns(t,"ended"):Ns(t,"playing")}}function tu(e,t){try{pu(e,t)}catch(t){return e.Va(t),null}var n=t.filter((function(e){return Kn.Gb(e)}));return n=e.tb.create(n),e.u.setVariants(Array.from(n.values())),e.u.chooseVariant()}function nu(e,t){var n=iu(e,t,!1),i=Kn.Wb(t.textStreams,e.ua,e.Xa)[0]||null,r=!1;i&&(e.h.streaming.alwaysStreamText||e.zc())&&(Ws(e,t,i,!0),r=Js(e,i)),(n||r)&&ru(e)}function iu(e,t,n){n=void 0===n||n;var i=tu(e,t.variants),r=!1;return i&&(zs(e,t,i,!0),r=$s(e,i,!0)),n&&r&&ru(e),r}function ru(e){gu(e,new Ue("adaptation"))}function ou(e){gu(e,new Ue("trackschanged"))}function au(e){gu(e,new Ue("variantchanged"))}function su(e){gu(e,new Ue("textchanged"))}function uu(e){gu(e,new Ue("texttrackvisibility"))}function cu(e){gu(e,new Ue("abrstatuschanged",{Zg:e.h.abr.enabled}))}function lu(e,t,n){e.dispatchEvent(new Ue(t,{detail:{schemeIdUri:n.schemeIdUri,value:n.value,startTime:n.startTime,endTime:n.endTime,id:n.id,eventElement:n.eventElement}}))}function du(e){if(!e.g.error)return null;var t=e.g.error.code;if(1==t)return null;var n=e.g.error.msExtendedCode;return n&&(0>n&&(n+=Math.pow(2,32)),n=n.toString(16)),new $(2,3,3016,t,n,e.g.error.message)}function hu(e,t){if(e.j){var n=bu(e),i=!1,r=Object.keys(t);0==r.length&&Y.v("Got a key status event without any key statuses, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks.");var o=1==r.length&&"00"==r[0];o&&Y.v("Got a synthetic key status event, so we don't know the real key statuses. If we don't have all the keys, you'll need to set restrictions so we don't select those tracks."),r.length&&e.i.periods.forEach((function(e){e.variants.forEach((function(e){Kn.Kf(e).forEach((function(n){var r=e.allowedByKeySystem;n.keyId&&(n=t[o?"00":n.keyId],e.allowedByKeySystem=!!n&&!Os.includes(n)),r!=e.allowedByKeySystem&&(i=!0)}))}))})),r=ca(e.j);var a=la(e.j);(r=Kn.ie(r,a,n.variants))&&!r.allowedByKeySystem&&(Y.debug("Choosing new variants after key status changed"),iu(e,n)),i&&(ou(e),tu(e,n.variants))}}function fu(e,t,n){e.C&&e.C.onExpirationUpdated&&e.C.onExpirationUpdated(t,n),e.dispatchEvent(new Ue("expirationupdated"))}function pu(e,t){var n=e.m?st(e.m.da):{},i=Object.keys(n);i=i.length&&"00"==i[0];for(var r=!1,o=!1,a=[],s=[],u=f(t),c=u.next();!c.done;c=u.next()){var l=[];(c=c.value).audio&&l.push(c.audio),c.video&&l.push(c.video);for(var d=(l=f(l)).next();!d.done;d=l.next())if((d=d.value).keyId){var h=n[i?"00":d.keyId];h?Os.includes(h)&&(s.includes(h)||s.push(h)):a.includes(d.keyId)||a.push(d.keyId)}c.allowedByApplication?c.allowedByKeySystem&&(r=!0):o=!0}if(!r)throw new $(2,4,4012,{hasAppRestrictions:o,missingKeys:a,restrictedKeyStatuses:s})}function gu(e,t){g((function n(){return U(n,(function(n){switch(n.s){case 1:return k(n,Promise.resolve(),2);case 2:e.o!=xu&&e.dispatchEvent(t),A(n)}}))}))}function mu(e){for(var t=new Set,n=(e=f(e)).next();!n.done;n=e.next())(n=n.value).language?t.add(_n(n.language)):t.add("und");return t}function vu(e){for(var t=new Map,n=(e=f(e)).next();!n.done;n=e.next()){var i=n.value;n="und";var r=[];for(i.language&&(n=_n(i.language)),(r="variant"==i.type?i.audioRoles:i.roles)&&r.length||(r=[""]),t.has(n)||t.set(n,new Set),r=(i=f(r)).next();!r.done;r=i.next())r=r.value,t.get(n).add(r)}var o=[];return t.forEach((function(e,t){for(var n=f(e),i=n.next();!i.done;i=n.next())o.push({language:t,role:i.value})})),o}function yu(e){return null==(e=bu(e))?[]:e.variants.filter((function(e){return Kn.Gb(e)}))}function bu(e){for(var t=e.A.l(),n=null,i=(e=f(e.i.periods)).next();!i.done;i=e.next())(i=i.value).startTime<=t&&(n=i);return n}function wu(e){var t=bu(e);return bo(e.Z,t).variant}function Tu(){return new $(2,7,7e3)}function Su(e,t,n,i,r,o){return i==e&&r.D==o.D&&r.uri==o.uri&&r.mimeType==o.mimeType&&r.Ia==o.Ia?t:n}function Eu(e){return new Promise((function(t,n){e.kb=function(){return n(Tu())},e.Cc=function(){return t()},e.onError=function(e){return n(e)},e.Ec=function(){return n(Tu())}}))}Ls.registerSupportPlugin=function(e,t){Ks[e]=t},Ls.isBrowserSupported=function(){if(!(e.Promise&&e.Uint8Array&&Array.prototype.forEach))return!1;var t=mt();return!(t&&12>t||!(e.MediaKeys&&e.navigator&&e.navigator.requestMediaKeySystemAccess&&e.MediaKeySystemAccess&&e.MediaKeySystemAccess.prototype.getConfiguration))&&(!!ht()||ft("application/x-mpegurl"))},Ls.probeSupport=function(){return _t().then((function(e){for(var t=br.ng(),n={},i=f('video/mp4; codecs="avc1.42E01E",video/mp4; codecs="avc3.42E01E",video/mp4; codecs="hev1.1.6.L93.90",video/mp4; codecs="hvc1.1.6.L93.90",video/mp4; codecs="hev1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="hvc1.2.4.L153.B0"; eotf="smpte2084",video/mp4; codecs="vp9",video/mp4; codecs="vp09.00.10.08",video/mp4; codecs="av01.0.01M.08",audio/mp4; codecs="mp4a.40.2",audio/mp4; codecs="ac-3",audio/mp4; codecs="ec-3",audio/mp4; codecs="opus",audio/mp4; codecs="flac",video/webm; codecs="vp8",video/webm; codecs="vp9",video/webm; codecs="vp09.00.10.08",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="avc3.42E01E",video/mp2t; codecs="hvc1.1.6.L93.90",video/mp2t; codecs="mp4a.40.2",video/mp2t; codecs="ac-3",video/mp2t; codecs="ec-3",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",")),r=i.next();!r.done;r=i.next()){n[r=r.value]=ht()?!!mn(r)||(MediaSource.isTypeSupported(r)||ke(r)):ft(r);var o=r.split(";")[0];n[o]=n[o]||n[r]}for(var a in e={manifest:t,media:n,drm:e},Ks)e[a]=Ks[a]();return e}))},Ls.prototype.Ub=function(e,t){if(t=void 0===t||t,this.o==xu)return Promise.reject(Tu());var n={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null};n.D=e,ht()||(t=!1);var i=t?this.vb:this.da,r=Ts(this.Ya,(function(){return{node:i,payload:n,gb:!1}}));return r.Kb=function(){return Y.info("Starting attach...")},Eu(r)},Ls.prototype.attach=Ls.prototype.Ub,Ls.prototype.detach=function(){var e=this;if(this.o==xu)return Promise.reject(Tu());var t=Ts(this.Ya,(function(){return{node:e.P,payload:{Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},gb:!1}}));return t.Kb=function(){return Y.info("Starting detach...")},Eu(t)},Ls.prototype.detach=Ls.prototype.detach,Ls.prototype.Ud=function(e){var t=this;if(e=void 0===e||e,this.o==xu)return Promise.reject(Tu());ht()||(e=!1);var n={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null},i=Ts(this.Ya,(function(i){var r=i.D&&e?t.vb:i.D?t.da:t.P;return n.D=i.D,{node:r,payload:n,gb:!1}}));return i.Kb=function(){return Y.info("Starting unload...")},Eu(i)},Ls.prototype.unload=Ls.prototype.Ud,Ls.prototype.load=function(e,t,n){if(this.o==xu)return Promise.reject(Tu());this.dispatchEvent(new Ue("loading"));var i={Ia:null,D:null,mimeType:null,startTime:null,Rd:null,uri:null};i.uri=e,i.Rd=Date.now()/1e3,n&&"string"!=typeof n&&(Vn("Loading with a manifest parser factory","Please register a manifest parser and for the mime-type."),i.Ia=function(){return new n}),n&&"string"==typeof n&&(i.mimeType=n),void 0!==t&&(i.startTime=t);var r=function(e,t){if(t.Ia)return!1;if(!ht())return!0;var n=t.mimeType,i=t.uri||"";return n||(n={mp4:"video/mp4",m4v:"video/mp4",m4a:"audio/mp4",webm:"video/webm",weba:"audio/webm",mkv:"video/webm",ts:"video/mp2t",ogv:"video/ogg",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",m3u8:"application/x-mpegurl",mp3:"audio/mpeg",aac:"audio/aac",flac:"audio/flac",wav:"audio/wav"}[br.getExtension(i)]),!!n&&(""!=(t.D||yt()).canPlayType(n)&&(!br.isSupported(i,n)||gt()&&e.h.streaming.useNativeHlsOnSafari))}(this,i)?this.xb:this.ea,o=Ts(this.Ya,(function(e){return null==e.D?null:(i.D=e.D,{node:r,payload:i,gb:!0})}));return o.Kb=function(){return Y.info("Starting load of "+e+"...")},new Promise((function(e,t){o.Ec=function(){return t(new $(2,7,7002))},o.Cc=function(){return e()},o.kb=function(){return t(Tu())},o.onError=function(e){return t(e)}}))},Ls.prototype.load=Ls.prototype.load,Ls.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ms(e,t));var n=Cs(this.h,e,Xs(this));return Gs(this),n},Ls.prototype.configure=Ls.prototype.configure,Ls.prototype.getConfiguration=function(){var e=Xs(this);return Cs(e,this.h,Xs(this)),e},Ls.prototype.getConfiguration=Ls.prototype.getConfiguration,Ls.prototype.vg=function(){for(var e in this.h)delete this.h[e];Cs(this.h,Xs(this),Xs(this)),Gs(this)},Ls.prototype.resetConfiguration=Ls.prototype.vg,Ls.prototype.tf=function(){return this.o},Ls.prototype.getLoadMode=Ls.prototype.tf,Ls.prototype.yf=function(){return this.g},Ls.prototype.getMediaElement=Ls.prototype.yf,Ls.prototype.Yb=function(){return this.X},Ls.prototype.getNetworkingEngine=Ls.prototype.Yb,Ls.prototype.tc=function(){return this.Tb},Ls.prototype.getAssetUri=Ls.prototype.tc,Ls.prototype.wf=function(){return Vn("getManifestUri",'Please use "getAssetUri" instead.'),this.tc()},Ls.prototype.getManifestUri=Ls.prototype.wf,Ls.prototype.aa=function(){return this.i?this.i.presentationTimeline.aa():!(!this.g||!this.g.src)&&1/0==this.g.duration},Ls.prototype.isLive=Ls.prototype.aa,Ls.prototype.ib=function(){return!!this.i&&this.i.presentationTimeline.ib()},Ls.prototype.isInProgress=Ls.prototype.ib,Ls.prototype.Qf=function(){if(this.i){if(!this.i.periods.length)return!1;var e=this.i.periods[0].variants;return!!e.length&&!e[0].video}return!(!this.g||!this.g.src)&&(this.g.videoTracks?0==this.g.videoTracks.length:0==this.g.videoHeight)},Ls.prototype.isAudioOnly=Ls.prototype.Qf,Ls.prototype.He=function(){if(this.i){var e=this.i.presentationTimeline;return{start:e.Cb(),end:e.Ka()}}return this.g&&this.g.src&&(e=this.g.seekable).length?{start:e.start(0),end:e.end(e.length-1)}:{start:0,end:0}},Ls.prototype.seekRange=Ls.prototype.He,Ls.prototype.keySystem=function(){return Mt(this.drmInfo())},Ls.prototype.keySystem=Ls.prototype.keySystem,Ls.prototype.drmInfo=function(){return this.m?this.m.g:null},Ls.prototype.drmInfo=Ls.prototype.drmInfo,Ls.prototype.Xb=function(){return this.m?this.m.Xb():1/0},Ls.prototype.getExpiration=Ls.prototype.Xb,Ls.prototype.jd=function(){return!!this.L&&this.L.g==Po},Ls.prototype.isBuffering=Ls.prototype.jd,Ls.prototype.Cf=function(){if(this.J){var e=this.J;e=e.j?0:e.i}else e=0;return e},Ls.prototype.getPlaybackRate=Ls.prototype.Cf,Ls.prototype.Mg=function(e){0==e?Y.ba("A trick play rate of 0 is unsupported!"):(this.g.paused&&this.g.play(),this.J&&this.J.set(e),this.o==Au&&fa(this.j,1<Math.abs(e)))},Ls.prototype.trickPlay=Ls.prototype.Mg,Ls.prototype.$e=function(){var e=this.J.vc();this.o==Mu&&this.J.set(e),this.o==Au&&(this.J.set(e),fa(this.j,!1))},Ls.prototype.cancelTrickPlay=Ls.prototype.$e,Ls.prototype.ed=function(){if(this.i&&this.A){for(var e=wu(this),t=[],n=f(yu(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=Kn.Oc(i);r.active=i==e,t.push(r)}return t}return this.g&&this.g.audioTracks?Array.from(this.g.audioTracks).map((function(e){return Kn.je(e)})):[]},Ls.prototype.getVariantTracks=Ls.prototype.ed,Ls.prototype.Eb=function(){if(this.i&&this.A){for(var e=function(e){var t=bu(e);if(null==t)return null;if(!bo(e.Z,t).text){var n=Kn.Wb(t.textStreams,e.ua,e.Xa);n.length&&yo(e.Z,t,n[0])}return bo(e.Z,t).text}(this),t=[],n=f(function(e){var t=bu(e);return null==t?[]:t.textStreams.filter((function(t){return!e.lc.has(t)}))}(this)),i=n.next();!i.done;i=n.next()){i=i.value;var r=Kn.Kc(i);r.active=i==e,t.push(r)}return t}return this.g&&this.g.src&&this.g.textTracks?qs(this).map((function(e){return Kn.Of(e)})):[]},Ls.prototype.getTextTracks=Ls.prototype.Eb,Ls.prototype.Ld=function(e){if(this.i&&this.j){var t=bu(this),n=t.textStreams.find((function(t){return t.id==e.id}));n?(Ws(this,t,n,!1),Js(this,n),this.ua=n.language):Y.error("No stream with id",e.id)}else if(this.g&&this.g.src&&this.g.textTracks){for(n=(t=f(t=qs(this))).next();!n.done;n=t.next())n=n.value,Kn.gd(n)==e.id?n.mode=this.ub?"showing":"hidden":n.mode="disabled";su(this)}},Ls.prototype.selectTextTrack=Ls.prototype.Ld,Ls.prototype.xg=function(){Vn("selectEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. Please use SelectTextTrack.");var e=this.Eb().filter((function(e){return"application/cea-608"==e.mimeType}));0<e.length?this.Ld(e[0]):Y.v("Unable to find the text track embedded in the video.")},Ls.prototype.selectEmbeddedTextTrack=Ls.prototype.xg,Ls.prototype.Rg=function(){Vn("usingEmbeddedTextTrack","If closed captions are signaled in the manifest, a text stream will be created to represent them. There should be no reason to know if the player is playing embedded text.");var e=this.Eb().filter((function(e){return e.active}))[0];return!!e&&"application/cea-608"==e.mimeType},Ls.prototype.usingEmbeddedTextTrack=Ls.prototype.Rg,Ls.prototype.Ie=function(e,t,n){if(n=void 0===n?0:n,this.i&&this.j){var i=bu(this);this.h.abr.enabled&&Y.ba("Changing tracks while abr manager is enabled will likely result in the selected track being overriden. Consider disabling abr before calling selectVariantTrack().");var r=i.variants.find((function(t){return t.id==e.id}));r?Kn.Gb(r)?(zs(this,i,r,!1),$s(this,r,t,n),this.tb=new ko(r),tu(this,i.variants)):Y.error("Unable to switch to restricted track",e.id):Y.error("No variant with id",e.id)}else if(this.g&&this.g.audioTracks){for(n=(t=f(t=Array.from(this.g.audioTracks))).next();!n.done;n=t.next())n=n.value,Kn.gd(n)==e.id&&(n.enabled=!0);au(this)}},Ls.prototype.selectVariantTrack=Ls.prototype.Ie,Ls.prototype.nf=function(){return vu(this.ed())},Ls.prototype.getAudioLanguagesAndRoles=Ls.prototype.nf,Ls.prototype.Jf=function(){return vu(this.Eb())},Ls.prototype.getTextLanguagesAndRoles=Ls.prototype.Jf,Ls.prototype.mf=function(){return Array.from(mu(this.ed()))},Ls.prototype.getAudioLanguages=Ls.prototype.mf,Ls.prototype.If=function(){return Array.from(mu(this.Eb()))},Ls.prototype.getTextLanguages=Ls.prototype.If,Ls.prototype.Jd=function(e,t){if(this.i&&this.A){var n=bu(this);if(this.tb=new Ao(e,t||"",0,""),!this.h.abr.enabled){var i=function(e,t){return e.video||t.video?e.video&&t.video?Math.abs((e.video.height||0)-(t.video.height||0))+Math.abs((e.video.width||0)-(t.video.width||0)):1/0:0},r=bu(this)||this.i.periods[0],o=bo(this.Z,r).variant,a=this.tb.create(r.variants);r=null;for(var s=(a=f(a.values())).next();!s.done;s=a.next())s=s.value,(!r||i(r,o)>i(s,o))&&(r=s);if(r)return n=Kn.Oc(r),void this.Ie(n,!0)}iu(this,n)}else if(this.g&&this.g.audioTracks){for(r=Array.from(this.g.audioTracks),n=_n(e),o=i=null,a=(r=f(r)).next();!a.done;a=r.next())a=a.value,_n((s=Kn.je(a)).language)==n&&(i=a,t?s.roles.includes(t)&&(o=a):0==s.roles.length&&(o=a));o?(o.enabled=!0,au(this)):i&&(i.enabled=!0,au(this))}},Ls.prototype.selectAudioLanguage=Ls.prototype.Jd,Ls.prototype.Kd=function(e,t){if(this.i&&this.A){var n=bu(this);this.ua=e,this.Xa=t||"";var i=Kn.Wb(n.textStreams,this.ua,this.Xa)[0]||null;i&&(Ws(this,n,i,!1),(this.h.streaming.alwaysStreamText||this.zc())&&Js(this,i))}else{var r=_n(e);(n=this.Eb().filter((function(e){return _n(e.language)==r&&(!t||e.roles.includes(t))}))[0])&&this.Ld(n)}},Ls.prototype.selectTextLanguage=Ls.prototype.Kd,Ls.prototype.yg=function(e){if(this.i&&this.A){for(var t=bu(this),n=null,i=f(yu(this)),r=i.next();!r.done;r=i.next())if((r=r.value).audio.label==e){n=r;break}null==n?Y.v("No variants were found with label: "+e+". Ignoring the request to switch."):(this.tb=new Ao(n.language,"",0,e),iu(this,t))}},Ls.prototype.selectVariantsByLabel=Ls.prototype.yg,Ls.prototype.zc=function(){var e=this.ub;return this.M?this.M.l.isTextVisible():this.g&&this.g.src&&this.g.textTracks?qs(this).some((function(e){return"showing"==e.mode})):e},Ls.prototype.isTextTrackVisible=Ls.prototype.zc,Ls.prototype.Bg=function(e){var t=this;return g((function n(){var i,r,o,a;return U(n,(function(n){switch(n.s){case 1:if(t.ub==(i=!!e))return n.return();if(t.ub=i,t.o!=Au){if(t.g&&t.g.src&&t.g.textTracks)for(var s=f(qs(t)),u=s.next();!u.done;u=s.next())"disabled"!=(r=u.value).mode&&(r.mode=i?"showing":"hidden");n.I(2);break}if(t.M.l.setTextVisibility(i),t.h.streaming.alwaysStreamText){n.I(2);break}if(!i){!function(e){e.L=!0;var t=e.h.get("text");t&&(Da(t),ja(t).catch((function(){})),e.h.delete("text"))}(t.j),n.I(2);break}if(da(t.j,"text")){n.I(2);break}if(o=bu(t),!(0<(a=Kn.Wb(o.textStreams,t.ua,t.Xa)).length)){n.I(2);break}return k(n,ha(t.j,a[0]),2);case 2:uu(t),A(n)}}))}))},Ls.prototype.setTextTrackVisibility=Ls.prototype.Bg,Ls.prototype.Ef=function(){if(!this.aa())return Y.v("getPlayheadTimeAsDate is for live streams!"),null;var e=this.Ya.j,t=0;if(this.A)t=this.A.l();else if(e){if(null==e.startTime)return new Date;t=e.startTime}return this.i?new Date(1e3*(this.i.presentationTimeline.j+this.g.currentTime)):this.g&&this.g.getStartDate?(e=this.g.getStartDate(),isNaN(e.getTime())?(Y.v("EXT-X-PROGRAM-DATETIME required to get playhead time as Date!"),null):new Date(e.getTime()+1e3*t)):(Y.v("No way to get playhead time as Date!"),null)},Ls.prototype.getPlayheadTimeAsDate=Ls.prototype.Ef,Ls.prototype.Gf=function(){if(!this.aa())return Y.v("getPresentationStartTimeAsDate is for live streams!"),null;if(this.i)return new Date(1e3*this.i.presentationTimeline.j);if(this.g&&this.g.getStartDate){var e=this.g.getStartDate();return isNaN(e.getTime())?(Y.v("EXT-X-PROGRAM-DATETIME required to get presentation start time as Date!"),null):e}return Y.v("No way to get presentation start time as Date!"),null},Ls.prototype.getPresentationStartTimeAsDate=Ls.prototype.Gf,Ls.prototype.bd=function(){var e={total:[],audio:[],video:[],text:[]};return this.o==Mu&&(e.total=Yt(this.g.buffered)),this.o==Au&&this.M.bd(e),e},Ls.prototype.getBufferedInfo=Ls.prototype.bd,Ls.prototype.getStats=function(){if(this.o!=Au&&this.o!=Mu)return{width:NaN,height:NaN,streamBandwidth:NaN,decodedFrames:NaN,droppedFrames:NaN,corruptedFrames:NaN,estimatedBandwidth:NaN,loadLatency:NaN,playTime:NaN,pauseTime:NaN,bufferingTime:NaN,licenseTime:NaN,switchHistory:[],stateHistory:[]};eu(this);var e=this.g;if(e.getVideoPlaybackQuality){e=e.getVideoPlaybackQuality();var t=this.F,n=Number(e.totalVideoFrames);t.A=Number(e.droppedVideoFrames),t.u=n,this.F.o=Number(e.corruptedVideoFrames)}this.m?e=(e=this.m).P?e.P:NaN:e=NaN,this.F.m=e,this.o==Au&&((e=wu(this))&&(this.F.C=e.bandwidth),e&&e.video&&(t=this.F,n=e.video.height||NaN,t.F=e.video.width||NaN,t.l=n),e=this.u.getBandwidthEstimate(),this.F.j=e);var i=this.F;e=i.F,t=i.l,n=i.C;for(var r=i.u,o=i.A,a=i.o,s=i.j,u=i.h,c=Ds(i.g,"playing"),l=Ds(i.g,"paused"),d=Ds(i.g,"buffering"),h=i.m,p=function(e){function t(e){return{timestamp:e.timestamp,state:e.state,duration:e.duration}}for(var n=[],i=f(e.h),r=i.next();!r.done;r=i.next())n.push(t(r.value));return e.g&&n.push(t(e.g)),n}(i.g),g=[],m=(i=f(i.i.g)).next();!m.done;m=i.next())m=m.value,g.push({timestamp:m.timestamp,id:m.id,type:m.type,fromAdaptation:m.fromAdaptation,bandwidth:m.bandwidth});return{width:e,height:t,streamBandwidth:n,decodedFrames:r,droppedFrames:o,corruptedFrames:a,estimatedBandwidth:s,loadLatency:u,playTime:c,pauseTime:l,bufferingTime:d,licenseTime:h,stateHistory:p,switchHistory:g}},Ls.prototype.getStats=Ls.prototype.getStats,Ls.prototype.addTextTrack=function(e,t,n,i,r,o){var a=this;return g((function s(){var u,c,l,d,h,f,p,g,m;return U(s,(function(s){switch(s.s){case 1:if(a.o==Mu)throw Y.error("Cannot add text when loaded with src="),Error("State error!");if(a.o!=Au)throw Y.error("Must call load() and wait for it to resolve before adding text tracks."),Error("State error!");if(u=bu(a),c=pe,l=a.i.periods.indexOf(u),h=(d=l+1)>=a.i.periods.length?a.i.presentationTimeline.ha():a.i.periods[d].startTime,1/0==(f=h-u.startTime))throw new $(1,4,4033);return p=new tr(1,0,f,(function(){return[e]}),0,null),g={id:a.re++,originalId:null,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function(){return 1},getSegmentReference:function(e){return 1==e?p:null},initSegmentReference:null,presentationTimeOffset:0,mimeType:i,codecs:r||"",kind:n,encrypted:!1,keyId:null,language:t,label:o||null,type:c.za,primary:!1,frameRate:void 0,pixelAspectRatio:void 0,trickModeVideo:null,emsgSchemeIdUris:null,roles:[],channelsCount:null,audioSamplingRate:null,closedCaptions:null},a.lc.add(g),u.textStreams.push(g),k(s,ha(a.j,g),2);case 2:return(m=da(a.j,"text"))&&yo(a.Z,u,m),a.lc.delete(g),Y.debug("Choosing new streams after adding a text stream"),nu(a,u),ou(a),s.return(Kn.Kc(g))}}))}))},Ls.prototype.addTextTrack=Ls.prototype.addTextTrack,Ls.prototype.Nd=function(e,t){this.mc.width=e,this.mc.height=t},Ls.prototype.setMaxHardwareResolution=Ls.prototype.Nd,Ls.prototype.Id=function(){if(this.o==Au){var e=this.j;if(e.j)Y.error("Unable to retry after StreamingEngine is destroyed!"),e=!1;else if(e.A)Y.error("Unable to retry after StreamingEngine encountered a fatal error!"),e=!1;else{for(var t=f(e.h.values()),n=t.next();!n.done;n=t.next()){var i=La(n=n.value);n.ac&&(Y.info(i,"Retrying after failure..."),n.ac=!1,Na(e,n,.1))}e=!0}}else e=!1;return e},Ls.prototype.retryStreaming=Ls.prototype.Id,Ls.prototype.uf=function(){return this.i},Ls.prototype.getManifest=Ls.prototype.uf,Ls.prototype.vf=function(){return this.C?this.C.constructor:null},Ls.prototype.getManifestParserFactory=Ls.prototype.vf,(r=Ls.prototype).Xc=function(e){var t=this.j?ca(this.j):null,n=this.j?la(this.j):null;if(Kn.filterNewPeriod(this.m,t,n,e),!(t=e.variants).some(Kn.Gb))throw new $(2,4,4011);if(pu(this,e.variants),Kn.Xd(t,this.h.restrictions,this.mc)&&this.j&&bu(this)==e&&ou(this),(e=this.m?this.m.g:null)&&this.m.o)for(n=(t=f(t)).next();!n.done;n=t.next())for(var i=(n=f(n.value.drmInfos)).next();!i.done;i=n.next())if((i=i.value).keySystem==e.keySystem)for(var r=(i=f(i.initData||[])).next();!r.done;r=i.next())r=r.value,At(this.m,r.initDataType,r.initData)},r.Vf=function(e){Y.debug("onChooseStreams_",e);try{Y.O("onChooseStreams_, choosing variant from ",e.variants),Y.O("onChooseStreams_, choosing text from ",e.textStreams),this.yb=!0,this.u.disable(),cu(this),Y.debug("Choosing new streams after period changed");var t=tu(this,e.variants),n=Kn.Wb(e.textStreams,this.ua,this.Xa)[0]||null;this.wa&&(e.variants.includes(this.wa)&&(t=this.wa),this.wa=null),this.va&&(e.textStreams.includes(this.va)&&(n=this.va),this.va=null),t&&zs(this,e,t,!0),n&&Ws(this,e,n,!0);var i=this.j,r=i.h.get("video");if(r)var o=i.i.periods[r.oa];else{var a=i.h.get("audio");o=a?i.i.periods[a.oa]:null}var s=t?t.audio:null;if(!o&&n){var u;if(u=s){e=n;var c=_n(this.h.preferredTextLanguage),l=_n(s.language),d=_n(e.language);u=Dn(d,c)&&!Dn(l,d)}u&&(this.ub=!0),this.ub&&this.M.l.setTextVisibility(!0),uu(this)}var h=this.h.streaming.alwaysStreamText||this.zc()?{variant:t,text:n}:{variant:t,text:null};return Y.O("onChooseStreams_, chose variant ",h.variant),Y.O("onChooseStreams_, chose text ",h.text),h}catch(e){return this.Va(e),{variant:null,text:null}}},r.Ze=function(){Y.debug("canSwitch_"),this.yb=!1,this.h.abr.enabled&&(this.u.enable(),cu(this)),this.wa&&(pa(this.j,this.wa,this.qe,this.oe),au(this),this.wa=null),this.va&&(ga(this.j,this.va,!0,0,!1),su(this),this.va=null)},r.$f=function(){this.C&&this.C.update&&this.C.update()},r.eg=function(){this.A&&this.A.C()},r.Va=function(e){if(this.o!=xu){var t=new Ue("error",{detail:e});this.dispatchEvent(t),t.defaultPrevented&&(e.handled=!0)}};var xu=0,ku=1,Au=2,Mu=3;function Iu(e,t){var n=fs(new hs(e.Ea(),e.ja()),t.periods[0],new wr(null,0)),i=t.appMetadata||{};return n=Pu(n),{offlineUri:e.toString(),originalManifestUri:t.originalManifestUri,duration:t.duration,size:t.size,expiration:t.expiration,tracks:n,appMetadata:i}}function Pu(e){for(var t=[],n=Kn.Bf(e.variants),i=(n=f(n)).next();!i.done;i=n.next())t.push(Kn.Oc(i.value));for(n=(e=f(e.textStreams)).next();!n.done;n=e.next())t.push(Kn.Kc(n.value));return t}function Cu(){this.g={}}function Ru(e,t){var n=t.audio,i=t.video;if(n&&!i&&(e.g[n.id]=n.bandwidth||t.bandwidth),!n&&i&&(e.g[i.id]=i.bandwidth||t.bandwidth),n&&i){var r=n.bandwidth||393216,o=i.bandwidth||t.bandwidth-r;0>=o&&(Y.v("Audio bit rate consumes variants bandwidth. Setting video bandwidth to match variant's bandwidth."),o=t.bandwidth),e.g[n.id]=r,e.g[i.id]=o}}function Nu(e,t){var n=e.g[t];return null==n&&(n=0,Y.error("Asking for bitrate of stream not given to the estimator")),0==n&&Y.v("Using bitrate of 0, this stream won't affect progress"),n}function Du(e){this.g=!1,this.h=new ge,this.i=e}function ju(e){var t=new Lu;e.periods.forEach((function(e,n){var i=Ou(e.variants);if(0==n)for(var r=(i=f(i.g)).next();!r.done;r=i.next())t.add(r.value);else!function(e,t){e.g=e.g.filter((function(e){return Uu(t,e)}))}(t,i)}));for(var n=(e=f(e.periods)).next();!n.done;n=e.next())(n=n.value).variants=n.variants.filter((function(e){return Uu(t,new _u(e))}))}function _u(e){var t=e.audio;e=e.video,this.h=t?t.mimeType:null,this.g=t?t.codecs.split(".")[0]:null,this.j=e?e.mimeType:null,this.i=e?e.codecs.split(".")[0]:null}function Lu(){this.g=[]}function Uu(e,t){return e.g.some((function(e){return t.h==e.h&&t.g==e.g&&t.j==e.j&&t.i==e.i}))}function Ou(e){for(var t=new Lu,n=(e=f(e)).next();!n.done;n=e.next())t.add(new _u(n.value));return t}function Ku(e){var t=this;if(e&&e.constructor!=Ls)throw new $(2,9,9008);this.h=this.g=null,e?(this.g=e.h,this.h=e.Yb()):(this.g=Ps(),this.h=new ze),this.j=!1,this.i=[],this.l=[];var n=!e;this.m=new Du((function(){return g((function e(){var i;return U(e,(function(e){switch(e.s){case 1:return i=function(){},k(e,Promise.all(t.l.map((function(e){return e.then(i,i)}))),2);case 2:if(!n){e.I(3);break}return k(e,t.h.destroy(),3);case 3:t.g=null,t.h=null,A(e)}}))}))}))}function Bu(){if(ht())e:{for(var e=f(ns.values()),t=e.next();!t.done;t=e.next())if(t=(t=t.value)()){t.destroy(),e=!0;break e}e=!1}else e=!1;return e}function Fu(e,t){for(var n=[],i=f(e.periods),r=i.next();!r.done;r=i.next())for(var o=(r=f(r.value.streams)).next();!o.done;o=r.next())o=o.value,t&&"video"==o.contentType?n.push({contentType:ut(o.mimeType,o.codecs),robustness:e.drmInfo.videoRobustness}):t||"audio"!=o.contentType||n.push({contentType:ut(o.mimeType,o.codecs),robustness:e.drmInfo.audioRobustness});return n}function Hu(e,t,n){return g((function i(){return U(i,(function(i){switch(i.s){case 1:return k(i,function(e,t,n,i){return g((function r(){var o,a,s;return U(r,(function(r){switch(r.s){case 1:return i.drmInfo?(o=function(e){var t=Array.from(e.g.keys());if(!t.length)throw new $(2,9,9e3,"No supported storage mechanisms found");return e.g.get(t[0]).getEmeSessionCell()}(n),a=i.sessionIds.map((function(e){return{sessionId:e,keySystem:i.drmInfo.keySystem,licenseUri:i.drmInfo.licenseServerUri,serverCertificate:i.drmInfo.serverCertificate,audioCapabilities:Fu(i,!1),videoCapabilities:Fu(i,!0)}})),k(r,ys(t,e,a),2)):r.return();case 2:return s=r.B,k(r,o.remove(s),3);case 3:return k(r,o.add(a.filter((function(e){return-1==s.indexOf(e.sessionId)}))),0)}}))}))}(e.h,e.g.drm,n,t),0)}}))}))}function Vu(e,t,n,i){function r(){s+=1,e.g.offline.progressCallback(u,s/a)}var o=function(e){var t=[];return e.periods.forEach((function(e){e.streams.forEach((function(e){null!=e.initSegmentKey&&t.push(e.initSegmentKey),e.segments.forEach((function(e){t.push(e.dataKey)}))}))})),t}(i),a=o.length+1,s=0,u=Iu(n,i);return Promise.all([t.removeSegments(o,r),t.removeManifests([n.key()],r)])}function Gu(e,t,n,i,r,o){var a={id:o.id,originalId:o.originalId,primary:o.primary,presentationTimeOffset:o.presentationTimeOffset||0,contentType:o.type,mimeType:o.mimeType,codecs:o.codecs,frameRate:o.frameRate,pixelAspectRatio:o.pixelAspectRatio,kind:o.kind,language:o.language,label:o.label,width:o.width||null,height:o.height||null,initSegmentKey:null,encrypted:o.encrypted,keyId:o.keyId,segments:[],variantIds:[]};r=r.presentationTimeline.$b();var s=o.id,u=o.initSegmentReference;return u&&(u=Tr(u.i(),u.h,u.g,e.g.streaming.retryParameters),Ha(t,s,u,.5*Nu(i,o.id),!0,(function(t){return g((function i(){var r;return U(i,(function(i){switch(i.s){case 1:return k(i,n.addSegments([{data:t}]),2);case 2:r=i.B,e.i.push(r[0]),a.initSegmentKey=r[0],A(i)}}))}))}))),function(e,t,n){for(var i=null==(t=e.findSegmentPosition(t))?null:e.getSegmentReference(t);i;)n(i),i=e.getSegmentReference(++t)}(o,r,(function(r){var u=Tr(r.i(),r.h,r.g,e.g.streaming.retryParameters);Ha(t,s,u,function(e,t,n){return n=n.endTime-n.startTime,Nu(e,t)*n}(i,o.id,r),!1,(function(t){return g((function i(){var o;return U(i,(function(i){switch(i.s){case 1:return k(i,n.addSegments([{data:t}]),2);case 2:o=i.B,e.i.push(o[0]),a.segments.push({startTime:r.startTime,endTime:r.endTime,dataKey:o[0]}),A(i)}}))}))}))})),a}function qu(e){if(e.m.g)throw new $(2,9,7001)}function zu(){if(!Bu())throw new $(2,9,9e3)}function Wu(e,t){return g((function n(){return U(n,(function(n){switch(n.s){case 1:return e.l.push(t),I(n,2),k(n,t,4);case 4:return n.return(n.B);case 2:R(n),He(e.l,t),N(n,0)}}))}))}function Xu(e){var t=new Set(e.variants.map((function(e){return e.video}))),n=new Set(e.variants.map((function(e){return e.audio})));e=e.textStreams,1<t.size&&Y.v("Multiple video tracks selected to be stored");for(var i=(t=f(n)).next();!i.done;i=t.next()){i=i.value;for(var r=f(n),o=r.next();!o.done;o=r.next())i!=(o=o.value)&&i.language==o.language&&Y.v("Similar audio tracks were selected to be stored",i.id,o.id)}for(t=(n=f(e)).next();!t.done;t=n.next())for(t=t.value,r=(i=f(e)).next();!r.done;r=i.next())t!=(r=r.value)&&t.language==r.language&&Y.v("Similar text tracks were selected to be stored",t.id,r.id)}Ls.LoadMode={DESTROYED:xu,NOT_LOADED:ku,MEDIA_SOURCE:Au,SRC_EQUALS:Mu},Du.prototype.destroy=function(){var e=this;return this.g?this.h:(this.g=!0,this.i().then((function(){e.h.resolve()}),(function(){e.h.resolve()})))},Lu.prototype.add=function(e){Uu(this,e)||this.g.push(e)},V("shaka.offline.Storage",Ku),Ku.support=Bu,Ku.prototype.destroy=function(){return this.m.destroy()},Ku.prototype.destroy=Ku.prototype.destroy,Ku.prototype.configure=function(e,t){2==arguments.length&&"string"==typeof e&&(e=Ms(e,t));var n=e,i=!1;return null!=n.trackSelectionCallback&&(i=!0,n.offline=n.offline||{},n.offline.trackSelectionCallback=n.trackSelectionCallback,delete n.trackSelectionCallback),null!=n.progressCallback&&(i=!0,n.offline=n.offline||{},n.offline.progressCallback=n.progressCallback,delete n.progressCallback),null!=n.usePersistentLicense&&(i=!0,n.offline=n.offline||{},n.offline.usePersistentLicense=n.usePersistentLicense,delete n.usePersistentLicense),i&&Vn("Storage.configure with OfflineConfig","Please configure storage with a player configuration."),Cs(this.g,e)},Ku.prototype.configure=Ku.prototype.configure,Ku.prototype.getConfiguration=function(){var e=Ps();return Cs(e,this.g,Ps()),e},Ku.prototype.getConfiguration=Ku.prototype.getConfiguration,Ku.prototype.Yb=function(){return this.h},Ku.prototype.getNetworkingEngine=Ku.prototype.Yb,Ku.prototype.store=function(e,t,n){var i=this;return Wu(this,function(e,t,n,i){return g((function r(){var o,a,s,u,c,l,d,h,p;return U(r,(function(r){switch(r.s){case 1:return zu(),e.j?r.return(Promise.reject(new $(2,9,9006))):(e.j=!0,k(r,function(e,t,n){return g((function i(){var r,o,a,s,u,c;return U(i,(function(i){switch(i.s){case 1:return r=null,o=e.h,a={networkingEngine:o,filterAllPeriods:function(){},filterNewPeriod:function(){},onTimelineRegionAdded:function(){},onEvent:function(){},onError:function(e){r=e}},k(i,n(),2);case 2:return(s=i.B).configure(e.g.manifest),qu(e),I(i,3),k(i,s.start(t,a),5);case 5:return u=i.B,qu(e),c=function(e){for(var t=new Set,n=(e=f(e.periods)).next();!n.done;n=e.next()){for(var i=f((n=n.value).textStreams),r=i.next();!r.done;r=i.next())t.add(r.value);for(n=f(n.variants),i=n.next();!i.done;i=n.next())(i=i.value).audio&&t.add(i.audio),i.video&&t.add(i.video)}return t}(u),k(i,Promise.all(rt(c,(function(e){return e.createSegmentIndex()}))),6);case 6:if(qu(e),r)throw r;return i.return(u);case 3:return R(i),k(i,s.stop(),7);case 7:N(i,0)}}))}))}(e,t,i),2));case 2:if(o=r.B,qu(e),!(!o.presentationTimeline.aa()&&!o.presentationTimeline.ib()))throw new $(2,9,9005,t);return a=null,s=new Za,c=u=null,M(r,3,4),k(r,function(e,t,n){return g((function i(){var r,o,a;return U(i,(function(i){switch(i.s){case 1:return r=new Tt({Ib:e.h,onError:n,Dc:function(){},onExpirationUpdated:function(){},onEvent:function(){}}),o=Oo(t.periods),a=e.g,r.configure(a.drm),k(i,function(e,t,n){return e.F=[],e.L=n,Et(e,t)}(r,o,a.offline.usePersistentLicense),2);case 2:return k(i,xt(r),3);case 3:return k(i,kt(r),4);case 4:return i.return(r)}}))}))}(e,o,(function(e){c=c||e})),6);case 6:if(a=r.B,qu(e),c)throw c;return k(r,function(e,t,n){return g((function i(){var r,o;return U(i,(function(i){switch(i.s){case 1:return r={width:1/0,height:1/0},function(e,t,n){for(var i=(e=f(e.periods)).next();!i.done;i=e.next())(i=i.value).variants=i.variants.filter((function(e){return Kn.rd(e,t,n)}))}(t,e.g.restrictions,r),function(e){for(var t=(e=f(e.periods)).next();!t.done;t=e.next())(t=t.value).variants=t.variants.filter((function(e){var t=!0;return e.audio&&(t=t&&Tn(e.audio)),e.video&&(t=t&&Tn(e.video)),t}))}(t),function(e,t){for(var n=f(e.periods),i=n.next();!i.done;i=n.next())(i=i.value).variants=i.variants.filter((function(e){return Lt(t,e)}))}(t,n),ju(t),o=e.g.preferredAudioChannelCount,Kn.$d(t,o),k(i,function(e,t){return g((function n(){var i,r,o,a;return U(n,(function(n){switch(n.s){case 1:i=null,r=f(e.periods),o=r.next();case 2:if(o.done){n.I(0);break}return a=o.value,i&&(a.variants=a.variants.filter((function(e){return Uu(i,new _u(e))}))),k(n,t(a),5);case 5:i=Ou(a.variants),o=r.next(),n.I(2)}}))}))}(t,(function(t){return g((function n(){var i,r,o,a,s,u,c,l;return U(n,(function(n){switch(n.s){case 1:i=Kn,r=[];for(var d=f(t.variants),h=d.next();!h.done;h=d.next())o=h.value,r.push(i.Oc(o));for(h=(d=f(t.textStreams)).next();!h.done;h=d.next())a=h.value,r.push(i.Kc(a));return k(n,e.g.offline.trackSelectionCallback(r),2);case 2:for(s=n.B,u=new Set,c=new Set,h=(d=f(s)).next();!h.done;h=d.next())"variant"==(l=h.value).type&&u.add(l.id),"text"==l.type&&c.add(l.id);t.variants=t.variants.filter((function(e){return u.has(e.id)})),t.textStreams=t.textStreams.filter((function(e){return c.has(e.id)})),A(n)}}))}))})),2);case 2:(function(e){if(0==e.periods.length)throw new $(2,4,4014);for(var t=(e=f(e.periods)).next();!t.done;t=e.next())Xu(t.value)})(t),A(i)}}))}))}(e,o,a),7);case 7:return k(r,s.init(),8);case 8:return qu(e),k(r,function(e){var t=null;if(e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){e.hasFixedKeySpace()||t||(t={path:{Ea:n,ja:i},ja:e})}))})),t)return t;throw new $(2,9,9013,"Could not find a cell that supports add-operations")}(s),9);case 9:return u=r.B,qu(e),k(r,function(e,t,n,i,r,o){return g((function a(){var s,u,c,l,d,h,p,m,v,y;return U(a,(function(a){switch(a.s){case 1:return s=function(e,t,n){var i=null==t.expiration?1/0:t.expiration;return{offlineUri:null,originalManifestUri:e,duration:t.presentationTimeline.ha(),size:0,expiration:i,tracks:t=Pu(t.periods[0]),appMetadata:n}}(r,i,o),u=i.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos&&e.drmInfos.length}))})),c=i.periods.some((function(e){return e.variants.some((function(e){return e.drmInfos.some((function(e){return e.initData&&e.initData.length}))}))})),d=null,(l=u&&!c)&&(h=n.g,d=Yu.get(h.keySystem)),p=new Fa(e.h,(function(t,n){s.size=n,e.g.offline.progressCallback(s,t)}),(function(t,i){l&&e.g.offline.usePersistentLicense&&d==i&&At(n,"cenc",t)})),I(a,2),v=m=function(e,t,n,i,r,o,a){var s=new Cu,u=r.periods.map((function(i){return function(e,t,n,i,r,o){for(var a=f(o.variants),s=a.next();!s.done;s=a.next())Ru(i,s.value);for(a=f(o.textStreams),s=a.next();!s.done;s=a.next())i.g[s.value.id]=52;a=function(e){for(var t=new Set,n=f(e.textStreams),i=n.next();!i.done;i=n.next())t.add(i.value);for(e=f(e.variants),n=e.next();!n.done;n=e.next())(n=n.value).audio&&t.add(n.audio),n.video&&t.add(n.video);return t}(o);var u=new Map;for(a=f(a),s=a.next();!s.done;s=a.next()){s=s.value;var c=Gu(e,t,n,i,r,s);u.set(s.id,c)}return o.variants.forEach((function(e){e.audio&&u.get(e.audio.id).variantIds.push(e.id),e.video&&u.get(e.video.id).variantIds.push(e.id)})),{startTime:o.startTime,streams:Array.from(u.values())}}(e,t,n,s,r,i)})),c=i.g,l=e.g.offline.usePersistentLicense;return c&&l&&(c.initData=[]),{originalManifestUri:o,duration:r.presentationTimeline.ha(),size:0,expiration:i.Xb(),periods:u,sessionIds:l?Pt(i):[],drmInfo:c,appMetadata:a}}(e,p,t,n,i,r,o),k(a,function(e){return g((function t(){return U(t,(function(t){switch(t.s){case 1:return k(t,Promise.all(e.h.values()),2);case 2:return t.return(e.g.g)}}))}))}(p),4);case 4:if(v.size=a.B,m.expiration=n.Xb(),y=Pt(n),m.sessionIds=e.g.offline.usePersistentLicense?y:[],u&&e.g.offline.usePersistentLicense&&!y.length)throw new $(2,9,9007);return a.return(m);case 2:return R(a),k(a,p.destroy(),5);case 5:N(a,0)}}))}))}(e,u.ja,a,o,t,n),10);case 10:if(l=r.B,qu(e),c)throw c;return k(r,u.ja.addManifests([l]),11);case 11:return d=r.B,qu(e),h=new ls("manifest",u.path.Ea,u.path.ja,d[0]),r.return(Iu(h,l));case 4:return R(r),e.j=!1,e.i=[],k(r,s.destroy(),12);case 12:if(!a){r.I(13);break}return k(r,a.destroy(),13);case 13:N(r,0);break;case 3:if(p=C(r),!u){r.I(15);break}return k(r,u.ja.removeSegments(e.i,(function(){})),15);case 15:throw c||p}}))}))}(this,e,t||{},(function(){return g((function t(){var r,o;return U(t,(function(t){switch(t.s){case 1:return n&&"string"!=typeof n?(Vn("Storing with a manifest parser factory","Please register a manifest parser and for the mime-type."),r=n,t.return(new r)):k(t,br.create(e,i.h,i.g.manifest.retryParameters,n),2);case 2:return o=t.B,t.return(o)}}))}))})))},Ku.prototype.store=Ku.prototype.store,Ku.prototype.Hf=function(){return this.j},Ku.prototype.getStoreInProgress=Ku.prototype.Hf,Ku.prototype.remove=function(e){return Wu(this,function(e,t){return g((function n(){var i,r,o,a,s,u;return U(n,(function(n){switch(n.s){case 1:return zu(),null==(i=ds(t))||"manifest"!=i.g?n.return(Promise.reject(new $(2,9,9004,t))):(r=i,o=new Za,I(n,2),k(n,o.init(),4));case 4:return k(n,es(o,r.Ea(),r.ja()),5);case 5:return k(n,(a=n.B).getManifests([r.key()]),6);case 6:return s=n.B,u=s[0],k(n,Promise.all([Hu(e,u,o),Vu(e,a,r,u)]),2);case 2:return R(n),k(n,o.destroy(),8);case 8:N(n,0)}}))}))}(this,e))},Ku.prototype.remove=Ku.prototype.remove,Ku.prototype.sg=function(){return Wu(this,function(e){return g((function t(){var n,i,r,o,a,s,u,c,l;return U(t,(function(t){switch(t.s){case 1:return zu(),n=e.h,i=e.g.drm,r=new Za,o=!1,I(t,2),k(t,r.init(),4);case 4:for(a=[],function(e,t){e.g.forEach((function(e){t(e.getEmeSessionCell())}))}(r,(function(e){return a.push(e)})),s=Promise.resolve(),u={},c=f(a),l=c.next();!l.done;u={Jc:u.Jc},l=c.next())u.Jc=l.value,s=s.then(function(e){return function(){return g((function t(){var r,a;return U(t,(function(t){switch(t.s){case 1:return k(t,e.Jc.getAll(),2);case 2:return r=t.B,k(t,ys(i,n,r),3);case 3:return a=t.B,k(t,e.Jc.remove(a),4);case 4:a.length!=r.length&&(o=!0),A(t)}}))}))}}(u));return k(t,s,2);case 2:return R(t),k(t,r.destroy(),6);case 6:N(t,3);break;case 3:return t.return(!o)}}))}))}(this))},Ku.prototype.removeEmeSessions=Ku.prototype.sg,Ku.prototype.list=function(){return Wu(this,g((function e(){var t,n,i;return U(e,(function(e){switch(e.s){case 1:return zu(),t=[],n=new Za,I(e,2),k(e,n.init(),4);case 4:return i=Promise.resolve(),function(e,t){e.g.forEach((function(e,n){e.getCells().forEach((function(e,i){t({Ea:n,ja:i},e)}))}))}(n,(function(e,n){i=i.then((function(){return g((function i(){return U(i,(function(i){switch(i.s){case 1:return k(i,n.getAllManifests(),2);case 2:i.B.forEach((function(n,i){var r=Iu(new ls("manifest",e.Ea,e.ja,i),n);t.push(r)})),A(i)}}))}))}))})),k(e,i,2);case 2:return R(e),k(e,n.destroy(),6);case 6:N(e,3);break;case 3:return e.return(t)}}))})))},Ku.prototype.list=Ku.prototype.list,Ku.deleteAll=function(){return g((function e(){var t;return U(e,(function(e){switch(e.s){case 1:return t=new Za,I(e,2),k(e,t.erase(),2);case 2:return R(e),k(e,t.destroy(),5);case 5:N(e,0)}}))}))};var Yu=(new Map).set("org.w3.clearkey","1077efecc0b24d02ace33c1e52e2fb4b").set("com.widevine.alpha","edef8ba979d64acea3c827dcd51d21ed").set("com.microsoft.playready","9a04f07998404286ab92e65be0885f95").set("com.adobe.primetime","f239e769efa348509c16a903c6932efb");Ks.offline=Bu,V("shaka.polyfill.installAll",(function(){for(var e=0;e<Qu.length;++e)try{Qu[e].Xe()}catch(e){Y.ba("Error installing polyfill!",e)}}));var $u,Ju,Qu=[];function Zu(e,t){for(var n={priority:t=t||0,Xe:e},i=0;i<Qu.length;i++)if(Qu[i].priority<t)return void Qu.splice(i,0,n);Qu.push(n)}function ec(e){var t=e.type.replace(/^(webkit|moz|MS)/,"").toLowerCase();if("function"==typeof Event)var n=new Event(t,e);else(n=document.createEvent("Event")).initEvent(t,e.bubbles,e.cancelable);e.target.dispatchEvent(n)}function tc(e,t,n){if("input"==e)switch(this.type){case"range":e="change"}HTMLInputElement.prototype.originalAddEventListener.call(this,e,t,n)}function nc(){var e=MediaSource.prototype.addSourceBuffer;MediaSource.prototype.addSourceBuffer=function(t){for(var n=[],i=0;i<arguments.length;++i)n[i]=arguments[i];return(n=e.apply(this,n)).abort=function(){},n}}function ic(e,t){Y.debug("PatchedMediaKeysApple.requestMediaKeySystemAccess");try{var n=new rc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function rc(e,t){if(Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess"),this.keySystem=e,e.startsWith("com.apple.fps"))for(var n=f(t),i=n.next();!i.done;i=n.next()){var r=i.value;if("required"==r.persistentState)i=null;else{i={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label};var o=!1,a=!1;if(r.audioCapabilities)for(var s=f(r.audioCapabilities),u=s.next();!u.done;u=s.next())if((u=u.value).contentType){o=!0;var c=u.contentType.split(";")[0];WebKitMediaKeys.isTypeSupported(this.keySystem,c)&&(i.audioCapabilities.push(u),a=!0)}if(r.videoCapabilities)for(u=(r=f(r.videoCapabilities)).next();!u.done;u=r.next())(s=u.value).contentType&&(o=!0,u=s.contentType.split(";")[0],WebKitMediaKeys.isTypeSupported(this.keySystem,u)&&(i.videoCapabilities.push(s),a=!0));o||(a=WebKitMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),i=a?i:null}if(i)return void(this.g=i)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function oc(e){Y.debug("PatchedMediaKeysApple.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&sc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?sc(e,this):Promise.resolve()}function ac(e){Y.debug("PatchedMediaKeysApple.MediaKeys"),this.h=new WebKitMediaKeys(e),this.g=new Ze}function sc(e,t){if(e.g.nb(),!t)return Promise.resolve();e.g.H(t,"webkitneedkey",cc);try{return Vo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.webkitSetMediaKeys(e.h)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function uc(e){Y.debug("PatchedMediaKeysApple.MediaKeySession"),Ke.call(this),this.h=null,this.l=e,this.i=this.g=null,this.j=new Ze,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new dc}function cc(e){if(Y.debug("PatchedMediaKeysApple.onWebkitNeedKey_",e),e=new Uint8Array(e.initData),new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!0)+4!=e.byteLength)throw new RangeError("Malformed FairPlay init data");e=be(e=ve(e.subarray(4),!0));var t=new Event("encrypted");t.initDataType="skd",t.initData=e,this.dispatchEvent(t)}function lc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,e.dispatchEvent(new Ue("keystatuseschange"))}function dc(){this.size=0,this.g=void 0}function hc(e,t){Y.debug("PatchedMediaKeysMs.requestMediaKeySystemAccess");try{var n=new fc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function fc(e,t){Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess"),this.keySystem=e;for(var n=!1,i=0;i<t.length;++i){var r=t[i],o={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:r.initDataTypes,sessionTypes:["temporary"],label:r.label},a=!1;if(r.audioCapabilities)for(var s=0;s<r.audioCapabilities.length;++s){var u=r.audioCapabilities[s];if(u.contentType){a=!0;var c=u.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.audioCapabilities.push(u),n=!0)}}if(r.videoCapabilities)for(s=0;s<r.videoCapabilities.length;++s)(u=r.videoCapabilities[s]).contentType&&(a=!0,c=u.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,c)&&(o.videoCapabilities.push(u),n=!0));if(a||(n=MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4")),"required"==r.persistentState&&(n=!1),n)return void(this.g=o)}throw(n=Error("Unsupported keySystem")).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function pc(e){Y.debug("PatchedMediaKeysMs.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&mc(t,null),delete this.mediaKeys,(this.mediaKeys=e)?mc(e,this):Promise.resolve()}function gc(e){Y.debug("PatchedMediaKeysMs.MediaKeys"),this.h=new MSMediaKeys(e),this.g=new Ze}function mc(e,t){if(e.g.nb(),!t)return Promise.resolve();e.g.H(t,"msneedkey",yc);try{return Vo(t,HTMLMediaElement.HAVE_METADATA,e.g,(function(){t.msSetMediaKeys(e.h)})),Promise.resolve()}catch(e){return Promise.reject(e)}}function vc(e){Y.debug("PatchedMediaKeysMs.MediaKeySession"),Ke.call(this),this.i=null,this.l=e,this.h=this.g=null,this.j=new Ze,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new wc}function yc(e){if(Y.debug("PatchedMediaKeysMs.onMsNeedKey_",e),e.initData){var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",t.initData=function(e){if(!e)return e;var t=new Hi(e);if(1>=t.data.length)return e;e=[];for(var n={},i=(t=f(t.data)).next();!i.done;n={yc:n.yc},i=t.next())n.yc=i.value,e.some(function(e){return function(t){return Ee.Ha(t,e.yc)}}(n))||e.push(n.yc);return Ee.concat.apply(Ee,e instanceof Array?e:function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(f(e)))}(e.initData).buffer,this.dispatchEvent(t)}}function bc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,e.dispatchEvent(new Ue("keystatuseschange"))}function wc(){this.size=0,this.g=void 0}function Tc(){return Y.debug("PatchedMediaKeysNop.requestMediaKeySystemAccess"),Promise.reject(Error("The key system specified is not supported."))}function Sc(e){return Y.debug("PatchedMediaKeysNop.setMediaKeys"),null==e?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function Ec(){throw new TypeError("Illegal constructor.")}function xc(){throw new TypeError("Illegal constructor.")}V("shaka.polyfill.register",Zu),Zu((function(){Ll()}),-1),Zu((function(){if(e.Document){var t=Element.prototype;t.requestFullscreen=t.requestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen||t.webkitRequestFullscreen,(t=Document.prototype).exitFullscreen=t.exitFullscreen||t.mozCancelFullScreen||t.msExitFullscreen||t.webkitCancelFullScreen,"fullscreenElement"in document||(Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement||document.webkitFullscreenElement}}),Object.defineProperty(document,"fullscreenEnabled",{get:function(){return document.mozFullScreenEnabled||document.msFullscreenEnabled||document.webkitFullscreenEnabled}})),document.addEventListener("webkitfullscreenchange",ec),document.addEventListener("webkitfullscreenerror",ec),document.addEventListener("mozfullscreenchange",ec),document.addEventListener("mozfullscreenerror",ec),document.addEventListener("MSFullscreenChange",ec),document.addEventListener("MSFullscreenError",ec)}})),Zu((function(){Y.debug("InputEvent.install"),vt("Trident/")&&!HTMLInputElement.prototype.originalAddEventListener&&(Y.info("Patching input event support on IE."),HTMLInputElement.prototype.originalAddEventListener=HTMLInputElement.prototype.addEventListener,HTMLInputElement.prototype.addEventListener=tc)})),Zu((function(){navigator.languages||Object.defineProperty(navigator,"languages",{get:function(){return navigator.language?[navigator.language]:["en"]}})})),Zu((function(){Y.debug("mathRound.install")})),Zu((function(){Y.debug("MediaSource.install");var t=mt();e.MediaSource?e.cast&&cast.__platform__&&cast.__platform__.canDisplayType?(Y.info("Patching Chromecast MSE bugs."),function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){var n=t.split(/ *; */);return n.shift(),n.some((function(e){return e.startsWith("codecs=")}))?cast.__platform__.canDisplayType(t):e(t)}}()):t?(function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"mp2t"!=t.split(/ *; */)[0].split("/")[1].toLowerCase()&&e(t)}}(),12>=t?(Y.info("Patching Safari 11 & 12 MSE bugs."),nc(),function(){var e=SourceBuffer.prototype.remove;SourceBuffer.prototype.remove=function(t,n){return e.call(this,t,n-.001)}}()):(Y.info("Patching Safari 13 MSE bugs."),nc())):vt("Tizen 2")||vt("Tizen 3")||vt("Tizen 4")?function(){var e=MediaSource.isTypeSupported;MediaSource.isTypeSupported=function(t){return"opus"!=lt(t)[0]&&e(t)}}():Y.info("Using native MSE as-is."):Y.info("No MSE implementation available.")})),rc.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess.createMediaKeys");var e=new ac(this.keySystem);return Promise.resolve(e)},rc.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySystemAccess.getConfiguration"),this.g},ac.prototype.createSession=function(e){if(Y.debug("PatchedMediaKeysApple.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new uc(this.h,e)},ac.prototype.setServerCertificate=function(e){return Y.debug("PatchedMediaKeysApple.MediaKeys.setServerCertificate"),e&&new Uint8Array(e),Promise.resolve(!0)},G(uc,Ke),(r=uc.prototype).generateRequest=function(e,t){Y.debug("PatchedMediaKeysApple.MediaKeySession.generateRequest"),this.g=new ge;try{this.h=this.l.createSession("video/mp4",new Uint8Array(t)),this.sessionId=this.h.sessionId||"",this.j.H(this.h,"webkitkeymessage",this.Gg.bind(this)),this.j.H(this.h,"webkitkeyadded",this.Eg.bind(this)),this.j.H(this.h,"webkitkeyerror",this.Fg.bind(this)),lc(this,"status-pending")}catch(e){this.g.reject(e)}return this.g},r.load=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){Y.debug("PatchedMediaKeysApple.MediaKeySession.update"),this.i=new ge;try{this.h.update(new Uint8Array(e))}catch(e){this.i.reject(e)}return this.i},r.close=function(){Y.debug("PatchedMediaKeysApple.MediaKeySession.close");try{this.h.close(),this.closed.resolve(),this.j.nb()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Y.debug("PatchedMediaKeysApple.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},r.Gg=function(e){Y.debug("PatchedMediaKeysApple.onWebkitKeyMessage_",e),this.g&&(this.g.resolve(),this.g=null),this.dispatchEvent(new Ue("message",{messageType:null==this.keyStatuses.g?"license-request":"license-renewal",message:e.message.buffer}))},r.Eg=function(e){Y.debug("PatchedMediaKeysApple.onWebkitKeyAdded_",e),this.i&&(lc(this,"usable"),this.i.resolve(),this.i=null)},r.Fg=function(e){if(Y.debug("PatchedMediaKeysApple.onWebkitKeyError_",e),(e=Error("EME PatchedMediaKeysApple key error")).errorCode=this.h.error,null!=this.g)this.g.reject(e),this.g=null;else if(null!=this.i)this.i.reject(e),this.i=null;else switch(this.h.error.code){case WebKitMediaKeyError.MEDIA_KEYERR_OUTPUT:case WebKitMediaKeyError.MEDIA_KEYERR_HARDWARECHANGE:lc(this,"output-not-allowed");break;default:lc(this,"internal-error")}},(r=dc.prototype).forEach=function(e){this.g&&e(this.g,$u)},r.get=function(e){if(this.has(e))return this.g},r.has=function(e){var t=$u;return!(!this.g||!Ee.Ha(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Zu((function(){e.HTMLVideoElement&&e.WebKitMediaKeys&&(Y.info("Using Apple-prefixed EME"),$u=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=oc,e.MediaKeys=ac,e.MediaKeySystemAccess=rc,navigator.requestMediaKeySystemAccess=ic)})),fc.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess.createMediaKeys");var e=new gc(this.keySystem);return Promise.resolve(e)},fc.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySystemAccess.getConfiguration"),this.g},gc.prototype.createSession=function(e){if(Y.debug("PatchedMediaKeysMs.MediaKeys.createSession"),"temporary"!=(e=e||"temporary"))throw new TypeError("Session type "+e+" is unsupported on this platform.");return new vc(this.h,e)},gc.prototype.setServerCertificate=function(){return Y.debug("PatchedMediaKeysMs.MediaKeys.setServerCertificate"),Promise.resolve(!1)},G(vc,Ke),(r=vc.prototype).generateRequest=function(e,t){Y.debug("PatchedMediaKeysMs.MediaKeySession.generateRequest"),this.g=new ge;try{this.i=this.l.createSession("video/mp4",new Uint8Array(t),null),this.j.H(this.i,"mskeymessage",this.dg.bind(this)),this.j.H(this.i,"mskeyadded",this.bg.bind(this)),this.j.H(this.i,"mskeyerror",this.cg.bind(this)),bc(this,"status-pending")}catch(e){this.g.reject(e)}return this.g},r.load=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySession.load"),Promise.reject(Error("MediaKeySession.load not yet supported"))},r.update=function(e){Y.debug("PatchedMediaKeysMs.MediaKeySession.update"),this.h=new ge;try{this.i.update(new Uint8Array(e))}catch(e){this.h.reject(e)}return this.h},r.close=function(){Y.debug("PatchedMediaKeysMs.MediaKeySession.close");try{this.i.close(),this.closed.resolve(),this.j.nb()}catch(e){this.closed.reject(e)}return this.closed},r.remove=function(){return Y.debug("PatchedMediaKeysMs.MediaKeySession.remove"),Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"))},r.dg=function(e){Y.debug("PatchedMediaKeysMs.onMsKeyMessage_",e),this.g&&(this.g.resolve(),this.g=null),this.dispatchEvent(new Ue("message",{messageType:null==this.keyStatuses.g?"license-request":"license-renewal",message:e.message.buffer}))},r.bg=function(e){Y.debug("PatchedMediaKeysMs.onMsKeyAdded_",e),this.g?(Y.debug("Simulating completion for a PR persistent license."),bc(this,"usable"),this.g.resolve(),this.g=null):this.h&&(bc(this,"usable"),this.h.resolve(),this.h=null)},r.cg=function(e){if(Y.debug("PatchedMediaKeysMs.onMsKeyError_",e),(e=Error("EME PatchedMediaKeysMs key error")).errorCode=this.i.error,null!=this.g)this.g.reject(e),this.g=null;else if(null!=this.h)this.h.reject(e),this.h=null;else switch(this.i.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:bc(this,"output-not-allowed");break;default:bc(this,"internal-error")}},(r=wc.prototype).forEach=function(e){this.g&&e(this.g,Ju)},r.get=function(e){if(this.has(e))return this.g},r.has=function(e){var t=Ju;return!(!this.g||!Ee.Ha(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Zu((function(){!e.HTMLVideoElement||!e.MSMediaKeys||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Y.info("Using ms-prefixed EME v20140218"),Ju=new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=pc,e.MediaKeys=gc,e.MediaKeySystemAccess=fc,navigator.requestMediaKeySystemAccess=hc)})),Ec.prototype.createSession=function(){},Ec.prototype.setServerCertificate=function(){},xc.prototype.getConfiguration=function(){},xc.prototype.createMediaKeys=function(){},Zu((function(){!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(Y.info("EME not available."),navigator.requestMediaKeySystemAccess=Tc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Sc,e.MediaKeys=Ec,e.MediaKeySystemAccess=xc)}),-10);var kc,Ac="";function Mc(e){return Ac?Ac+e.charAt(0).toUpperCase()+e.slice(1):e}function Ic(e,t){Y.debug("PatchedMediaKeysWebkit.requestMediaKeySystemAccess");try{var n=new Cc(e,t);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}function Pc(e){Y.debug("PatchedMediaKeysWebkit.setMediaKeys");var t=this.mediaKeys;return t&&t!=e&&Nc(t,null),delete this.mediaKeys,(this.mediaKeys=e)&&Nc(e,this),Promise.resolve()}function Cc(e,t){Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess"),this.g=this.keySystem=e;var n=!1;"org.w3.clearkey"==e&&(this.g="webkit-org.w3.clearkey",n=!1);var i=!1,r=document.getElementsByTagName("video");r=r.length?r[0]:document.createElement("video");for(var o=0;o<t.length;++o){var a=t[o],s={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:a.initDataTypes,sessionTypes:["temporary"],label:a.label},u=!1;if(a.audioCapabilities)for(var c=0;c<a.audioCapabilities.length;++c){var l=a.audioCapabilities[c];if(l.contentType){u=!0;var d=l.contentType.split(";")[0];r.canPlayType(d,this.g)&&(s.audioCapabilities.push(l),i=!0)}}if(a.videoCapabilities)for(c=0;c<a.videoCapabilities.length;++c)(l=a.videoCapabilities[c]).contentType&&(u=!0,r.canPlayType(l.contentType,this.g)&&(s.videoCapabilities.push(l),i=!0));if(u||(i=r.canPlayType("video/mp4",this.g)||r.canPlayType("video/webm",this.g)),"required"==a.persistentState&&(n?(s.persistentState="required",s.sessionTypes=["persistent-license"]):i=!1),i)return void(this.h=s)}throw n="Unsupported keySystem","org.w3.clearkey"!=e&&"com.widevine.alpha"!=e||(n="None of the requested configurations were supported."),(n=Error(n)).name="NotSupportedError",n.code=DOMException.NOT_SUPPORTED_ERR,n}function Rc(e){Y.debug("PatchedMediaKeysWebkit.MediaKeys"),this.l=e,this.h=null,this.g=new Ze,this.i=[],this.j={}}function Nc(e,t){e.h=t,e.g.nb();var n=Ac;t&&(e.g.H(t,n+"needkey",e.hg.bind(e)),e.g.H(t,n+"keymessage",e.Jg.bind(e)),e.g.H(t,n+"keyadded",e.Hg.bind(e)),e.g.H(t,n+"keyerror",e.Ig.bind(e)))}function Dc(e,t){var n=e.j[t];return n?(Y.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):(n=e.i.shift())?(n.sessionId=t,e.j[t]=n,Y.debug("PatchedMediaKeysWebkit.MediaKeys.findSession_",n),n):null}function jc(e,t,n){Y.debug("PatchedMediaKeysWebkit.MediaKeySession"),Ke.call(this),this.j=e,this.m=!1,this.g=this.h=null,this.i=t,this.l=n,this.sessionId="",this.expiration=NaN,this.closed=new ge,this.keyStatuses=new Uc}function _c(e,t,n){if(e.m)return Promise.reject(Error("The session is already initialized."));e.m=!0;try{if("persistent-license"==e.l)if(n)var i=new Uint8Array(be("LOAD_SESSION|"+n));else{var r=be("PERSISTENT|"),o=new Uint8Array(r.byteLength+t.byteLength);o.set(new Uint8Array(r),0),o.set(new Uint8Array(t),r.byteLength),i=o}else i=new Uint8Array(t)}catch(e){return Promise.reject(e)}e.h=new ge;var a=Mc("generateKeyRequest");try{e.j[a](e.i,i)}catch(t){if("InvalidStateError"!=t.name)return e.h=null,Promise.reject(t);new Ie((function(){try{e.j[a](e.i,i)}catch(t){e.h.reject(t),e.h=null}})).V(.01)}return e.h}function Lc(e,t){var n=e.keyStatuses;n.size=null==t?0:1,n.g=t,e.dispatchEvent(new Ue("keystatuseschange"))}function Uc(){this.size=0,this.g=void 0}function Oc(e){if("picture-in-picture"==(e=e.target).webkitPresentationMode){document.pictureInPictureElement=e;var t=new Event("enterpictureinpicture");e.dispatchEvent(t)}else document.pictureInPictureElement==e&&(document.pictureInPictureElement=null),t=new Event("leavepictureinpicture"),e.dispatchEvent(t)}function Kc(){return this.webkitSupportsPresentationMode("picture-in-picture")?(this.webkitSetPresentationMode("picture-in-picture"),document.pictureInPictureElement=this,Promise.resolve()):Promise.reject(Error("PiP not allowed by video element"))}function Bc(){var e=document.pictureInPictureElement;return e?(e.webkitSetPresentationMode("inline"),document.pictureInPictureElement=null,Promise.resolve()):Promise.reject(Error("No picture in picture element found"))}function Fc(){return!!this.hasAttribute("disablePictureInPicture")||!this.webkitSupportsPresentationMode("picture-in-picture")}function Hc(e){e?this.setAttribute("disablePictureInPicture",""):this.removeAttribute("disablePictureInPicture")}function Vc(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}}function Gc(t,n,i){return new e.TextTrackCue(t,n,i)}function qc(t,n,i){return new e.TextTrackCue(t+"-"+n+"-"+i,t,n,i)}function zc(){}Cc.prototype.createMediaKeys=function(){Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.createMediaKeys");var e=new Rc(this.g);return Promise.resolve(e)},Cc.prototype.getConfiguration=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeySystemAccess.getConfiguration"),this.h},(r=Rc.prototype).createSession=function(e){if(Y.debug("PatchedMediaKeysWebkit.MediaKeys.createSession"),"temporary"!=(e=e||"temporary")&&"persistent-license"!=e)throw new TypeError("Session type "+e+" is unsupported on this platform.");var t=this.h||document.createElement("video");return t.src||(t.src="about:blank"),e=new jc(t,this.l,e),this.i.push(e),e},r.setServerCertificate=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeys.setServerCertificate"),Promise.resolve(!1)},r.hg=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitNeedKey_",e);var t=document.createEvent("CustomEvent");t.initCustomEvent("encrypted",!1,!1,null),t.initDataType="cenc",e.initData instanceof ArrayBuffer?t.initData=e.initData:t.initData=e.initData.buffer,this.h.dispatchEvent(t)},r.Jg=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyMessage_",e);var t=Dc(this,e.sessionId);t?(e=new Ue("message",{messageType:null==t.keyStatuses.g?"licenserequest":"licenserenewal",message:e.message}),Y.debug("PatchedMediaKeysWebkit.MediaKeySession.generated"),t.h&&(t.h.resolve(),t.h=null),t.dispatchEvent(e)):Y.error("Session not found",e.sessionId)},r.Hg=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyAdded_",e),(e=Dc(this,e.sessionId))&&(Y.debug("PatchedMediaKeysWebkit.MediaKeySession.ready"),Lc(e,"usable"),e.g&&e.g.resolve(),e.g=null)},r.Ig=function(e){Y.debug("PatchedMediaKeysWebkit.onWebkitKeyError_",e);var t=Dc(this,e.sessionId);t&&t.handleError(e)},G(jc,Ke),(r=jc.prototype).handleError=function(e){Y.debug("PatchedMediaKeysWebkit.MediaKeySession.handleError",e);var t=Error("EME v0.1b key error"),n=e.errorCode;n.systemCode=e.systemCode,t.errorCode=n,!e.sessionId&&this.h?(45==e.systemCode&&(t.message="Unsupported session type."),this.h.reject(t),this.h=null):e.sessionId&&this.g?(this.g.reject(t),this.g=null):(t=e.systemCode,e.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?Lc(this,"output-restricted"):Lc(this,1==t?"expired":"internal-error"))},r.Qd=function(e,t){if(this.g)this.g.then(this.Qd.bind(this,e,t)).catch(this.Qd.bind(this,e,t));else{if(this.g=e,"webkit-org.w3.clearkey"==this.i){var n=me(t),i=JSON.parse(n);"oct"!=i.keys[0].kty&&(this.g.reject(Error("Response is not a valid JSON Web Key Set.")),this.g=null),n=Ee.Ja(i.keys[0].k),i=Ee.Ja(i.keys[0].kid)}else n=new Uint8Array(t),i=null;var r=Mc("addKey");try{this.j[r](this.i,n,i,this.sessionId)}catch(e){this.g.reject(e),this.g=null}}},r.generateRequest=function(e,t){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.generateRequest"),_c(this,t,null)},r.load=function(e){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.load"),"persistent-license"==this.l?_c(this,null,e):Promise.reject(Error("Not a persistent session."))},r.update=function(e){Y.debug("PatchedMediaKeysWebkit.MediaKeySession.update",e);var t=new ge;return this.Qd(t,e),t},r.close=function(){if(Y.debug("PatchedMediaKeysWebkit.MediaKeySession.close"),"persistent-license"!=this.l){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;var e=Mc("cancelKeyRequest");try{this.j[e](this.i,this.sessionId)}catch(e){}}return this.closed.resolve(),this.closed},r.remove=function(){return Y.debug("PatchedMediaKeysWebkit.MediaKeySession.remove"),"persistent-license"!=this.l?Promise.reject(Error("Not a persistent session.")):this.close()},(r=Uc.prototype).forEach=function(e){this.g&&e(this.g,kc)},r.get=function(e){if(this.has(e))return this.g},r.has=function(e){var t=kc;return!(!this.g||!Ee.Ha(new Uint8Array(e),new Uint8Array(t)))},r.entries=function(){},r.keys=function(){},r.values=function(){},Zu((function(){if(!(!e.HTMLVideoElement||navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration)){if(HTMLMediaElement.prototype.webkitGenerateKeyRequest)Y.info("Using webkit-prefixed EME v0.1b"),Ac="webkit";else{if(!HTMLMediaElement.prototype.generateKeyRequest)return;Y.info("Using nonprefixed EME v0.1b")}kc=new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess=Ic,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Pc,e.MediaKeys=Rc,e.MediaKeySystemAccess=Cc}})),Zu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;t.requestPictureInPicture&&document.exitPictureInPicture||!t.webkitSupportsPresentationMode||(Y.debug("PiPWebkit.install"),document.pictureInPictureEnabled=!0,document.pictureInPictureElement=null,t.requestPictureInPicture=Kc,Object.defineProperty(t,"disablePictureInPicture",{get:Fc,set:Hc,enumerable:!0,configurable:!0}),document.exitPictureInPicture=Bc,document.addEventListener("webkitpresentationmodechanged",Oc,!0))}})),Zu((function(){if(Y.debug("VideoPlayPromise.install"),e.HTMLMediaElement){var t=HTMLMediaElement.prototype.play;HTMLMediaElement.prototype.play=function(){var e=t.apply(this);return e&&e.catch((function(){})),e}}})),Zu((function(){if(e.HTMLVideoElement){var t=HTMLVideoElement.prototype;!t.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in t&&(t.getVideoPlaybackQuality=Vc)}})),Zu((function(){if(e.VTTCue)Y.info("Using native VTTCue.");else if(e.TextTrackCue){var t=TextTrackCue.length;if(3==t)Y.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=Gc;else if(6==t)Y.info("Using VTTCue polyfill from 6 argument TextTrackCue."),e.VTTCue=qc;else{try{var n=!!Gc(1,2,"")}catch(e){n=!1}n&&(Y.info("Using VTTCue polyfill from 3 argument TextTrackCue."),e.VTTCue=Gc)}}else Y.error("VTTCue not available.")})),V("shaka.text.TtmlTextParser",zc),zc.prototype.parseInit=function(){},zc.prototype.parseInit=zc.prototype.parseInit,zc.prototype.parseMedia=function(e,t){var n=me(e),i=[],r=new DOMParser,o=null;if(""==n)return i;try{o=r.parseFromString(n,"text/xml")}catch(e){throw new $(2,2,2005,"Failed to parse TTML.")}if(o){if(n=o.getElementsByTagName("parsererror")[0])throw new $(2,2,2005,n.textContent);if(!(r=o.getElementsByTagName("tt")[0]))throw new $(2,2,2005,"TTML does not contain <tt> tag.");var a=Vi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRate"),s=Vi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","subFrameRate"),u=Vi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","frameRateMultiplier"),c=Vi.getAttributeNS(r,"http://www.w3.org/ns/ttml#parameter","tickRate");if(o=r.getAttribute("xml:space")||"default",n=Vi.getAttributeNS(r,"http://www.w3.org/ns/ttml#styling","extent"),"default"!=o&&"preserve"!=o)throw new $(2,2,2005,"Invalid xml:space value: "+o);o="default"==o,a=new ml(a,s,u,c),s=al(r.getElementsByTagName("metadata")[0]),u=al(r.getElementsByTagName("styling")[0]),c=al(r.getElementsByTagName("layout")[0]);for(var l=[],d=0;d<c.length;d++){var h,p,g=c[d],m=u,v=n,y=new dn,b=g.getAttribute("xml:id");if(b)y.id=b,b=null,v&&(b=Yc.exec(v)||Jc.exec(v)),v=b?Number(b[1]):null,b=b?Number(b[2]):null,(h=ll(g,m,"extent"))&&(null!=(h=(p=Yc.exec(h))||Jc.exec(h))&&(y.width=null!=v?100*Number(h[1])/v:Number(h[1]),y.height=null!=b?100*Number(h[2])/b:Number(h[2]),y.widthUnits=p||null!=v?hn:0,y.heightUnits=p||null!=b?hn:0)),(g=ll(g,m,"origin"))&&(null!=(h=(p=Yc.exec(g))||Jc.exec(g))&&(y.viewportAnchorX=null!=v?100*Number(h[1])/v:Number(h[1]),y.viewportAnchorY=null!=b?100*Number(h[2])/b:Number(h[2]),y.viewportAnchorUnits=p||null!=v?hn:0));else Y.v("TtmlTextParser parser encountered a region with no id. Region will be ignored."),y=null;y&&l.push(y)}for(n=function e(t){if(!t)return[];for(var n=[],i=(t=f(t.childNodes)).next();!i.done;i=t.next())(i=i.value)instanceof Element&&(i.hasAttribute("begin")?n.push(i):n=n.concat(e(i)));return n}(r.getElementsByTagName("body")[0]),r=(n=f(n)).next();!r.done;r=n.next())(r=sl(r.value,t.periodStart,a,s,u,c,l,o,!1))&&i.push(r)}return i},zc.prototype.parseMedia=zc.prototype.parseMedia;var Wc,Xc,Yc=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,$c=/^(\d+px|\d+em)$/,Jc=/^(\d+)px (\d+)px$/,Qc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Zc=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,el=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,tl=/^(\d*(?:\.\d*)?)f$/,nl=/^(\d*(?:\.\d*)?)t$/,il=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,rl={left:an,center:"center",right:"end",start:an,end:"end"},ol={left:"line-left",center:"center",right:"line-right"};function al(e){var t=[];if(!e)return t;for(var n=f(e.childNodes),i=n.next();!i.done;i=n.next())(i=i.value).nodeType==Node.ELEMENT_NODE&&"br"!==i.nodeName&&(i=al(i),t=t.concat(i));return t.length||t.push(e),t}function sl(e,t,n,i,r,o,a,s,u){if(u&&"br"==e.nodeName)return(e=new $t(0,0,"")).spacer=!0,e;var c=/^[\s\n]*$/.test(e.textContent),l=e.nodeType==Node.ELEMENT_NODE&&!e.hasAttribute("begin")&&!e.hasAttribute("end");if(e.nodeType!=Node.ELEMENT_NODE||l&&c||l&&!u)return null;s="default"==(e.getAttribute("xml:space")||(s?"default":"preserve")),c=pl(e.getAttribute("begin"),n),l=pl(e.getAttribute("end"),n);var d=pl(e.getAttribute("dur"),n);if(null==l&&null!=d&&(l=c+d),!u&&(null==c||null==l))throw new $(2,2,2001);if(c=u&&null==c?0:c+t,l=u&&null==l?0:l+t,d="",u=[],Array.from(e.childNodes).find((function(e){return e.nodeType===Node.TEXT_NODE&&/\S+/.test(e.textContent)})))d=function e(t,n){for(var i="",r=f(t.childNodes),o=r.next();!o.done;o=r.next())"br"==(o=o.value).nodeName&&t.childNodes[0]!==o?i+="\n":o.childNodes&&0<o.childNodes.length?i+=e(o,n):n?i+=o=(o=o.textContent.trim()).replace(/\s+/g," "):i+=o.textContent;return i}(e,s);else for(var h=f(e.childNodes),p=h.next();!p.done;p=h.next())(p=sl(p.value,t,n,i,r,o,a,s,!0))&&(p.startTime=p.startTime||c,p.endTime=p.endTime||l,u.push(p));if((t=new $t(c,l,d)).nestedCues=u,(o=fl(e,"region",o,"")[0])&&o.getAttribute("xml:id")){var g=o.getAttribute("xml:id");t.region=a.filter((function(e){return e.id==g}))[0]}return function(e,t,n,i,r){"rtl"==cl(t,n,r,"direction")&&(e.direction="rtl");var o=cl(t,n,r,"writingMode");"tb"==o||"tblr"==o?e.writingMode="vertical-lr":"tbrl"==o?e.writingMode="vertical-rl":"rltb"==o||"rl"==o?e.direction="rtl":o&&(e.direction=nn),(o=cl(t,n,r,"textAlign"))?(e.positionAlign=ol[o],e.lineAlign=rl[o],e.textAlign=Zt[o.toUpperCase()]):e.textAlign="start",(o=cl(t,n,r,"displayAlign"))&&(e.displayAlign=tn[o.toUpperCase()]);(o=cl(t,n,r,"color"))&&(e.color=o);(o=cl(t,n,r,"backgroundColor"))&&(e.backgroundColor=o);(o=cl(t,n,r,"fontFamily"))&&(e.fontFamily=o);(o=cl(t,n,r,"fontWeight"))&&"bold"==o&&(e.fontWeight=700),(o=cl(t,n,r,"wrapOption"))&&"noWrap"==o&&(e.wrapLine=!1),(o=cl(t,n,r,"lineHeight"))&&o.match($c)&&(e.lineHeight=o),(o=cl(t,n,r,"fontSize"))&&o.match($c)&&(e.fontSize=o),(o=cl(t,n,r,"fontStyle"))&&(e.fontStyle=ln[o.toUpperCase()]);if(i){o=i.getAttribute("imageType")||i.getAttribute("imagetype");var a=i.getAttribute("encoding");i=i.textContent.trim(),"PNG"==o&&"Base64"==a&&i&&(e.backgroundImage="data:image/png;base64,"+i)}(n=ll(n,r,"textDecoration"))&&ul(e,n),(t=dl(t,r,"textDecoration"))&&ul(e,t)}(t,e,o,i=fl(e,"backgroundImage",i,"#","http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt")[0],r),t}function ul(e,t){for(var n=t.split(" "),i=0;i<n.length;i++)switch(n[i]){case"underline":e.textDecoration.includes("underline")||e.textDecoration.push("underline");break;case"noUnderline":e.textDecoration.includes("underline")&&He(e.textDecoration,"underline");break;case"lineThrough":e.textDecoration.includes("lineThrough")||e.textDecoration.push("lineThrough");break;case"noLineThrough":e.textDecoration.includes("lineThrough")&&He(e.textDecoration,"lineThrough");break;case"overline":e.textDecoration.includes("overline")||e.textDecoration.push("overline");break;case"noOverline":e.textDecoration.includes("overline")&&He(e.textDecoration,"overline")}}function cl(e,t,n,i){return(e=dl(e,n,i))?e:ll(t,n,i)}function ll(e,t,n){if(!e)return null;for(var i=al(e),r=0;r<i.length;r++){var o=Vi.getAttributeNS(i[r],"http://www.w3.org/ns/ttml#styling",n);if(o)return o}return hl(e,t,n)}function dl(e,t,n){var i=Vi.getAttributeNS(e,"http://www.w3.org/ns/ttml#styling",n);return i||hl(e,t,n)}function hl(e,t,n){e=fl(e,"style",t,"");for(var i=null,r=0;r<e.length;r++){var o=Vi.getAttributeNS(e[r],"http://www.w3.org/ns/ttml#styling",n);o||(o=dl(e[r],t,n)),o&&(i=o)}return i}function fl(e,t,n,i,r){var o=[];if(!e||1>n.length)return o;var a=e;for(e=null;a&&!(e=r?Vi.getAttributeNS(a,r,t):a.getAttribute(t))&&(a=a.parentNode)instanceof Element;);if(t=e)for(r=(t=f(t=t.split(" "))).next();!r.done;r=t.next())for(r=r.value,a=(e=f(n)).next();!a.done;a=e.next())if(i+(a=a.value).getAttribute("xml:id")==r){o.push(a);break}return o}function pl(e,t){var n=null;if(Qc.test(e)){n=Qc.exec(e);var i=Number(n[1]),r=Number(n[2]),o=Number(n[3]),a=Number(n[4]);n=(o+=(a+=(Number(n[5])||0)/t.h)/t.frameRate)+60*r+3600*i}else Zc.test(e)?n=gl(Zc,e):el.test(e)?n=gl(el,e):tl.test(e)?(n=tl.exec(e),n=Number(n[1])/t.frameRate):nl.test(e)?(n=nl.exec(e),n=Number(n[1])/t.g):il.test(e)&&(n=gl(il,e));return n}function gl(e,t){var n=e.exec(t);return null==n||""==n[0]?null:(Number(n[4])||0)/1e3+(Number(n[3])||0)+60*(Number(n[2])||0)+3600*(Number(n[1])||0)}function ml(e,t,n,i){this.frameRate=Number(e)||30,this.h=Number(t)||1,this.g=Number(i),0==this.g&&(this.g=e?this.frameRate*this.h:1),n&&(e=/^(\d+) (\d+)$/g.exec(n))&&(this.frameRate*=Number(e[1])/Number(e[2]))}function vl(){this.g=new zc}function yl(){}function bl(e,t,n){var i;if(i=/^align:(start|middle|center|end|left|right)$/.exec(t))t=i[1],e.textAlign="middle"==t?Qt:Zt[t.toUpperCase()];else if(i=/^vertical:(lr|rl)$/.exec(t))e.writingMode="lr"==i[1]?"vertical-lr":"vertical-rl";else if(i=/^size:([\d.]+)%$/.exec(t))e.size=Number(i[1]);else if(i=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(t))e.position=Number(i[1]),i[2]&&(t=i[2],e.positionAlign="line-left"==t||"start"==t?"line-left":"line-right"==t||"end"==t?"line-right":"center");else{if(!(i=/^region:(.*)$/.exec(t))){e:{if(n=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(t))e.lineInterpretation=1,e.line=Number(n[1]),n[2]&&(e.lineAlign=sn[n[2].toUpperCase()]);else{if(!(n=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(t))){e=!1;break e}e.lineInterpretation=on,e.line=Number(n[1]),n[2]&&(e.lineAlign=sn[n[2].toUpperCase()])}e=!0}return e}(t=function(e,t){var n=e.filter((function(e){return e.id==t}));return n.length?n[0]:(Y.v("VTT parser could not find a region with id: ",t," The region will be ignored."),null)}(n,i[1]))&&(e.region=t)}return!0}function wl(e){if(null==(e=Kr(e,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3})/g)))return null;var t=Number(e[2]),n=Number(e[3]);return 59<t||59<n?null:Number(e[4])/1e3+n+60*t+3600*(Number(e[1])||0)}function Tl(){this.g=null}function Sl(e,t,n){var i,r,o;return(new _i).box("payl",Oi((function(e){i=me(e)}))).box("iden",Oi((function(e){r=me(e)}))).box("sttg",Oi((function(e){o=me(e)}))).parse(e),i?function(e,t,n,i,r){if(e=new $t(i,r,e),t&&(e.id=t),n)for(t=new Ur(n),n=Br(t);n;)bl(e,n,[])||Y.v("VTT parser encountered an invalid VTT setting: ",n," The setting will be ignored."),Or(t),n=Br(t);return e}(i,r,o,t,n):null}
/*
        @license
        EME Encryption Scheme Polyfill
        Copyright 2019 Google LLC
        SPDX-License-Identifier: Apache-2.0
        */
function El(){}function xl(){Wc?console.debug("EmeEncryptionSchemePolyfill: Already installed."):navigator.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration?(Wc=navigator.requestMediaKeySystemAccess,console.debug("EmeEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.requestMediaKeySystemAccess=kl):console.debug("EmeEncryptionSchemePolyfill: EME not found")}function kl(e,t){var n=this;return g((function i(){var r;return U(i,(function(i){switch(i.s){case 1:return console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),k(i,Wc.call(n,e,t),2);case 2:return jl(r=i.B)?(console.debug("EmeEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.requestMediaKeySystemAccess=Wc,i.return(r)):(console.debug("EmeEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.requestMediaKeySystemAccess=Al,i.return(Al.call(n,e,t)))}}))}))}function Al(e,t){var n=this;return g((function i(){var r,o,a,s,u,c,l,d;return U(i,(function(i){switch(i.s){case 1:console.assert(n==navigator,'bad "this" for requestMediaKeySystemAccess'),r=Dl(e),o=[];for(var h=f(t),p=h.next();!p.done;p=h.next())a=p.value,s=Ml(a.videoCapabilities,r),u=Ml(a.audioCapabilities,r),a.videoCapabilities&&a.videoCapabilities.length&&!s.length||a.audioCapabilities&&a.audioCapabilities.length&&!u.length||((c=Object.assign({},a)).videoCapabilities=s,c.audioCapabilities=u,o.push(c));if(!o.length)throw(l=Error("Unsupported keySystem or supportedConfigurations.")).name="NotSupportedError",l.code=DOMException.NOT_SUPPORTED_ERR,l;return k(i,Wc.call(n,e,o),2);case 2:return d=i.B,i.return(new Nl(d,r))}}))}))}function Ml(e,t){return e?e.filter((function(e){return!e.encryptionScheme||e.encryptionScheme==t})):e}function Il(){}function Pl(){Xc?console.debug("McEncryptionSchemePolyfill: Already installed."):navigator.mediaCapabilities?(Xc=navigator.mediaCapabilities.decodingInfo,console.debug("McEncryptionSchemePolyfill: Waiting to detect encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Cl):console.debug("McEncryptionSchemePolyfill: MediaCapabilities not found")}function Cl(e){var t=this;return g((function n(){var i,r;return U(n,(function(n){switch(n.s){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),k(n,Xc.call(t,e),2);case 2:return i=n.B,e.keySystemConfiguration?(r=i.keySystemAccess)&&jl(r)?(console.debug("McEncryptionSchemePolyfill: Native encryptionScheme support found."),navigator.mediaCapabilities.decodingInfo=Xc,n.return(i)):(console.debug("McEncryptionSchemePolyfill: No native encryptionScheme support found. Patching encryptionScheme support."),navigator.mediaCapabilities.decodingInfo=Rl,n.return(Rl.call(t,e))):n.return(i)}}))}))}function Rl(e){var t=this;return g((function n(){var i,r,o,a,s,u,c,l,d;return U(n,(function(n){switch(n.s){case 1:return console.assert(t==navigator.mediaCapabilities,'bad "this" for decodingInfo'),i=null,e.keySystemConfiguration&&(r=e.keySystemConfiguration,o=r.keySystem,a=r.audio&&r.audio.encryptionScheme,s=r.video&&r.video.encryptionScheme,i=Dl(o),u={powerEfficient:!1,smooth:!1,supported:!1,keySystemAccess:null,configuration:e},a&&a!=i||s&&s!=i)?n.return(u):k(n,Xc.call(t,e),2);case 2:if((c=n.B).keySystemAccess){c.keySystemAccess=new Nl(c.keySystemAccess,i),n.I(3);break}if(!e.keySystemConfiguration){n.I(3);break}var h=e.keySystemConfiguration,f=[],p=[];return h.audio&&f.push({robustness:h.audio.robustness||"",contentType:e.audio.contentType}),h.video&&p.push({robustness:h.video.robustness||"",contentType:e.video.contentType}),h={initDataTypes:h.initDataType?[h.initDataType]:[],distinctiveIdentifier:h.distinctiveIdentifier,persistentState:h.persistentState,sessionTypes:h.sessionTypes},f.length&&(h.audioCapabilities=f),p.length&&(h.videoCapabilities=p),l=h,d=c,k(n,navigator.requestMediaKeySystemAccess(e.keySystemConfiguration.keySystem,[l]),5);case 5:d.keySystemAccess=n.B;case 3:return n.return(c)}}))}))}function Nl(e,t){this.h=e,this.g=t,this.keySystem=e.keySystem}function Dl(e){return e.startsWith("com.widevine")||e.startsWith("com.microsoft")||e.startsWith("com.adobe")||e.startsWith("org.w3")?"cenc":e.startsWith("com.apple")?"cbcs-1-9":(console.warn("EmeEncryptionSchemePolyfill: Unknown key system:",e,"Please contribute!"),null)}function jl(e){var t=(e=e.getConfiguration()).audioCapabilities&&e.audioCapabilities[0];return!(!(e=e.videoCapabilities&&e.videoCapabilities[0]||t)||void 0===e.encryptionScheme)}function _l(){}function Ll(){xl(),Pl()}gn["application/ttml+xml"]=zc,V("shaka.text.Mp4TtmlParser",vl),vl.prototype.parseInit=function(e){var t=!1;if((new _i).box("moov",Li).box("trak",Li).box("mdia",Li).box("minf",Li).box("stbl",Li).ma("stsd",Ui).box("stpp",(function(e){t=!0,e.parser.stop()})).parse(e),!t)throw new $(2,2,2007)},vl.prototype.parseInit=vl.prototype.parseInit,vl.prototype.parseMedia=function(e,t){var n=!1,i=[];if((new _i).box("mdat",Oi(function(e){n=!0,i=i.concat(this.g.parseMedia(e,t))}.bind(this))).parse(e),!n)throw new $(2,2,2007);return i},vl.prototype.parseMedia=vl.prototype.parseMedia,gn['application/mp4; codecs="stpp"']=vl,gn['application/mp4; codecs="stpp.ttml.im1t"']=vl,gn['application/mp4; codecs="stpp.TTML.im1t"']=vl,V("shaka.text.VttTextParser",yl),yl.prototype.parseInit=function(){},yl.prototype.parseInit=yl.prototype.parseInit,yl.prototype.parseMedia=function(e,t){var n=me(e);if(n=(n=n.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n")).split(/\n{2,}/m),!/^WEBVTT($|[ \t\n])/m.test(n[0]))throw new $(2,2,2e3);var i=t.segmentStart;if(null==i&&(i=0,n[0].includes("X-TIMESTAMP-MAP"))){var r=n[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),o=n[0].match(/MPEGTS:(\d+)/m);if(r&&o){if(null==(i=wl(new Ur(r[1]))))throw new $(2,2,2e3);i=t.periodStart+(Number(o[1])/9e4-i)}}o=[];var a=n[0].split("\n");for(r=1;r<a.length;r++)if(/^Region:/.test(a[r])){var s=new Ur(a[r]),u=new dn;Br(s),Or(s);for(var c=Br(s);c;){var l;e:{var d=u,h=c;if(l=/^id=(.*)$/.exec(h))d.id=l[1];else if(l=/^width=(\d{1,2}|100)%$/.exec(h))d.width=Number(l[1]);else if(l=/^lines=(\d+)$/.exec(h))d.height=Number(l[1]),d.heightUnits=2;else if(l=/^regionanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))d.regionAnchorX=Number(l[1]),d.regionAnchorY=Number(l[2]);else if(l=/^viewportanchor=(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(h))d.viewportAnchorX=Number(l[1]),d.viewportAnchorY=Number(l[2]);else{if(!/^scroll=up$/.exec(h)){l=!1;break e}d.scroll="up"}l=!0}l||Y.v("VTT parser encountered an invalid VTTRegion setting: ",c," The setting will be ignored."),Or(s),c=Br(s)}o.push(u)}for(r=[],s=1;s<n.length;s++){if(l=a=n[s].split("\n"),d=i,a=o,1==l.length&&!l[0]||/^NOTE($|[ \t])/.test(l[0])||"STYLE"==l[0])a=null;else{u=null,l[0].includes("--\x3e")||(u=l[0],l.splice(0,1)),h=wl(c=new Ur(l[0]));var f=Kr(c,/[ \t]+--\x3e[ \t]+/g),p=wl(c);if(null==h||null==f||null==p)throw new $(2,2,2001);for(l=new $t(h+d,p+d,l.slice(1).join("\n").trim()),Or(c),d=Br(c);d;)bl(l,d,a)||Y.v("VTT parser encountered an invalid VTT setting: ",d," The setting will be ignored."),Or(c),d=Br(c);null!=u&&(l.id=u),a=l}a&&r.push(a)}return r},yl.prototype.parseMedia=yl.prototype.parseMedia,gn["text/vtt"]=yl,gn['text/vtt; codecs="vtt"']=yl,gn['text/vtt; codecs="wvtt"']=yl,V("shaka.text.Mp4VttParser",Tl),Tl.prototype.parseInit=function(e){var t=!1;if((new _i).box("moov",Li).box("trak",Li).box("mdia",Li).ma("mdhd",function(e){0==e.version?(e.reader.U(4),e.reader.U(4),this.g=e.reader.N(),e.reader.U(4)):(e.reader.U(8),e.reader.U(8),this.g=e.reader.N(),e.reader.U(8)),e.reader.U(4)}.bind(this)).box("minf",Li).box("stbl",Li).ma("stsd",Ui).box("wvtt",(function(){t=!0})).parse(e),!this.g)throw new $(2,2,2008);if(!t)throw new $(2,2,2008)},Tl.prototype.parseInit=Tl.prototype.parseInit,Tl.prototype.parseMedia=function(e,t){var n=this;if(!this.g)throw Y.error("No init segment for MP4+VTT!"),new $(2,2,2008);var i,r=0,o=[],a=[],s=!1,u=!1,c=!1,l=null;if((new _i).box("moof",Li).box("traf",Li).ma("tfdt",(function(e){s=!0,r=0==e.version?e.reader.N():e.reader.Pb()})).ma("tfhd",(function(e){var t=e.flags;(e=e.reader).U(4),1&t&&e.U(8),2&t&&e.U(4),l=8&t?e.N():null})).ma("trun",(function(e){u=!0;var t=e.version,n=e.flags,i=(e=e.reader).N();1&n&&e.U(4),4&n&&e.U(4);for(var r=[],a=0;a<i;a++){var s={duration:null,sampleSize:null,Sd:null};256&n&&(s.duration=e.N()),512&n&&(s.sampleSize=e.N()),1024&n&&e.U(4),2048&n&&(s.Sd=0==t?e.N():e.De()),r.push(s)}o=r})).box("mdat",Oi((function(e){c=!0,i=e}))).parse(e),!c&&!s&&!u)throw new $(2,2,2008);var d=r,h=new Ni(new DataView(i.buffer,i.byteOffset,i.byteLength),0);return o.forEach((function(e){var i=e.duration||l,o=e.Sd?r+e.Sd:d;d=o+(i||0);var s=0;do{var u=h.N();s+=u;var c=h.N(),f=null;"vttc"==(c=Bi(c))?8<u&&(f=h.mb(u-8)):("vtte"!=c&&Y.error("Unknown box "+c+"! Skipping!"),h.U(u-8)),i?f&&a.push(Sl(f,t.periodStart+o/n.g,t.periodStart+d/n.g)):Y.error("WVTT sample duration unknown, and no default found!")}while(e.sampleSize&&s<e.sampleSize)})),a.filter(de.Ra)},Tl.prototype.parseMedia=Tl.prototype.parseMedia,gn['application/mp4; codecs="wvtt"']=Tl,V("shaka.util.Dom.createHTMLElement",(function(e){return document.createElement(e)})),V("shaka.util.Dom.createVideoElement",(function(){var e=document.createElement("video");return e.muted=!0,e.width=600,e.height=400,e})),V("shaka.util.Dom.asHTMLElement",(function(e){return e})),V("shaka.util.Dom.asHTMLMediaElement",(function(e){return e})),V("shaka.util.Dom.removeAllChildren",(function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})),V("EmeEncryptionSchemePolyfill",El),El.install=xl,V("McEncryptionSchemePolyfill",Il),Il.install=Pl,Nl.prototype.getConfiguration=function(){var e=this.h.getConfiguration();if(e.videoCapabilities)for(var t=f(e.videoCapabilities),n=t.next();!n.done;n=t.next())n.value.encryptionScheme=this.g;if(e.audioCapabilities)for(n=(t=f(e.audioCapabilities)).next();!n.done;n=t.next())n.value.encryptionScheme=this.g;return e},Nl.prototype.createMediaKeys=function(){return this.h.createMediaKeys()},V("EncryptionSchemePolyfills",_l),_l.install=Ll,void 0!==i&&i.gf&&(i.gf=_l)}.call(r,i,i,void 0),r.shaka)t[o]=r.shaka[o]}()}).call(this,n(4))},function(e,t,n){"use strict";var i,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":r(window))&&(i=window)}e.exports=i}])}));